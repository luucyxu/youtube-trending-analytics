[0m16:10:23.541258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ea4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109366210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109366710>]}


============================== 16:10:23.544230 | 07fb8c00-a576-4e87-b174-67bda47c81b8 ==============================
[0m16:10:23.544230 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:10:23.544582 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'profiles_dir': '/Users/luc/.dbt', 'no_print': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'invocation_command': 'dbt debug', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'fail_fast': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True'}
[0m16:10:23.553617 [info ] [MainThread]: dbt version: 1.10.13
[0m16:10:23.553838 [info ] [MainThread]: python version: 3.11.14
[0m16:10:23.554013 [info ] [MainThread]: python path: /Users/luc/ENTER/envs/dbt_env/bin/python
[0m16:10:23.554164 [info ] [MainThread]: os info: macOS-14.4.1-arm64-arm-64bit
[0m16:10:23.555837 [info ] [MainThread]: Using profiles dir at /Users/luc/.dbt
[0m16:10:23.556011 [info ] [MainThread]: Using profiles.yml file at /Users/luc/.dbt/profiles.yml
[0m16:10:23.556154 [info ] [MainThread]: Using dbt_project.yml file at /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/dbt_project.yml
[0m16:10:23.606047 [info ] [MainThread]: Configuration:
[0m16:10:23.606333 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m16:10:23.606483 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:10:23.606620 [info ] [MainThread]: Required dependencies:
[0m16:10:23.606820 [debug] [MainThread]: Executing "git --help"
[0m16:10:23.639060 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:10:23.639630 [debug] [MainThread]: STDERR: "b''"
[0m16:10:23.639827 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:10:23.640006 [info ] [MainThread]: Connection test skipped since no profile was found
[0m16:10:23.640173 [info ] [MainThread]: [31m1 check failed:[0m
[0m16:10:23.640318 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'weather_dbt_project'


[0m16:10:23.646488 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.14636162, "process_in_blocks": "0", "process_kernel_time": 0.169185, "process_mem_max_rss": "108888064", "process_out_blocks": "0", "process_user_time": 0.764807}
[0m16:10:23.646851 [debug] [MainThread]: Command `dbt debug` failed at 16:10:23.646782 after 0.15 seconds
[0m16:10:23.647162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109366350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10500ca50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107641f50>]}
[0m16:10:23.647428 [debug] [MainThread]: Flushing usage events
[0m16:10:24.043250 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:17:45.601494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b28050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b86690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b87410>]}


============================== 16:17:45.604937 | 106733c9-9ca6-4505-bf4f-717c4c7840fc ==============================
[0m16:17:45.604937 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:17:45.605297 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'debug': 'False', 'fail_fast': 'False', 'version_check': 'True', 'target_path': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'quiet': 'False', 'empty': 'None', 'use_colors': 'True', 'warn_error': 'None', 'no_print': 'None', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'cache_selected_only': 'False', 'invocation_command': 'dbt debug', 'profiles_dir': '/Users/luc/.dbt'}
[0m16:17:45.614240 [info ] [MainThread]: dbt version: 1.10.13
[0m16:17:45.614454 [info ] [MainThread]: python version: 3.11.14
[0m16:17:45.614625 [info ] [MainThread]: python path: /Users/luc/ENTER/envs/dbt_env/bin/python
[0m16:17:45.614773 [info ] [MainThread]: os info: macOS-14.4.1-arm64-arm-64bit
[0m16:17:45.930816 [info ] [MainThread]: Using profiles dir at /Users/luc/.dbt
[0m16:17:45.931090 [info ] [MainThread]: Using profiles.yml file at /Users/luc/.dbt/profiles.yml
[0m16:17:45.931260 [info ] [MainThread]: Using dbt_project.yml file at /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/dbt_project.yml
[0m16:17:45.931724 [info ] [MainThread]: adapter type: snowflake
[0m16:17:45.931904 [info ] [MainThread]: adapter version: 1.8.4
[0m16:17:45.980169 [info ] [MainThread]: Configuration:
[0m16:17:45.980438 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:17:45.980587 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:17:45.980723 [info ] [MainThread]: Required dependencies:
[0m16:17:45.980915 [debug] [MainThread]: Executing "git --help"
[0m16:17:45.998974 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:17:45.999517 [debug] [MainThread]: STDERR: "b''"
[0m16:17:45.999712 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:17:45.999877 [info ] [MainThread]: Connection:
[0m16:17:46.000061 [info ] [MainThread]:   account: azb79167
[0m16:17:46.000195 [info ] [MainThread]:   user: MAGPIE
[0m16:17:46.000327 [info ] [MainThread]:   database: MAGPIE_FINAL_PROJECT
[0m16:17:46.000455 [info ] [MainThread]:   warehouse: TRAINING_WH
[0m16:17:46.000581 [info ] [MainThread]:   role: TRAINING_ROLE
[0m16:17:46.000707 [info ] [MainThread]:   schema: STAGING
[0m16:17:46.000834 [info ] [MainThread]:   authenticator: None
[0m16:17:46.000961 [info ] [MainThread]:   oauth_client_id: None
[0m16:17:46.001085 [info ] [MainThread]:   query_tag: None
[0m16:17:46.001209 [info ] [MainThread]:   client_session_keep_alive: False
[0m16:17:46.001333 [info ] [MainThread]:   host: None
[0m16:17:46.001456 [info ] [MainThread]:   port: None
[0m16:17:46.001582 [info ] [MainThread]:   proxy_host: None
[0m16:17:46.001716 [info ] [MainThread]:   proxy_port: None
[0m16:17:46.001837 [info ] [MainThread]:   protocol: None
[0m16:17:46.001957 [info ] [MainThread]:   connect_retries: 1
[0m16:17:46.002078 [info ] [MainThread]:   connect_timeout: None
[0m16:17:46.002199 [info ] [MainThread]:   retry_on_database_errors: False
[0m16:17:46.002319 [info ] [MainThread]:   retry_all: False
[0m16:17:46.002439 [info ] [MainThread]:   insecure_mode: False
[0m16:17:46.002559 [info ] [MainThread]:   reuse_connections: None
[0m16:17:46.002915 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:17:46.069001 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m16:17:46.069604 [debug] [MainThread]: Using snowflake connection "debug"
[0m16:17:46.069754 [debug] [MainThread]: On debug: select 1 as id
[0m16:17:46.069889 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:17:48.013978 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m16:17:48.014460 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m16:17:48.014838 [debug] [MainThread]: On debug: No close available on handle
[0m16:17:48.015215 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m16:17:48.015596 [info ] [MainThread]: [31m1 check failed:[0m
[0m16:17:48.015935 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: azb79167.snowflakecomputing.com:443. JWT token is invalid. [50d512b0-fe32-4f82-8744-ca2256954e50]

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m16:17:48.018505 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 2.466221, "process_in_blocks": "0", "process_kernel_time": 0.274306, "process_mem_max_rss": "160301056", "process_out_blocks": "0", "process_user_time": 1.35809}
[0m16:17:48.019074 [debug] [MainThread]: Command `dbt debug` failed at 16:17:48.018942 after 2.47 seconds
[0m16:17:48.019427 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:17:48.019775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ee290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ee010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ee350>]}
[0m16:17:48.020169 [debug] [MainThread]: Flushing usage events
[0m16:17:48.341884 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:20:39.967779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097dc110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097ea4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097eaa50>]}


============================== 16:20:39.971224 | 847160c5-076c-4412-b43f-1d467aea4d02 ==============================
[0m16:20:39.971224 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:20:39.971571 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/luc/.dbt', 'log_format': 'default', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'empty': 'None', 'printer_width': '80', 'no_print': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'quiet': 'False', 'introspect': 'True', 'use_colors': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'debug': 'False'}
[0m16:20:39.980428 [info ] [MainThread]: dbt version: 1.10.13
[0m16:20:39.980628 [info ] [MainThread]: python version: 3.11.14
[0m16:20:39.980800 [info ] [MainThread]: python path: /Users/luc/ENTER/envs/dbt_env/bin/python
[0m16:20:39.980947 [info ] [MainThread]: os info: macOS-14.4.1-arm64-arm-64bit
[0m16:20:39.981338 [error] [MainThread]: Encountered an error:
Runtime Error
  Syntax error near line 28
  ------------------------------
  25 |       account: azb79167
  26 |       user: MAGPIE
  27 |       password:"Isuccess66!!!!"
  28 |       role: TRAINING_ROLE
  29 |       warehouse: TRAINING_WH
  30 |       database: MAGPIE_FINAL_PROJECT
  31 |       schema: STAGING
  
  Raw Error:
  ------------------------------
  while scanning a simple key
    in "<unicode string>", line 27, column 7
  could not find expected ':'
    in "<unicode string>", line 28, column 7
[0m16:20:39.982815 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.0291395, "process_in_blocks": "0", "process_kernel_time": 0.11851, "process_mem_max_rss": "107266048", "process_out_blocks": "0", "process_user_time": 0.649479}
[0m16:20:39.983046 [debug] [MainThread]: Command `dbt debug` failed at 16:20:39.982997 after 0.03 seconds
[0m16:20:39.983215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097ea910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053a2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097d4150>]}
[0m16:20:39.983384 [debug] [MainThread]: Flushing usage events
[0m16:20:40.305606 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:21:39.183700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f109d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f8e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f8e910>]}


============================== 16:21:39.187049 | dbd29b14-13c0-4ab0-9540-0d2e4bf80323 ==============================
[0m16:21:39.187049 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:21:39.187421 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'empty': 'None', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'invocation_command': 'dbt debug', 'version_check': 'True', 'use_colors': 'True', 'quiet': 'False', 'log_format': 'default', 'write_json': 'True', 'printer_width': '80', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'partial_parse': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/Users/luc/.dbt', 'target_path': 'None', 'log_cache_events': 'False', 'static_parser': 'True'}
[0m16:21:39.196339 [info ] [MainThread]: dbt version: 1.10.13
[0m16:21:39.196548 [info ] [MainThread]: python version: 3.11.14
[0m16:21:39.196720 [info ] [MainThread]: python path: /Users/luc/ENTER/envs/dbt_env/bin/python
[0m16:21:39.196870 [info ] [MainThread]: os info: macOS-14.4.1-arm64-arm-64bit
[0m16:21:39.445553 [info ] [MainThread]: Using profiles dir at /Users/luc/.dbt
[0m16:21:39.445830 [info ] [MainThread]: Using profiles.yml file at /Users/luc/.dbt/profiles.yml
[0m16:21:39.445995 [info ] [MainThread]: Using dbt_project.yml file at /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/dbt_project.yml
[0m16:21:39.446476 [info ] [MainThread]: adapter type: snowflake
[0m16:21:39.446662 [info ] [MainThread]: adapter version: 1.8.4
[0m16:21:39.495185 [info ] [MainThread]: Configuration:
[0m16:21:39.495467 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:21:39.495617 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:21:39.495755 [info ] [MainThread]: Required dependencies:
[0m16:21:39.495949 [debug] [MainThread]: Executing "git --help"
[0m16:21:39.512418 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:21:39.512929 [debug] [MainThread]: STDERR: "b''"
[0m16:21:39.513109 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:21:39.513279 [info ] [MainThread]: Connection:
[0m16:21:39.513457 [info ] [MainThread]:   account: azb79167
[0m16:21:39.513592 [info ] [MainThread]:   user: MAGPIE
[0m16:21:39.513719 [info ] [MainThread]:   database: MAGPIE_FINAL_PROJECT
[0m16:21:39.513846 [info ] [MainThread]:   warehouse: TRAINING_WH
[0m16:21:39.513973 [info ] [MainThread]:   role: TRAINING_ROLE
[0m16:21:39.514095 [info ] [MainThread]:   schema: STAGING
[0m16:21:39.514218 [info ] [MainThread]:   authenticator: None
[0m16:21:39.514346 [info ] [MainThread]:   oauth_client_id: None
[0m16:21:39.514468 [info ] [MainThread]:   query_tag: None
[0m16:21:39.514591 [info ] [MainThread]:   client_session_keep_alive: False
[0m16:21:39.514713 [info ] [MainThread]:   host: None
[0m16:21:39.514833 [info ] [MainThread]:   port: None
[0m16:21:39.514955 [info ] [MainThread]:   proxy_host: None
[0m16:21:39.515082 [info ] [MainThread]:   proxy_port: None
[0m16:21:39.515203 [info ] [MainThread]:   protocol: None
[0m16:21:39.515323 [info ] [MainThread]:   connect_retries: 1
[0m16:21:39.515442 [info ] [MainThread]:   connect_timeout: None
[0m16:21:39.515572 [info ] [MainThread]:   retry_on_database_errors: False
[0m16:21:39.515695 [info ] [MainThread]:   retry_all: False
[0m16:21:39.515814 [info ] [MainThread]:   insecure_mode: False
[0m16:21:39.515933 [info ] [MainThread]:   reuse_connections: None
[0m16:21:39.516239 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:21:39.574725 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m16:21:39.575299 [debug] [MainThread]: Using snowflake connection "debug"
[0m16:21:39.575446 [debug] [MainThread]: On debug: select 1 as id
[0m16:21:39.575578 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:21:40.857662 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m16:21:40.858650 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m16:21:40.859322 [debug] [MainThread]: On debug: No close available on handle
[0m16:21:40.860311 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m16:21:40.860983 [info ] [MainThread]: [31m1 check failed:[0m
[0m16:21:40.861439 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: azb79167.snowflakecomputing.com:443. Failed to authenticate: MFA with TOTP is required. To authenticate, provide both your password and a current TOTP passcode.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m16:21:40.864849 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 1.7198703, "process_in_blocks": "0", "process_kernel_time": 0.226239, "process_mem_max_rss": "158564352", "process_out_blocks": "0", "process_user_time": 1.053565}
[0m16:21:40.865578 [debug] [MainThread]: Command `dbt debug` failed at 16:21:40.865409 after 1.72 seconds
[0m16:21:40.866079 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:21:40.866595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ee810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bc8310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa2910>]}
[0m16:21:40.867203 [debug] [MainThread]: Flushing usage events
[0m16:21:42.059657 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:29:07.011853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053810d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105380310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105378990>]}


============================== 16:29:07.015234 | 53a0b87c-8de9-4f35-a3c8-1b66a725c260 ==============================
[0m16:29:07.015234 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:29:07.015586 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/luc/.dbt', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'introspect': 'True', 'no_print': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'version_check': 'True', 'printer_width': '80', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'debug': 'False', 'empty': 'None'}
[0m16:29:07.024483 [info ] [MainThread]: dbt version: 1.10.13
[0m16:29:07.024702 [info ] [MainThread]: python version: 3.11.14
[0m16:29:07.024872 [info ] [MainThread]: python path: /Users/luc/ENTER/envs/dbt_env/bin/python
[0m16:29:07.025025 [info ] [MainThread]: os info: macOS-14.4.1-arm64-arm-64bit
[0m16:29:07.269647 [info ] [MainThread]: Using profiles dir at /Users/luc/.dbt
[0m16:29:07.269915 [info ] [MainThread]: Using profiles.yml file at /Users/luc/.dbt/profiles.yml
[0m16:29:07.270073 [info ] [MainThread]: Using dbt_project.yml file at /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/dbt_project.yml
[0m16:29:07.270512 [info ] [MainThread]: adapter type: snowflake
[0m16:29:07.270691 [info ] [MainThread]: adapter version: 1.8.4
[0m16:29:07.318793 [info ] [MainThread]: Configuration:
[0m16:29:07.319120 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:29:07.319273 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:29:07.319411 [info ] [MainThread]: Required dependencies:
[0m16:29:07.319611 [debug] [MainThread]: Executing "git --help"
[0m16:29:07.336968 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:29:07.337480 [debug] [MainThread]: STDERR: "b''"
[0m16:29:07.337660 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:29:07.337834 [info ] [MainThread]: Connection:
[0m16:29:07.338009 [info ] [MainThread]:   account: azb79167
[0m16:29:07.338151 [info ] [MainThread]:   user: MAGPIE
[0m16:29:07.338280 [info ] [MainThread]:   database: MAGPIE_FINAL_PROJECT
[0m16:29:07.338409 [info ] [MainThread]:   warehouse: TRAINING_WH
[0m16:29:07.338534 [info ] [MainThread]:   role: TRAINING_ROLE
[0m16:29:07.338658 [info ] [MainThread]:   schema: STAGING
[0m16:29:07.338795 [info ] [MainThread]:   authenticator: externalbrowser
[0m16:29:07.338925 [info ] [MainThread]:   oauth_client_id: None
[0m16:29:07.339049 [info ] [MainThread]:   query_tag: None
[0m16:29:07.339173 [info ] [MainThread]:   client_session_keep_alive: False
[0m16:29:07.339295 [info ] [MainThread]:   host: None
[0m16:29:07.339417 [info ] [MainThread]:   port: None
[0m16:29:07.339538 [info ] [MainThread]:   proxy_host: None
[0m16:29:07.339660 [info ] [MainThread]:   proxy_port: None
[0m16:29:07.339783 [info ] [MainThread]:   protocol: None
[0m16:29:07.339902 [info ] [MainThread]:   connect_retries: 1
[0m16:29:07.340021 [info ] [MainThread]:   connect_timeout: None
[0m16:29:07.340143 [info ] [MainThread]:   retry_on_database_errors: False
[0m16:29:07.340262 [info ] [MainThread]:   retry_all: False
[0m16:29:07.340380 [info ] [MainThread]:   insecure_mode: False
[0m16:29:07.340501 [info ] [MainThread]:   reuse_connections: None
[0m16:29:07.340807 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:29:07.400396 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m16:29:07.400995 [debug] [MainThread]: Using snowflake connection "debug"
[0m16:29:07.401147 [debug] [MainThread]: On debug: select 1 as id
[0m16:29:07.401285 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:29:08.316842 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m16:29:08.317322 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m16:29:08.317705 [debug] [MainThread]: On debug: No close available on handle
[0m16:29:08.318095 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m16:29:08.318481 [info ] [MainThread]: [31m1 check failed:[0m
[0m16:29:08.318775 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  390190 (08001): Failed to connect to DB: azb79167.snowflakecomputing.com:443, There was an error related to the SAML Identity Provider account parameter. Contact Snowflake support.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m16:29:08.321313 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 1.3487883, "process_in_blocks": "0", "process_kernel_time": 0.243436, "process_mem_max_rss": "161906688", "process_out_blocks": "0", "process_user_time": 1.051451}
[0m16:29:08.321812 [debug] [MainThread]: Command `dbt debug` failed at 16:29:08.321703 after 1.35 seconds
[0m16:29:08.322147 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:29:08.322501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105378ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079419d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10537bfd0>]}
[0m16:29:08.322897 [debug] [MainThread]: Flushing usage events
[0m16:29:08.663173 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:03:48.782909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122c7bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122c8a7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122c8ad50>]}


============================== 17:03:48.786880 | 97c21e59-338e-438a-9ef1-c139c41c7e71 ==============================
[0m17:03:48.786880 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:03:48.787233 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/luc/.dbt', 'introspect': 'True', 'warn_error': 'None', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'quiet': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'printer_width': '80', 'partial_parse': 'True', 'debug': 'False', 'version_check': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'empty': 'None'}
[0m17:03:48.796926 [info ] [MainThread]: dbt version: 1.10.13
[0m17:03:48.797136 [info ] [MainThread]: python version: 3.11.14
[0m17:03:48.797306 [info ] [MainThread]: python path: /Users/luc/ENTER/envs/dbt_env/bin/python
[0m17:03:48.797454 [info ] [MainThread]: os info: macOS-14.4.1-arm64-arm-64bit
[0m17:03:48.797846 [error] [MainThread]: Encountered an error:
Runtime Error
  Syntax error near line 32
  ------------------------------
  29 |       database: MAGPIE_FINAL_PROJECT
  30 |       schema: STAGING
  31 |       threads: 4
  32 |    target: dev
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 21, column 3
  did not find expected key
    in "<unicode string>", line 32, column 4
[0m17:03:48.803315 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.0425375, "process_in_blocks": "0", "process_kernel_time": 0.169333, "process_mem_max_rss": "105725952", "process_out_blocks": "0", "process_user_time": 0.691009}
[0m17:03:48.803574 [debug] [MainThread]: Command `dbt debug` failed at 17:03:48.803524 after 0.04 seconds
[0m17:03:48.803766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122c8a810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aae1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aae2d0>]}
[0m17:03:48.803957 [debug] [MainThread]: Flushing usage events
[0m17:03:49.106761 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:06:45.343834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f7a0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd4990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ffb510>]}


============================== 17:06:45.347369 | fa84ddfb-2f8f-4f48-917a-0abd30821118 ==============================
[0m17:06:45.347369 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:06:45.347718 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'static_parser': 'True', 'debug': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'invocation_command': 'dbt debug', 'profiles_dir': '/Users/luc/.dbt', 'warn_error': 'None', 'printer_width': '80', 'cache_selected_only': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'introspect': 'True', 'log_format': 'default', 'write_json': 'True', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'version_check': 'True', 'log_cache_events': 'False'}
[0m17:06:45.356500 [info ] [MainThread]: dbt version: 1.10.13
[0m17:06:45.356699 [info ] [MainThread]: python version: 3.11.14
[0m17:06:45.356867 [info ] [MainThread]: python path: /Users/luc/ENTER/envs/dbt_env/bin/python
[0m17:06:45.357013 [info ] [MainThread]: os info: macOS-14.4.1-arm64-arm-64bit
[0m17:06:45.358880 [info ] [MainThread]: Using profiles dir at /Users/luc/.dbt
[0m17:06:45.359048 [info ] [MainThread]: Using profiles.yml file at /Users/luc/.dbt/profiles.yml
[0m17:06:45.359192 [info ] [MainThread]: Using dbt_project.yml file at /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/dbt_project.yml
[0m17:06:45.408437 [info ] [MainThread]: Configuration:
[0m17:06:45.408711 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m17:06:45.408860 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:06:45.408997 [info ] [MainThread]: Required dependencies:
[0m17:06:45.409186 [debug] [MainThread]: Executing "git --help"
[0m17:06:45.459287 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:06:45.459855 [debug] [MainThread]: STDERR: "b''"
[0m17:06:45.460049 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:06:45.460250 [info ] [MainThread]: Connection test skipped since no profile was found
[0m17:06:45.460411 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:06:45.460556 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'youtube_final'


[0m17:06:45.462362 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.15861362, "process_in_blocks": "0", "process_kernel_time": 0.141826, "process_mem_max_rss": "108937216", "process_out_blocks": "0", "process_user_time": 0.742199}
[0m17:06:45.462735 [debug] [MainThread]: Command `dbt debug` failed at 17:06:45.462665 after 0.16 seconds
[0m17:06:45.463047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1008dca50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1008dca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f73f50>]}
[0m17:06:45.463324 [debug] [MainThread]: Flushing usage events
[0m17:06:45.762804 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:09:37.362117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e3a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10573d690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10575ef90>]}


============================== 17:09:37.365550 | 1ab1ee7e-8c3c-4451-bdec-439e6e84165a ==============================
[0m17:09:37.365550 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:09:37.365896 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'introspect': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'printer_width': '80', 'use_colors': 'True', 'profiles_dir': '/Users/luc/.dbt', 'warn_error': 'None', 'fail_fast': 'False', 'empty': 'None', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'partial_parse': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'write_json': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'no_print': 'None'}
[0m17:09:37.374886 [info ] [MainThread]: dbt version: 1.10.13
[0m17:09:37.375090 [info ] [MainThread]: python version: 3.11.14
[0m17:09:37.375261 [info ] [MainThread]: python path: /Users/luc/ENTER/envs/dbt_env/bin/python
[0m17:09:37.375411 [info ] [MainThread]: os info: macOS-14.4.1-arm64-arm-64bit
[0m17:09:37.663304 [info ] [MainThread]: Using profiles dir at /Users/luc/.dbt
[0m17:09:37.663580 [info ] [MainThread]: Using profiles.yml file at /Users/luc/.dbt/profiles.yml
[0m17:09:37.663740 [info ] [MainThread]: Using dbt_project.yml file at /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/dbt_project.yml
[0m17:09:37.664191 [info ] [MainThread]: adapter type: snowflake
[0m17:09:37.664374 [info ] [MainThread]: adapter version: 1.8.4
[0m17:09:37.712570 [info ] [MainThread]: Configuration:
[0m17:09:37.712861 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:09:37.713016 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:09:37.713155 [info ] [MainThread]: Required dependencies:
[0m17:09:37.713349 [debug] [MainThread]: Executing "git --help"
[0m17:09:37.729810 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:09:37.730375 [debug] [MainThread]: STDERR: "b''"
[0m17:09:37.730548 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:09:37.730723 [info ] [MainThread]: Connection:
[0m17:09:37.730907 [info ] [MainThread]:   account: azb79167
[0m17:09:37.731042 [info ] [MainThread]:   user: MAGPIE
[0m17:09:37.731172 [info ] [MainThread]:   database: MAGPIE_FINAL_PROJECT
[0m17:09:37.731316 [info ] [MainThread]:   warehouse: TRAINING_WH
[0m17:09:37.731440 [info ] [MainThread]:   role: TRAINING_ROLE
[0m17:09:37.731567 [info ] [MainThread]:   schema: STAGING
[0m17:09:37.731694 [info ] [MainThread]:   authenticator: externalbrowser
[0m17:09:37.731827 [info ] [MainThread]:   oauth_client_id: None
[0m17:09:37.731951 [info ] [MainThread]:   query_tag: None
[0m17:09:37.732075 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:09:37.732201 [info ] [MainThread]:   host: None
[0m17:09:37.732321 [info ] [MainThread]:   port: None
[0m17:09:37.732442 [info ] [MainThread]:   proxy_host: None
[0m17:09:37.732566 [info ] [MainThread]:   proxy_port: None
[0m17:09:37.732688 [info ] [MainThread]:   protocol: None
[0m17:09:37.732816 [info ] [MainThread]:   connect_retries: 1
[0m17:09:37.732937 [info ] [MainThread]:   connect_timeout: None
[0m17:09:37.733056 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:09:37.733174 [info ] [MainThread]:   retry_all: False
[0m17:09:37.733293 [info ] [MainThread]:   insecure_mode: False
[0m17:09:37.733413 [info ] [MainThread]:   reuse_connections: None
[0m17:09:37.733751 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:09:37.802337 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:09:37.802892 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:09:37.803043 [debug] [MainThread]: On debug: select 1 as id
[0m17:09:37.803176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:09:38.698227 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m17:09:38.698682 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m17:09:38.699030 [debug] [MainThread]: On debug: No close available on handle
[0m17:09:38.699367 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:09:38.699701 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:09:38.699993 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  390190 (08001): Failed to connect to DB: azb79167.snowflakecomputing.com:443, There was an error related to the SAML Identity Provider account parameter. Contact Snowflake support.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:09:38.702295 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 1.3792832, "process_in_blocks": "0", "process_kernel_time": 0.25864, "process_mem_max_rss": "159580160", "process_out_blocks": "0", "process_user_time": 1.052187}
[0m17:09:38.702849 [debug] [MainThread]: Command `dbt debug` failed at 17:09:38.702724 after 1.38 seconds
[0m17:09:38.703213 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:09:38.703565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1012a6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1012a6290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1012a6450>]}
[0m17:09:38.703974 [debug] [MainThread]: Flushing usage events
[0m17:09:39.059153 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:43:24.562599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057534f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ed430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ed760>]}


============================== 19:43:24.566052 | f3ad3f05-239f-4623-9e09-b8ad002c0d0c ==============================
[0m19:43:24.566052 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:43:24.566390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'debug': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'no_print': 'None', 'version_check': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'invocation_command': 'dbt debug', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'empty': 'None', 'introspect': 'True', 'fail_fast': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/luc/.dbt', 'partial_parse': 'True', 'log_format': 'default', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True'}
[0m19:43:24.575429 [info ] [MainThread]: dbt version: 1.10.13
[0m19:43:24.575647 [info ] [MainThread]: python version: 3.9.6
[0m19:43:24.575825 [info ] [MainThread]: python path: /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/magpie_youtube/.venv_dbt/bin/python3
[0m19:43:24.575986 [info ] [MainThread]: os info: macOS-14.4.1-arm64-arm-64bit
[0m19:43:24.577902 [info ] [MainThread]: Using profiles dir at /Users/luc/.dbt
[0m19:43:24.578085 [info ] [MainThread]: Using profiles.yml file at /Users/luc/.dbt/profiles.yml
[0m19:43:24.578250 [info ] [MainThread]: Using dbt_project.yml file at /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/dbt_project.yml
[0m19:43:24.639722 [info ] [MainThread]: Configuration:
[0m19:43:24.640011 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m19:43:24.640176 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:43:24.640326 [info ] [MainThread]: Required dependencies:
[0m19:43:24.640546 [debug] [MainThread]: Executing "git --help"
[0m19:43:24.656368 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:43:24.656903 [debug] [MainThread]: STDERR: "b''"
[0m19:43:24.657102 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:43:24.657293 [info ] [MainThread]: Connection test skipped since no profile was found
[0m19:43:24.657460 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:43:24.657616 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'youtube_final'


[0m19:43:24.659487 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.14685933, "process_in_blocks": "0", "process_kernel_time": 0.105354, "process_mem_max_rss": "98091008", "process_out_blocks": "0", "process_user_time": 0.829719}
[0m19:43:24.659832 [debug] [MainThread]: Command `dbt debug` failed at 19:43:24.659764 after 0.15 seconds
[0m19:43:24.660113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057534f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ed190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ee41c0>]}
[0m19:43:24.660392 [debug] [MainThread]: Flushing usage events
[0m19:43:25.013238 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:43:25.939934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10588b5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106925760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106925a90>]}


============================== 19:43:25.942332 | b247e673-dd0d-44b1-bfa9-39cbcdd33e77 ==============================
[0m19:43:25.942332 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:43:25.942675 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'write_json': 'True', 'invocation_command': 'dbt run', 'empty': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error': 'None', 'target_path': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'profiles_dir': '/Users/luc/.dbt', 'quiet': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'static_parser': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'debug': 'False'}
[0m19:43:25.944581 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'youtube_final'
[0m19:43:25.945429 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.046145584, "process_in_blocks": "0", "process_kernel_time": 0.06623, "process_mem_max_rss": "95223808", "process_out_blocks": "0", "process_user_time": 0.728072}
[0m19:43:25.945685 [debug] [MainThread]: Command `dbt run` failed at 19:43:25.945632 after 0.05 seconds
[0m19:43:25.945871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10588b5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f4a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10689b910>]}
[0m19:43:25.946064 [debug] [MainThread]: Flushing usage events
[0m19:43:26.140789 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:58:30.745159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105340610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072095e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107209910>]}


============================== 19:58:30.748747 | a49121fe-9e83-4283-a4d6-997463cdda19 ==============================
[0m19:58:30.748747 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:58:30.749115 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/luc/.dbt', 'debug': 'False', 'target_path': 'None', 'partial_parse': 'True', 'printer_width': '80', 'static_parser': 'True', 'fail_fast': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'empty': 'None', 'use_experimental_parser': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'quiet': 'False', 'version_check': 'True', 'write_json': 'True', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'invocation_command': 'dbt debug', 'no_print': 'None'}
[0m19:58:30.757943 [info ] [MainThread]: dbt version: 1.10.13
[0m19:58:30.758148 [info ] [MainThread]: python version: 3.9.6
[0m19:58:30.758315 [info ] [MainThread]: python path: /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/magpie_youtube/.venv_dbt/bin/python3
[0m19:58:30.758477 [info ] [MainThread]: os info: macOS-14.4.1-arm64-arm-64bit
[0m19:58:30.760307 [info ] [MainThread]: Using profiles dir at /Users/luc/.dbt
[0m19:58:30.760489 [info ] [MainThread]: Using profiles.yml file at /Users/luc/.dbt/profiles.yml
[0m19:58:30.760650 [info ] [MainThread]: Using dbt_project.yml file at /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/dbt_project.yml
[0m19:58:30.820474 [info ] [MainThread]: Configuration:
[0m19:58:30.820800 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m19:58:30.820964 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:58:30.821117 [info ] [MainThread]: Required dependencies:
[0m19:58:30.821343 [debug] [MainThread]: Executing "git --help"
[0m19:58:30.836603 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:58:30.837185 [debug] [MainThread]: STDERR: "b''"
[0m19:58:30.837417 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:58:30.837610 [info ] [MainThread]: Connection test skipped since no profile was found
[0m19:58:30.837780 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:58:30.837935 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'youtube_final'


[0m19:58:30.839625 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.14201267, "process_in_blocks": "0", "process_kernel_time": 0.153799, "process_mem_max_rss": "98107392", "process_out_blocks": "0", "process_user_time": 0.826035}
[0m19:58:30.839971 [debug] [MainThread]: Command `dbt debug` failed at 19:58:30.839903 after 0.14 seconds
[0m19:58:30.840240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105340610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e465e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072d67f0>]}
[0m19:58:30.840498 [debug] [MainThread]: Flushing usage events
[0m19:58:31.134519 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:01:24.131889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056635e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fd4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fd820>]}


============================== 20:01:24.135170 | dd598564-bf06-4b5e-8542-2a9313b96065 ==============================
[0m20:01:24.135170 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:01:24.135512 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'use_colors': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'quiet': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'printer_width': '80', 'static_parser': 'True', 'no_print': 'None', 'introspect': 'True', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'version_check': 'True', 'debug': 'False', 'profiles_dir': '/Users/luc/.dbt', 'invocation_command': 'dbt debug', 'target_path': 'None'}
[0m20:01:24.144217 [info ] [MainThread]: dbt version: 1.10.13
[0m20:01:24.144415 [info ] [MainThread]: python version: 3.9.6
[0m20:01:24.144582 [info ] [MainThread]: python path: /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/magpie_youtube/.venv_dbt/bin/python3
[0m20:01:24.144743 [info ] [MainThread]: os info: macOS-14.4.1-arm64-arm-64bit
[0m20:01:24.836042 [info ] [MainThread]: Using profiles dir at /Users/luc/.dbt
[0m20:01:24.836365 [info ] [MainThread]: Using profiles.yml file at /Users/luc/.dbt/profiles.yml
[0m20:01:24.836572 [info ] [MainThread]: Using dbt_project.yml file at /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/dbt_project.yml
[0m20:01:24.837892 [info ] [MainThread]: adapter type: duckdb
[0m20:01:24.838127 [info ] [MainThread]: adapter version: 1.10.0
[0m20:01:24.901694 [info ] [MainThread]: Configuration:
[0m20:01:24.901990 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:01:24.902160 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:01:24.902316 [info ] [MainThread]: Required dependencies:
[0m20:01:24.902537 [debug] [MainThread]: Executing "git --help"
[0m20:01:24.917783 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:01:24.918319 [debug] [MainThread]: STDERR: "b''"
[0m20:01:24.918517 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:01:24.918703 [info ] [MainThread]: Connection:
[0m20:01:24.918921 [info ] [MainThread]:   database: youtube
[0m20:01:24.919072 [info ] [MainThread]:   schema: main
[0m20:01:24.919223 [info ] [MainThread]:   path: /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/youtube.duckdb
[0m20:01:24.919375 [info ] [MainThread]:   config_options: None
[0m20:01:24.919516 [info ] [MainThread]:   extensions: None
[0m20:01:24.919658 [info ] [MainThread]:   settings: {}
[0m20:01:24.919797 [info ] [MainThread]:   external_root: .
[0m20:01:24.919934 [info ] [MainThread]:   use_credential_provider: None
[0m20:01:24.920071 [info ] [MainThread]:   attach: None
[0m20:01:24.920209 [info ] [MainThread]:   filesystems: None
[0m20:01:24.920347 [info ] [MainThread]:   remote: None
[0m20:01:24.920485 [info ] [MainThread]:   plugins: None
[0m20:01:24.920625 [info ] [MainThread]:   disable_transactions: False
[0m20:01:24.921020 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:01:24.998134 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m20:01:25.025823 [debug] [MainThread]: Using duckdb connection "debug"
[0m20:01:25.026061 [debug] [MainThread]: On debug: select 1 as id
[0m20:01:25.026214 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:01:25.032772 [debug] [MainThread]: SQL status: OK in 0.007 seconds
[0m20:01:25.033346 [debug] [MainThread]: On debug: Close
[0m20:01:25.033561 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:01:25.033737 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:01:25.035225 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.9487575, "process_in_blocks": "0", "process_kernel_time": 0.19905, "process_mem_max_rss": "125255680", "process_out_blocks": "0", "process_user_time": 0.956061}
[0m20:01:25.035488 [debug] [MainThread]: Command `dbt debug` succeeded at 20:01:25.035425 after 0.95 seconds
[0m20:01:25.035659 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:01:25.035844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056635e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691bb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e83a0>]}
[0m20:01:25.036075 [debug] [MainThread]: Flushing usage events
[0m20:01:25.368382 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:03:37.972528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036ab580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104746700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104746a30>]}


============================== 20:03:37.975677 | 8a18295f-77c8-4662-88c1-b82be6a22dd0 ==============================
[0m20:03:37.975677 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:03:37.976054 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'debug': 'False', 'partial_parse': 'True', 'version_check': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'no_print': 'None', 'target_path': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'warn_error': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'empty': 'False', 'profiles_dir': '/Users/luc/.dbt', 'printer_width': '80', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run'}
[0m20:03:38.156378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a18295f-77c8-4662-88c1-b82be6a22dd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101e3c8b0>]}
[0m20:03:38.191478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a18295f-77c8-4662-88c1-b82be6a22dd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044d69a0>]}
[0m20:03:38.192887 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:03:38.273961 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:03:38.274470 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:03:38.274683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8a18295f-77c8-4662-88c1-b82be6a22dd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10497f400>]}
[0m20:03:39.038007 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m20:03:39.038331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8a18295f-77c8-4662-88c1-b82be6a22dd0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050bc040>]}
[0m20:03:39.072690 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.youtube_dbt_project.dim_category' (models/marts/dim_category.sql) depends on a node named 'stg_category_mapping' which was not found
[0m20:03:39.073086 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:03:39.075288 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1493052, "process_in_blocks": "0", "process_kernel_time": 0.209124, "process_mem_max_rss": "129875968", "process_out_blocks": "0", "process_user_time": 1.727383}
[0m20:03:39.075533 [debug] [MainThread]: Command `dbt run` failed at 20:03:39.075483 after 1.15 seconds
[0m20:03:39.075756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036ab580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10506ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10506ca00>]}
[0m20:03:39.075965 [debug] [MainThread]: Flushing usage events
[0m20:03:39.363641 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:11:42.445461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a80550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a64a580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a64a8b0>]}


============================== 20:11:42.448571 | 52a6901b-ebf3-46bb-bd2e-a7b94d2b9006 ==============================
[0m20:11:42.448571 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:11:42.448936 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'no_print': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'quiet': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'fail_fast': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'target_path': 'None', 'profiles_dir': '/Users/luc/.dbt'}
[0m20:11:42.627292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52a6901b-ebf3-46bb-bd2e-a7b94d2b9006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a851280>]}
[0m20:11:42.664216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52a6901b-ebf3-46bb-bd2e-a7b94d2b9006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a888e50>]}
[0m20:11:42.665826 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:11:42.747374 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:11:42.748118 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:11:42.748363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '52a6901b-ebf3-46bb-bd2e-a7b94d2b9006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9ebf70>]}
[0m20:11:43.411776 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_category' in the 'models' section of file 'models/schema.yml'
[0m20:11:43.516225 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m20:11:43.516544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '52a6901b-ebf3-46bb-bd2e-a7b94d2b9006', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb40f40>]}
[0m20:11:43.551812 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.youtube_dbt_project.dim_category_unused' (models/marts/dim_category_unused.sql) depends on a node named 'stg_category_mapping' which was not found
[0m20:11:43.552292 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:11:43.554476 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1554642, "process_in_blocks": "0", "process_kernel_time": 0.214661, "process_mem_max_rss": "129581056", "process_out_blocks": "0", "process_user_time": 1.73476}
[0m20:11:43.554728 [debug] [MainThread]: Command `dbt run` failed at 20:11:43.554671 after 1.16 seconds
[0m20:11:43.554942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a80550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108babc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb9dca0>]}
[0m20:11:43.555146 [debug] [MainThread]: Flushing usage events
[0m20:11:43.901403 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:11:55.590417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ff7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050957f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105095b20>]}


============================== 20:11:55.593027 | 9aced638-885e-4c53-9a93-d8db41c4dd24 ==============================
[0m20:11:55.593027 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:11:55.593372 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'no_print': 'None', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'version_check': 'True', 'profiles_dir': '/Users/luc/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -m stg_youtube_videos', 'empty': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error': 'None'}
[0m20:11:55.593726 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m20:11:55.593938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9aced638-885e-4c53-9a93-d8db41c4dd24', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105095940>]}
[0m20:11:55.773995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9aced638-885e-4c53-9a93-d8db41c4dd24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051b25b0>]}
[0m20:11:55.808709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9aced638-885e-4c53-9a93-d8db41c4dd24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050060d0>]}
[0m20:11:55.810438 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:11:55.894087 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:11:55.895064 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:11:55.895288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9aced638-885e-4c53-9a93-d8db41c4dd24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d2cd0>]}
[0m20:11:56.551928 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_category' in the 'models' section of file 'models/schema.yml'
[0m20:11:56.655168 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m20:11:56.655491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9aced638-885e-4c53-9a93-d8db41c4dd24', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a0f880>]}
[0m20:11:56.689892 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.youtube_dbt_project.dim_category_unused' (models/marts/dim_category_unused.sql) depends on a node named 'stg_category_mapping' which was not found
[0m20:11:56.690309 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:11:56.691794 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1454214, "process_in_blocks": "0", "process_kernel_time": 0.162872, "process_mem_max_rss": "129990656", "process_out_blocks": "0", "process_user_time": 1.724247}
[0m20:11:56.692062 [debug] [MainThread]: Command `dbt run` failed at 20:11:56.692008 after 1.15 seconds
[0m20:11:56.692277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ff7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057214c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057214f0>]}
[0m20:11:56.692489 [debug] [MainThread]: Flushing usage events
[0m20:11:56.872399 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:16:10.723343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059db5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a76790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a76ac0>]}


============================== 20:16:10.726590 | 7cd8f59a-d679-4c6f-842f-8370302489e2 ==============================
[0m20:16:10.726590 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:16:10.726941 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'static_parser': 'True', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'fail_fast': 'False', 'log_format': 'default', 'introspect': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'debug': 'False', 'target_path': 'None', 'partial_parse': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/Users/luc/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False'}
[0m20:16:10.896953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cd8f59a-d679-4c6f-842f-8370302489e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cad6d0>]}
[0m20:16:10.931513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cd8f59a-d679-4c6f-842f-8370302489e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b0c640>]}
[0m20:16:10.932945 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:16:11.015332 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:16:11.015871 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:16:11.016083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7cd8f59a-d679-4c6f-842f-8370302489e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d40100>]}
[0m20:16:11.728635 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m20:16:11.728964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7cd8f59a-d679-4c6f-842f-8370302489e2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107365a90>]}
[0m20:16:11.751674 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.youtube_dbt_project.stg_youtube_videos' (models/staging/stg_youtube_videos.sql) depends on a source named 'raw.raw_youtube_trending' which was not found
[0m20:16:11.752037 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:16:11.754253 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0770609, "process_in_blocks": "0", "process_kernel_time": 0.205687, "process_mem_max_rss": "128090112", "process_out_blocks": "0", "process_user_time": 1.657288}
[0m20:16:11.754483 [debug] [MainThread]: Command `dbt run` failed at 20:16:11.754428 after 1.08 seconds
[0m20:16:11.754688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059db5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107224a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107261910>]}
[0m20:16:11.754884 [debug] [MainThread]: Flushing usage events
[0m20:16:12.067528 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:18:44.103991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fdf5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10507b7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10507baf0>]}


============================== 20:18:44.107112 | d73f4881-d81c-4858-b806-07868ac682dd ==============================
[0m20:18:44.107112 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:18:44.107467 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'printer_width': '80', 'introspect': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/luc/.dbt', 'quiet': 'False', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'warn_error': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'invocation_command': 'dbt run --select stg_youtube_videos'}
[0m20:18:44.297097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd73f4881-d81c-4858-b806-07868ac682dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105116820>]}
[0m20:18:44.332479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd73f4881-d81c-4858-b806-07868ac682dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10490e0a0>]}
[0m20:18:44.333961 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:18:44.414785 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:18:44.415316 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:18:44.415529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd73f4881-d81c-4858-b806-07868ac682dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10526f370>]}
[0m20:18:45.125761 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m20:18:45.126084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd73f4881-d81c-4858-b806-07868ac682dd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10596d310>]}
[0m20:18:45.266853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd73f4881-d81c-4858-b806-07868ac682dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a3eee0>]}
[0m20:18:45.364576 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m20:18:45.365911 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m20:18:45.377557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd73f4881-d81c-4858-b806-07868ac682dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058808b0>]}
[0m20:18:45.377856 [info ] [MainThread]: Found 5 models, 13 data tests, 1 source, 456 macros
[0m20:18:45.378050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd73f4881-d81c-4858-b806-07868ac682dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105806820>]}
[0m20:18:45.378757 [info ] [MainThread]: 
[0m20:18:45.378943 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:18:45.379095 [info ] [MainThread]: 
[0m20:18:45.379356 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:18:45.379804 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_youtube'
[0m20:18:45.413365 [debug] [ThreadPool]: Using duckdb connection "list_youtube"
[0m20:18:45.413664 [debug] [ThreadPool]: On list_youtube: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_youtube"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"youtube"'
    
  
  
[0m20:18:45.413844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:18:45.427778 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m20:18:45.429044 [debug] [ThreadPool]: On list_youtube: Close
[0m20:18:45.429440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_youtube, now create_youtube_main_STAGING)
[0m20:18:45.429712 [debug] [ThreadPool]: Creating schema "database: "youtube"
schema: "main_STAGING"
"
[0m20:18:45.434035 [debug] [ThreadPool]: Using duckdb connection "create_youtube_main_STAGING"
[0m20:18:45.434224 [debug] [ThreadPool]: On create_youtube_main_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "create_youtube_main_STAGING"} */

    
        select type from duckdb_databases()
        where lower(database_name)='youtube'
        and type='sqlite'
    
  
[0m20:18:45.434379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:18:45.434970 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:18:45.435633 [debug] [ThreadPool]: Using duckdb connection "create_youtube_main_STAGING"
[0m20:18:45.435798 [debug] [ThreadPool]: On create_youtube_main_STAGING: BEGIN
[0m20:18:45.436026 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:18:45.436178 [debug] [ThreadPool]: Using duckdb connection "create_youtube_main_STAGING"
[0m20:18:45.436335 [debug] [ThreadPool]: On create_youtube_main_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "create_youtube_main_STAGING"} */

    
    
        create schema if not exists "youtube"."main_STAGING"
    
[0m20:18:45.436738 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:18:45.437178 [debug] [ThreadPool]: On create_youtube_main_STAGING: COMMIT
[0m20:18:45.437330 [debug] [ThreadPool]: Using duckdb connection "create_youtube_main_STAGING"
[0m20:18:45.437479 [debug] [ThreadPool]: On create_youtube_main_STAGING: COMMIT
[0m20:18:45.438770 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:18:45.438943 [debug] [ThreadPool]: On create_youtube_main_STAGING: Close
[0m20:18:45.442254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_youtube_main_STAGING, now list_youtube_main_MARTS)
[0m20:18:45.445683 [debug] [ThreadPool]: Using duckdb connection "list_youtube_main_MARTS"
[0m20:18:45.445861 [debug] [ThreadPool]: On list_youtube_main_MARTS: BEGIN
[0m20:18:45.446101 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_youtube_main_STAGING'
[0m20:18:45.446273 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:18:45.447535 [debug] [ThreadPool]: Using duckdb connection "list_youtube_main_STAGING"
[0m20:18:45.447784 [debug] [ThreadPool]: On list_youtube_main_STAGING: BEGIN
[0m20:18:45.447960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:18:45.448119 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:18:45.448326 [debug] [ThreadPool]: Using duckdb connection "list_youtube_main_MARTS"
[0m20:18:45.448495 [debug] [ThreadPool]: On list_youtube_main_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_youtube_main_MARTS"} */
select
      'youtube' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'youtube'
  
[0m20:18:45.448657 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:18:45.448875 [debug] [ThreadPool]: Using duckdb connection "list_youtube_main_STAGING"
[0m20:18:45.449039 [debug] [ThreadPool]: On list_youtube_main_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_youtube_main_STAGING"} */
select
      'youtube' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'youtube'
  
[0m20:18:45.455977 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:18:45.456209 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:18:45.456864 [debug] [ThreadPool]: On list_youtube_main_STAGING: ROLLBACK
[0m20:18:45.457464 [debug] [ThreadPool]: On list_youtube_main_MARTS: ROLLBACK
[0m20:18:45.459253 [debug] [ThreadPool]: Failed to rollback 'list_youtube_main_STAGING'
[0m20:18:45.459456 [debug] [ThreadPool]: Failed to rollback 'list_youtube_main_MARTS'
[0m20:18:45.459610 [debug] [ThreadPool]: On list_youtube_main_STAGING: Close
[0m20:18:45.459769 [debug] [ThreadPool]: On list_youtube_main_MARTS: Close
[0m20:18:45.460173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd73f4881-d81c-4858-b806-07868ac682dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058dc550>]}
[0m20:18:45.460432 [debug] [MainThread]: Using duckdb connection "master"
[0m20:18:45.460584 [debug] [MainThread]: On master: BEGIN
[0m20:18:45.460720 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:18:45.460965 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:18:45.461120 [debug] [MainThread]: On master: COMMIT
[0m20:18:45.461271 [debug] [MainThread]: Using duckdb connection "master"
[0m20:18:45.461417 [debug] [MainThread]: On master: COMMIT
[0m20:18:45.461623 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:18:45.461779 [debug] [MainThread]: On master: Close
[0m20:18:45.463848 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.stg_youtube_videos
[0m20:18:45.464152 [info ] [Thread-1  ]: 1 of 1 START sql view model main_STAGING.stg_youtube_videos .................... [RUN]
[0m20:18:45.464513 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_youtube_main_MARTS, now model.youtube_dbt_project.stg_youtube_videos)
[0m20:18:45.464721 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.stg_youtube_videos
[0m20:18:45.469727 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.stg_youtube_videos"
[0m20:18:45.470338 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.stg_youtube_videos
[0m20:18:45.487837 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.stg_youtube_videos"
[0m20:18:45.488439 [debug] [Thread-1  ]: Using duckdb connection "model.youtube_dbt_project.stg_youtube_videos"
[0m20:18:45.488640 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: BEGIN
[0m20:18:45.488816 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:18:45.489173 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m20:18:45.489364 [debug] [Thread-1  ]: Using duckdb connection "model.youtube_dbt_project.stg_youtube_videos"
[0m20:18:45.489582 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.stg_youtube_videos"} */

  
  create view "youtube"."main_STAGING"."stg_youtube_videos__dbt_tmp" as (
    with source as (

    select
        video_id,
        trending_date,
        title,
        channel_title,
        category_id,
        publish_time,
        tags,
        views::number as views,
        likes::number as likes,
        dislikes::number as dislikes,
        comment_count::number as comment_count,
        country,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from "MAGPIE_FINAL_PROJECT"."RAW"."RAW_YOUTUBE_TRENDING"

),

cleaned as (
    select
        video_id,
        to_date(trending_date) as trending_date,
        title,
        channel_title,
        category_id,
        to_timestamp(publish_time) as publish_time,
        tags,
        views,
        likes,
        dislikes,
        comment_count,
        country,
        coalesce(comments_disabled, false) as comments_disabled,
        coalesce(ratings_disabled, false) as ratings_disabled,
        coalesce(video_error_or_removed, false) as video_error_or_removed
    from source
)

select * from cleaned;
  );

[0m20:18:45.493208 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.stg_youtube_videos"} */

  
  create view "youtube"."main_STAGING"."stg_youtube_videos__dbt_tmp" as (
    with source as (

    select
        video_id,
        trending_date,
        title,
        channel_title,
        category_id,
        publish_time,
        tags,
        views::number as views,
        likes::number as likes,
        dislikes::number as dislikes,
        comment_count::number as comment_count,
        country,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from "MAGPIE_FINAL_PROJECT"."RAW"."RAW_YOUTUBE_TRENDING"

),

cleaned as (
    select
        video_id,
        to_date(trending_date) as trending_date,
        title,
        channel_title,
        category_id,
        to_timestamp(publish_time) as publish_time,
        tags,
        views,
        likes,
        dislikes,
        comment_count,
        country,
        coalesce(comments_disabled, false) as comments_disabled,
        coalesce(ratings_disabled, false) as ratings_disabled,
        coalesce(video_error_or_removed, false) as video_error_or_removed
    from source
)

select * from cleaned;
  );

[0m20:18:45.493438 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m20:18:45.493660 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: ROLLBACK
[0m20:18:45.509512 [debug] [Thread-1  ]: Failed to rollback 'model.youtube_dbt_project.stg_youtube_videos'
[0m20:18:45.509767 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: Close
[0m20:18:45.513062 [debug] [Thread-1  ]: Runtime Error in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 47: select * from cleaned;
                                ^
[0m20:18:45.516466 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd73f4881-d81c-4858-b806-07868ac682dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039dba90>]}
[0m20:18:45.516845 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model main_STAGING.stg_youtube_videos ........... [[31mERROR[0m in 0.05s]
[0m20:18:45.517172 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.stg_youtube_videos
[0m20:18:45.517448 [debug] [Thread-7  ]: Marking all children of 'model.youtube_dbt_project.stg_youtube_videos' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 47: select * from cleaned;
                                ^.
[0m20:18:45.518057 [debug] [MainThread]: Using duckdb connection "master"
[0m20:18:45.518219 [debug] [MainThread]: On master: BEGIN
[0m20:18:45.518357 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:18:45.518658 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:18:45.518807 [debug] [MainThread]: On master: COMMIT
[0m20:18:45.518954 [debug] [MainThread]: Using duckdb connection "master"
[0m20:18:45.519094 [debug] [MainThread]: On master: COMMIT
[0m20:18:45.519294 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:18:45.519445 [debug] [MainThread]: On master: Close
[0m20:18:45.519637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:18:45.519776 [debug] [MainThread]: Connection 'model.youtube_dbt_project.stg_youtube_videos' was properly closed.
[0m20:18:45.519907 [debug] [MainThread]: Connection 'list_youtube_main_STAGING' was properly closed.
[0m20:18:45.520055 [info ] [MainThread]: 
[0m20:18:45.520214 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m20:18:45.520567 [debug] [MainThread]: Command end result
[0m20:18:45.537318 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m20:18:45.538299 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m20:18:45.541918 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m20:18:45.542099 [info ] [MainThread]: 
[0m20:18:45.542308 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:18:45.542482 [info ] [MainThread]: 
[0m20:18:45.542695 [error] [MainThread]: [31mFailure in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)[0m
[0m20:18:45.542902 [error] [MainThread]:   Runtime Error in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 47: select * from cleaned;
                                ^
[0m20:18:45.543055 [info ] [MainThread]: 
[0m20:18:45.543240 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/staging/stg_youtube_videos.sql
[0m20:18:45.543388 [info ] [MainThread]: 
[0m20:18:45.543556 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:18:45.543860 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:18:45.545189 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4871863, "process_in_blocks": "0", "process_kernel_time": 0.234422, "process_mem_max_rss": "143982592", "process_out_blocks": "0", "process_user_time": 2.019245}
[0m20:18:45.545398 [debug] [MainThread]: Command `dbt run` failed at 20:18:45.545356 after 1.49 seconds
[0m20:18:45.545594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fdf5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058801f0>]}
[0m20:18:45.545789 [debug] [MainThread]: Flushing usage events
[0m20:18:45.855862 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:25:42.514395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10857f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10857fa60>]}


============================== 20:25:42.517572 | a540d1cd-796f-4720-b817-ed822099907f ==============================
[0m20:25:42.517572 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:25:42.517971 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/luc/.dbt', 'use_colors': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'introspect': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --select stg_youtube_videos', 'log_format': 'default', 'cache_selected_only': 'False', 'static_parser': 'True', 'warn_error': 'None', 'debug': 'False', 'printer_width': '80', 'write_json': 'True'}
[0m20:25:42.702238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a540d1cd-796f-4720-b817-ed822099907f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108555130>]}
[0m20:25:42.737020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a540d1cd-796f-4720-b817-ed822099907f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086a4040>]}
[0m20:25:42.738453 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:25:42.820385 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:25:42.916527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:25:42.916922 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/staging/stg_youtube_videos.sql
[0m20:25:43.188505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a540d1cd-796f-4720-b817-ed822099907f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ded130>]}
[0m20:25:43.250143 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m20:25:43.251345 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m20:25:43.263719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a540d1cd-796f-4720-b817-ed822099907f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba6b80>]}
[0m20:25:43.264071 [info ] [MainThread]: Found 5 models, 13 data tests, 1 source, 456 macros
[0m20:25:43.264267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a540d1cd-796f-4720-b817-ed822099907f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de9e50>]}
[0m20:25:43.265009 [info ] [MainThread]: 
[0m20:25:43.265203 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:25:43.265361 [info ] [MainThread]: 
[0m20:25:43.265683 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:25:43.266170 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_youtube'
[0m20:25:43.311169 [debug] [ThreadPool]: Using duckdb connection "list_youtube"
[0m20:25:43.311433 [debug] [ThreadPool]: On list_youtube: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_youtube"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"youtube"'
    
  
  
[0m20:25:43.311596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:43.323937 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m20:25:43.325108 [debug] [ThreadPool]: On list_youtube: Close
[0m20:25:43.325498 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_youtube, now create_youtube_main_STAGING)
[0m20:25:43.325778 [debug] [ThreadPool]: Creating schema "database: "youtube"
schema: "main_STAGING"
"
[0m20:25:43.329895 [debug] [ThreadPool]: Using duckdb connection "create_youtube_main_STAGING"
[0m20:25:43.330085 [debug] [ThreadPool]: On create_youtube_main_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "create_youtube_main_STAGING"} */

    
        select type from duckdb_databases()
        where lower(database_name)='youtube'
        and type='sqlite'
    
  
[0m20:25:43.330245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:43.330942 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:25:43.331618 [debug] [ThreadPool]: Using duckdb connection "create_youtube_main_STAGING"
[0m20:25:43.331784 [debug] [ThreadPool]: On create_youtube_main_STAGING: BEGIN
[0m20:25:43.332015 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:25:43.332170 [debug] [ThreadPool]: Using duckdb connection "create_youtube_main_STAGING"
[0m20:25:43.332329 [debug] [ThreadPool]: On create_youtube_main_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "create_youtube_main_STAGING"} */

    
    
        create schema if not exists "youtube"."main_STAGING"
    
[0m20:25:43.332738 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:25:43.333181 [debug] [ThreadPool]: On create_youtube_main_STAGING: COMMIT
[0m20:25:43.333334 [debug] [ThreadPool]: Using duckdb connection "create_youtube_main_STAGING"
[0m20:25:43.333487 [debug] [ThreadPool]: On create_youtube_main_STAGING: COMMIT
[0m20:25:43.333683 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:25:43.333840 [debug] [ThreadPool]: On create_youtube_main_STAGING: Close
[0m20:25:43.337077 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_youtube_main_STAGING, now list_youtube_main_MARTS)
[0m20:25:43.340442 [debug] [ThreadPool]: Using duckdb connection "list_youtube_main_MARTS"
[0m20:25:43.340689 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_youtube_main_STAGING'
[0m20:25:43.340845 [debug] [ThreadPool]: On list_youtube_main_MARTS: BEGIN
[0m20:25:43.342086 [debug] [ThreadPool]: Using duckdb connection "list_youtube_main_STAGING"
[0m20:25:43.342255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:43.342429 [debug] [ThreadPool]: On list_youtube_main_STAGING: BEGIN
[0m20:25:43.342660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:43.342864 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:25:43.343024 [debug] [ThreadPool]: Using duckdb connection "list_youtube_main_MARTS"
[0m20:25:43.343187 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:25:43.343348 [debug] [ThreadPool]: On list_youtube_main_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_youtube_main_MARTS"} */
select
      'youtube' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'youtube'
  
[0m20:25:43.343513 [debug] [ThreadPool]: Using duckdb connection "list_youtube_main_STAGING"
[0m20:25:43.343758 [debug] [ThreadPool]: On list_youtube_main_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_youtube_main_STAGING"} */
select
      'youtube' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'youtube'
  
[0m20:25:43.350782 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:25:43.351017 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:25:43.351673 [debug] [ThreadPool]: On list_youtube_main_STAGING: ROLLBACK
[0m20:25:43.352292 [debug] [ThreadPool]: On list_youtube_main_MARTS: ROLLBACK
[0m20:25:43.354096 [debug] [ThreadPool]: Failed to rollback 'list_youtube_main_MARTS'
[0m20:25:43.354304 [debug] [ThreadPool]: Failed to rollback 'list_youtube_main_STAGING'
[0m20:25:43.354461 [debug] [ThreadPool]: On list_youtube_main_MARTS: Close
[0m20:25:43.354619 [debug] [ThreadPool]: On list_youtube_main_STAGING: Close
[0m20:25:43.355036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a540d1cd-796f-4720-b817-ed822099907f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d40ca0>]}
[0m20:25:43.355300 [debug] [MainThread]: Using duckdb connection "master"
[0m20:25:43.355452 [debug] [MainThread]: On master: BEGIN
[0m20:25:43.355585 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:25:43.355836 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:25:43.355995 [debug] [MainThread]: On master: COMMIT
[0m20:25:43.356145 [debug] [MainThread]: Using duckdb connection "master"
[0m20:25:43.356287 [debug] [MainThread]: On master: COMMIT
[0m20:25:43.356504 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:25:43.356655 [debug] [MainThread]: On master: Close
[0m20:25:43.358015 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.stg_youtube_videos
[0m20:25:43.358311 [info ] [Thread-1  ]: 1 of 1 START sql view model main_STAGING.stg_youtube_videos .................... [RUN]
[0m20:25:43.358549 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_youtube_main_MARTS, now model.youtube_dbt_project.stg_youtube_videos)
[0m20:25:43.358750 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.stg_youtube_videos
[0m20:25:43.363994 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.stg_youtube_videos"
[0m20:25:43.364422 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.stg_youtube_videos
[0m20:25:43.382588 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.stg_youtube_videos"
[0m20:25:43.383029 [debug] [Thread-1  ]: Using duckdb connection "model.youtube_dbt_project.stg_youtube_videos"
[0m20:25:43.383226 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: BEGIN
[0m20:25:43.383404 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:25:43.383757 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m20:25:43.383937 [debug] [Thread-1  ]: Using duckdb connection "model.youtube_dbt_project.stg_youtube_videos"
[0m20:25:43.384162 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.stg_youtube_videos"} */

  
  create view "youtube"."main_STAGING"."stg_youtube_videos__dbt_tmp" as (
    

with source as (

    select
        video_id,
        trending_date,              -- 例如 '18.23.03' 这种原始值,先保留
        title,
        channel_title,
        category_id,
        publish_time,
        tags,
        views::number        as views,
        likes::number        as likes,
        dislikes::number     as dislikes,
        comment_count::number as comment_count,
        country,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from "MAGPIE_FINAL_PROJECT"."RAW"."RAW_YOUTUBE_TRENDING"

),

cleaned as (

    select
        -- 主键
        video_id,
        country,

        -- 把 trending_date 变成真正的日期(如果格式不一样你可以先留原始字段)
        try_to_date(trending_date, 'YY.DD.MM') as trending_date,

        -- 发布时间转成 timestamp
        try_to_timestamp_ntz(publish_time)     as publish_time,

        title,
        channel_title,
        category_id,
        tags,
        views,
        likes,
        dislikes,
        comment_count,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from source
)

select *
from cleaned
  );

[0m20:25:43.387975 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.stg_youtube_videos"} */

  
  create view "youtube"."main_STAGING"."stg_youtube_videos__dbt_tmp" as (
    

with source as (

    select
        video_id,
        trending_date,              -- 例如 '18.23.03' 这种原始值,先保留
        title,
        channel_title,
        category_id,
        publish_time,
        tags,
        views::number        as views,
        likes::number        as likes,
        dislikes::number     as dislikes,
        comment_count::number as comment_count,
        country,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from "MAGPIE_FINAL_PROJECT"."RAW"."RAW_YOUTUBE_TRENDING"

),

cleaned as (

    select
        -- 主键
        video_id,
        country,

        -- 把 trending_date 变成真正的日期(如果格式不一样你可以先留原始字段)
        try_to_date(trending_date, 'YY.DD.MM') as trending_date,

        -- 发布时间转成 timestamp
        try_to_timestamp_ntz(publish_time)     as publish_time,

        title,
        channel_title,
        category_id,
        tags,
        views,
        likes,
        dislikes,
        comment_count,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from source
)

select *
from cleaned
  );

[0m20:25:43.388250 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m20:25:43.388498 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: ROLLBACK
[0m20:25:43.403903 [debug] [Thread-1  ]: Failed to rollback 'model.youtube_dbt_project.stg_youtube_videos'
[0m20:25:43.404140 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: Close
[0m20:25:43.407383 [debug] [Thread-1  ]: Runtime Error in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)
  Binder Error: Catalog "MAGPIE_FINAL_PROJECT" does not exist!
[0m20:25:43.408546 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a540d1cd-796f-4720-b817-ed822099907f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091f6fd0>]}
[0m20:25:43.408924 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model main_STAGING.stg_youtube_videos ........... [[31mERROR[0m in 0.05s]
[0m20:25:43.409244 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.stg_youtube_videos
[0m20:25:43.409589 [debug] [Thread-7  ]: Marking all children of 'model.youtube_dbt_project.stg_youtube_videos' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)
  Binder Error: Catalog "MAGPIE_FINAL_PROJECT" does not exist!.
[0m20:25:43.410212 [debug] [MainThread]: Using duckdb connection "master"
[0m20:25:43.410410 [debug] [MainThread]: On master: BEGIN
[0m20:25:43.410561 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:25:43.410888 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:25:43.411049 [debug] [MainThread]: On master: COMMIT
[0m20:25:43.411202 [debug] [MainThread]: Using duckdb connection "master"
[0m20:25:43.411340 [debug] [MainThread]: On master: COMMIT
[0m20:25:43.411539 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:25:43.411710 [debug] [MainThread]: On master: Close
[0m20:25:43.411907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:43.412050 [debug] [MainThread]: Connection 'model.youtube_dbt_project.stg_youtube_videos' was properly closed.
[0m20:25:43.412176 [debug] [MainThread]: Connection 'list_youtube_main_STAGING' was properly closed.
[0m20:25:43.412322 [info ] [MainThread]: 
[0m20:25:43.412483 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m20:25:43.412856 [debug] [MainThread]: Command end result
[0m20:25:43.428065 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m20:25:43.429003 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m20:25:43.432635 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m20:25:43.432817 [info ] [MainThread]: 
[0m20:25:43.433030 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:25:43.433203 [info ] [MainThread]: 
[0m20:25:43.433416 [error] [MainThread]: [31mFailure in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)[0m
[0m20:25:43.433616 [error] [MainThread]:   Runtime Error in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)
  Binder Error: Catalog "MAGPIE_FINAL_PROJECT" does not exist!
[0m20:25:43.433769 [info ] [MainThread]: 
[0m20:25:43.433954 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/staging/stg_youtube_videos.sql
[0m20:25:43.434105 [info ] [MainThread]: 
[0m20:25:43.434275 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:25:43.435557 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.96630883, "process_in_blocks": "0", "process_kernel_time": 0.243602, "process_mem_max_rss": "140869632", "process_out_blocks": "0", "process_user_time": 1.482651}
[0m20:25:43.435773 [debug] [MainThread]: Command `dbt run` failed at 20:25:43.435728 after 0.97 seconds
[0m20:25:43.435972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10778c1c0>]}
[0m20:25:43.436171 [debug] [MainThread]: Flushing usage events
[0m20:25:43.826709 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:31:27.153252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103694610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10472f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10472fa60>]}


============================== 20:31:27.156478 | 281dfc70-5b68-4c16-98e1-e8c337057eed ==============================
[0m20:31:27.156478 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:31:27.156840 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'empty': 'False', 'target_path': 'None', 'debug': 'False', 'warn_error': 'None', 'no_print': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/luc/.dbt', 'static_parser': 'True', 'write_json': 'True', 'invocation_command': 'dbt run --select stg_youtube_videos', 'introspect': 'True', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'printer_width': '80', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'version_check': 'True', 'log_format': 'default', 'partial_parse': 'True', 'use_colors': 'True'}
[0m20:31:27.335227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '281dfc70-5b68-4c16-98e1-e8c337057eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104705130>]}
[0m20:31:27.370260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '281dfc70-5b68-4c16-98e1-e8c337057eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104854040>]}
[0m20:31:27.371635 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:31:27.452871 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:31:27.550779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:31:27.551170 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/staging/stg_youtube_videos.sql
[0m20:31:27.823677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '281dfc70-5b68-4c16-98e1-e8c337057eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f9b130>]}
[0m20:31:27.886327 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m20:31:27.887523 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m20:31:27.899330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '281dfc70-5b68-4c16-98e1-e8c337057eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f79a30>]}
[0m20:31:27.899621 [info ] [MainThread]: Found 5 models, 13 data tests, 1 source, 456 macros
[0m20:31:27.899814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '281dfc70-5b68-4c16-98e1-e8c337057eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d6b2e0>]}
[0m20:31:27.900503 [info ] [MainThread]: 
[0m20:31:27.900684 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:31:27.900837 [info ] [MainThread]: 
[0m20:31:27.901102 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:31:27.901558 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_youtube'
[0m20:31:27.934921 [debug] [ThreadPool]: Using duckdb connection "list_youtube"
[0m20:31:27.935183 [debug] [ThreadPool]: On list_youtube: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_youtube"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"youtube"'
    
  
  
[0m20:31:27.935361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:27.947624 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m20:31:27.948431 [debug] [ThreadPool]: On list_youtube: Close
[0m20:31:27.948832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_youtube, now create_youtube_main_STAGING)
[0m20:31:27.949113 [debug] [ThreadPool]: Creating schema "database: "youtube"
schema: "main_STAGING"
"
[0m20:31:27.953328 [debug] [ThreadPool]: Using duckdb connection "create_youtube_main_STAGING"
[0m20:31:27.953520 [debug] [ThreadPool]: On create_youtube_main_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "create_youtube_main_STAGING"} */

    
        select type from duckdb_databases()
        where lower(database_name)='youtube'
        and type='sqlite'
    
  
[0m20:31:27.953679 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:31:27.954272 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:31:27.954928 [debug] [ThreadPool]: Using duckdb connection "create_youtube_main_STAGING"
[0m20:31:27.955093 [debug] [ThreadPool]: On create_youtube_main_STAGING: BEGIN
[0m20:31:27.955316 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:31:27.955471 [debug] [ThreadPool]: Using duckdb connection "create_youtube_main_STAGING"
[0m20:31:27.955631 [debug] [ThreadPool]: On create_youtube_main_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "create_youtube_main_STAGING"} */

    
    
        create schema if not exists "youtube"."main_STAGING"
    
[0m20:31:27.956128 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:31:27.956565 [debug] [ThreadPool]: On create_youtube_main_STAGING: COMMIT
[0m20:31:27.956716 [debug] [ThreadPool]: Using duckdb connection "create_youtube_main_STAGING"
[0m20:31:27.956855 [debug] [ThreadPool]: On create_youtube_main_STAGING: COMMIT
[0m20:31:27.957061 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:31:27.957219 [debug] [ThreadPool]: On create_youtube_main_STAGING: Close
[0m20:31:27.960506 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_youtube_main_STAGING, now list_youtube_main_MARTS)
[0m20:31:27.963832 [debug] [ThreadPool]: Using duckdb connection "list_youtube_main_MARTS"
[0m20:31:27.964009 [debug] [ThreadPool]: On list_youtube_main_MARTS: BEGIN
[0m20:31:27.964250 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_youtube_main_STAGING'
[0m20:31:27.964399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:31:27.965643 [debug] [ThreadPool]: Using duckdb connection "list_youtube_main_STAGING"
[0m20:31:27.965888 [debug] [ThreadPool]: On list_youtube_main_STAGING: BEGIN
[0m20:31:27.966044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:27.966197 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:31:27.966409 [debug] [ThreadPool]: Using duckdb connection "list_youtube_main_MARTS"
[0m20:31:27.966581 [debug] [ThreadPool]: On list_youtube_main_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_youtube_main_MARTS"} */
select
      'youtube' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'youtube'
  
[0m20:31:27.966751 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:31:27.966958 [debug] [ThreadPool]: Using duckdb connection "list_youtube_main_STAGING"
[0m20:31:27.967120 [debug] [ThreadPool]: On list_youtube_main_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_youtube_main_STAGING"} */
select
      'youtube' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'youtube'
  
[0m20:31:27.973630 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:31:27.973844 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:31:27.974844 [debug] [ThreadPool]: On list_youtube_main_MARTS: ROLLBACK
[0m20:31:27.976230 [debug] [ThreadPool]: On list_youtube_main_STAGING: ROLLBACK
[0m20:31:27.977444 [debug] [ThreadPool]: Failed to rollback 'list_youtube_main_STAGING'
[0m20:31:27.977659 [debug] [ThreadPool]: Failed to rollback 'list_youtube_main_MARTS'
[0m20:31:27.977819 [debug] [ThreadPool]: On list_youtube_main_STAGING: Close
[0m20:31:27.977978 [debug] [ThreadPool]: On list_youtube_main_MARTS: Close
[0m20:31:27.978419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '281dfc70-5b68-4c16-98e1-e8c337057eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104800520>]}
[0m20:31:27.978681 [debug] [MainThread]: Using duckdb connection "master"
[0m20:31:27.978831 [debug] [MainThread]: On master: BEGIN
[0m20:31:27.978968 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:31:27.979230 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:31:27.979390 [debug] [MainThread]: On master: COMMIT
[0m20:31:27.979541 [debug] [MainThread]: Using duckdb connection "master"
[0m20:31:27.979683 [debug] [MainThread]: On master: COMMIT
[0m20:31:27.979885 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:31:27.980038 [debug] [MainThread]: On master: Close
[0m20:31:27.981480 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.stg_youtube_videos
[0m20:31:27.981799 [info ] [Thread-1  ]: 1 of 1 START sql view model main_STAGING.stg_youtube_videos .................... [RUN]
[0m20:31:27.982041 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_youtube_main_MARTS, now model.youtube_dbt_project.stg_youtube_videos)
[0m20:31:27.982246 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.stg_youtube_videos
[0m20:31:27.987222 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.stg_youtube_videos"
[0m20:31:27.987617 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.stg_youtube_videos
[0m20:31:28.005733 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.stg_youtube_videos"
[0m20:31:28.006432 [debug] [Thread-1  ]: Using duckdb connection "model.youtube_dbt_project.stg_youtube_videos"
[0m20:31:28.006633 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: BEGIN
[0m20:31:28.006807 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:31:28.007168 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m20:31:28.007343 [debug] [Thread-1  ]: Using duckdb connection "model.youtube_dbt_project.stg_youtube_videos"
[0m20:31:28.007559 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.stg_youtube_videos"} */

  
  create view "youtube"."main_STAGING"."stg_youtube_videos__dbt_tmp" as (
    

with source as (

    select
        video_id,
        trending_date,
        title,
        channel_title,
        category_id,
        publish_time,
        tags,
        cast(views as bigint)          as views,
        cast(likes as bigint)          as likes,
        cast(dislikes as bigint)       as dislikes,
        cast(comment_count as bigint)  as comment_count,
        'US'                           as country,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from read_csv_auto(
        '../USvideos.csv',
        header = true
    )

),

cleaned as (

    select
        video_id,
        country,
        try_to_date(trending_date, 'YY.DD.MM')        as trending_date,
        try_to_timestamp_ntz(publish_time)            as publish_time,
        title,
        channel_title,
        category_id,
        tags,
        views,
        likes,
        dislikes,
        comment_count,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from source
)

select *
from cleaned
  );

[0m20:31:28.028783 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.stg_youtube_videos"} */

  
  create view "youtube"."main_STAGING"."stg_youtube_videos__dbt_tmp" as (
    

with source as (

    select
        video_id,
        trending_date,
        title,
        channel_title,
        category_id,
        publish_time,
        tags,
        cast(views as bigint)          as views,
        cast(likes as bigint)          as likes,
        cast(dislikes as bigint)       as dislikes,
        cast(comment_count as bigint)  as comment_count,
        'US'                           as country,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from read_csv_auto(
        '../USvideos.csv',
        header = true
    )

),

cleaned as (

    select
        video_id,
        country,
        try_to_date(trending_date, 'YY.DD.MM')        as trending_date,
        try_to_timestamp_ntz(publish_time)            as publish_time,
        title,
        channel_title,
        category_id,
        tags,
        views,
        likes,
        dislikes,
        comment_count,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from source
)

select *
from cleaned
  );

[0m20:31:28.029121 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m20:31:28.029402 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: ROLLBACK
[0m20:31:28.045045 [debug] [Thread-1  ]: Failed to rollback 'model.youtube_dbt_project.stg_youtube_videos'
[0m20:31:28.045255 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: Close
[0m20:31:28.048573 [debug] [Thread-1  ]: Runtime Error in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)
  Invalid Input Error: Error when sniffing file "../USvideos.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ',', '|', ';', '	'
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Set delimiter (e.g., delim=',')
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
  
  LINE 25:     from read_csv_auto(
                    ^
[0m20:31:28.049739 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '281dfc70-5b68-4c16-98e1-e8c337057eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054119a0>]}
[0m20:31:28.050133 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model main_STAGING.stg_youtube_videos ........... [[31mERROR[0m in 0.07s]
[0m20:31:28.050492 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.stg_youtube_videos
[0m20:31:28.050837 [debug] [Thread-7  ]: Marking all children of 'model.youtube_dbt_project.stg_youtube_videos' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)
  Invalid Input Error: Error when sniffing file "../USvideos.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ',', '|', ';', '	'
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Set delimiter (e.g., delim=',')
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
  
  LINE 25:     from read_csv_auto(
                    ^.
[0m20:31:28.051494 [debug] [MainThread]: Using duckdb connection "master"
[0m20:31:28.051671 [debug] [MainThread]: On master: BEGIN
[0m20:31:28.051818 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:31:28.052124 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:31:28.052281 [debug] [MainThread]: On master: COMMIT
[0m20:31:28.052429 [debug] [MainThread]: Using duckdb connection "master"
[0m20:31:28.052575 [debug] [MainThread]: On master: COMMIT
[0m20:31:28.052768 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:31:28.052922 [debug] [MainThread]: On master: Close
[0m20:31:28.053118 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:31:28.053261 [debug] [MainThread]: Connection 'model.youtube_dbt_project.stg_youtube_videos' was properly closed.
[0m20:31:28.053391 [debug] [MainThread]: Connection 'list_youtube_main_STAGING' was properly closed.
[0m20:31:28.053536 [info ] [MainThread]: 
[0m20:31:28.053694 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m20:31:28.054099 [debug] [MainThread]: Command end result
[0m20:31:28.070408 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m20:31:28.071328 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m20:31:28.075265 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m20:31:28.075427 [info ] [MainThread]: 
[0m20:31:28.075624 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:31:28.075791 [info ] [MainThread]: 
[0m20:31:28.076005 [error] [MainThread]: [31mFailure in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)[0m
[0m20:31:28.076254 [error] [MainThread]:   Runtime Error in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)
  Invalid Input Error: Error when sniffing file "../USvideos.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ',', '|', ';', '	'
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Set delimiter (e.g., delim=',')
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
  
  LINE 25:     from read_csv_auto(
                    ^
[0m20:31:28.076462 [info ] [MainThread]: 
[0m20:31:28.076649 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/staging/stg_youtube_videos.sql
[0m20:31:28.076798 [info ] [MainThread]: 
[0m20:31:28.076963 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:31:28.078226 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.97040594, "process_in_blocks": "0", "process_kernel_time": 0.238974, "process_mem_max_rss": "178012160", "process_out_blocks": "0", "process_user_time": 1.486112}
[0m20:31:28.078435 [debug] [MainThread]: Command `dbt run` failed at 20:31:28.078391 after 0.97 seconds
[0m20:31:28.078627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103694610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f79280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10393b1c0>]}
[0m20:31:28.078818 [debug] [MainThread]: Flushing usage events
[0m20:31:28.457288 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:35:43.540293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035e4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10467f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10467f940>]}


============================== 20:35:43.543497 | 213884e7-620f-4932-8651-a4aa8f6f61ec ==============================
[0m20:35:43.543497 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:35:43.543851 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'cache_selected_only': 'False', 'write_json': 'True', 'version_check': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'invocation_command': 'dbt run --select stg_youtube_videos', 'warn_error': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'no_print': 'None', 'partial_parse': 'True', 'debug': 'False', 'use_colors': 'True', 'profiles_dir': '/Users/luc/.dbt', 'introspect': 'True', 'static_parser': 'True'}
[0m20:35:43.731766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '213884e7-620f-4932-8651-a4aa8f6f61ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10463b1c0>]}
[0m20:35:43.766907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '213884e7-620f-4932-8651-a4aa8f6f61ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10461c130>]}
[0m20:35:43.768360 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:35:43.850304 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:35:43.948841 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:35:43.949237 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/staging/stg_youtube_videos.sql
[0m20:35:44.221913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '213884e7-620f-4932-8651-a4aa8f6f61ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eeb130>]}
[0m20:35:44.283697 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m20:35:44.284922 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m20:35:44.296851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '213884e7-620f-4932-8651-a4aa8f6f61ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ecb7c0>]}
[0m20:35:44.297145 [info ] [MainThread]: Found 5 models, 13 data tests, 1 source, 456 macros
[0m20:35:44.297340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '213884e7-620f-4932-8651-a4aa8f6f61ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eff160>]}
[0m20:35:44.298019 [info ] [MainThread]: 
[0m20:35:44.298209 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:35:44.298371 [info ] [MainThread]: 
[0m20:35:44.298641 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:35:44.299085 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_youtube'
[0m20:35:44.332554 [debug] [ThreadPool]: Using duckdb connection "list_youtube"
[0m20:35:44.332840 [debug] [ThreadPool]: On list_youtube: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_youtube"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"youtube"'
    
  
  
[0m20:35:44.333018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:44.346713 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m20:35:44.347846 [debug] [ThreadPool]: On list_youtube: Close
[0m20:35:44.348236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_youtube, now create_youtube_main_STAGING)
[0m20:35:44.348510 [debug] [ThreadPool]: Creating schema "database: "youtube"
schema: "main_STAGING"
"
[0m20:35:44.352620 [debug] [ThreadPool]: Using duckdb connection "create_youtube_main_STAGING"
[0m20:35:44.352811 [debug] [ThreadPool]: On create_youtube_main_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "create_youtube_main_STAGING"} */

    
        select type from duckdb_databases()
        where lower(database_name)='youtube'
        and type='sqlite'
    
  
[0m20:35:44.352970 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:35:44.353653 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:35:44.354319 [debug] [ThreadPool]: Using duckdb connection "create_youtube_main_STAGING"
[0m20:35:44.354488 [debug] [ThreadPool]: On create_youtube_main_STAGING: BEGIN
[0m20:35:44.354716 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:35:44.354872 [debug] [ThreadPool]: Using duckdb connection "create_youtube_main_STAGING"
[0m20:35:44.355029 [debug] [ThreadPool]: On create_youtube_main_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "create_youtube_main_STAGING"} */

    
    
        create schema if not exists "youtube"."main_STAGING"
    
[0m20:35:44.355522 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:35:44.355965 [debug] [ThreadPool]: On create_youtube_main_STAGING: COMMIT
[0m20:35:44.356119 [debug] [ThreadPool]: Using duckdb connection "create_youtube_main_STAGING"
[0m20:35:44.356257 [debug] [ThreadPool]: On create_youtube_main_STAGING: COMMIT
[0m20:35:44.356454 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:35:44.356609 [debug] [ThreadPool]: On create_youtube_main_STAGING: Close
[0m20:35:44.359853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_youtube_main_STAGING, now list_youtube_main_MARTS)
[0m20:35:44.363183 [debug] [ThreadPool]: Using duckdb connection "list_youtube_main_MARTS"
[0m20:35:44.363367 [debug] [ThreadPool]: On list_youtube_main_MARTS: BEGIN
[0m20:35:44.363592 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_youtube_main_STAGING'
[0m20:35:44.363739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:35:44.364978 [debug] [ThreadPool]: Using duckdb connection "list_youtube_main_STAGING"
[0m20:35:44.365217 [debug] [ThreadPool]: On list_youtube_main_STAGING: BEGIN
[0m20:35:44.365369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:44.365516 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:35:44.365726 [debug] [ThreadPool]: Using duckdb connection "list_youtube_main_MARTS"
[0m20:35:44.365899 [debug] [ThreadPool]: On list_youtube_main_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_youtube_main_MARTS"} */
select
      'youtube' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'youtube'
  
[0m20:35:44.366075 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:35:44.366267 [debug] [ThreadPool]: Using duckdb connection "list_youtube_main_STAGING"
[0m20:35:44.366432 [debug] [ThreadPool]: On list_youtube_main_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_youtube_main_STAGING"} */
select
      'youtube' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'youtube'
  
[0m20:35:44.373481 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:35:44.373712 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:35:44.374422 [debug] [ThreadPool]: On list_youtube_main_MARTS: ROLLBACK
[0m20:35:44.375772 [debug] [ThreadPool]: On list_youtube_main_STAGING: ROLLBACK
[0m20:35:44.376924 [debug] [ThreadPool]: Failed to rollback 'list_youtube_main_MARTS'
[0m20:35:44.377122 [debug] [ThreadPool]: Failed to rollback 'list_youtube_main_STAGING'
[0m20:35:44.377302 [debug] [ThreadPool]: On list_youtube_main_MARTS: Close
[0m20:35:44.377462 [debug] [ThreadPool]: On list_youtube_main_STAGING: Close
[0m20:35:44.377909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '213884e7-620f-4932-8651-a4aa8f6f61ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f3a310>]}
[0m20:35:44.378190 [debug] [MainThread]: Using duckdb connection "master"
[0m20:35:44.378343 [debug] [MainThread]: On master: BEGIN
[0m20:35:44.378481 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:35:44.378737 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:35:44.378895 [debug] [MainThread]: On master: COMMIT
[0m20:35:44.379046 [debug] [MainThread]: Using duckdb connection "master"
[0m20:35:44.379182 [debug] [MainThread]: On master: COMMIT
[0m20:35:44.379380 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:35:44.379529 [debug] [MainThread]: On master: Close
[0m20:35:44.380884 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.stg_youtube_videos
[0m20:35:44.381184 [info ] [Thread-1  ]: 1 of 1 START sql view model main_STAGING.stg_youtube_videos .................... [RUN]
[0m20:35:44.381429 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_youtube_main_MARTS, now model.youtube_dbt_project.stg_youtube_videos)
[0m20:35:44.381635 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.stg_youtube_videos
[0m20:35:44.386601 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.stg_youtube_videos"
[0m20:35:44.387019 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.stg_youtube_videos
[0m20:35:44.405053 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.stg_youtube_videos"
[0m20:35:44.405449 [debug] [Thread-1  ]: Using duckdb connection "model.youtube_dbt_project.stg_youtube_videos"
[0m20:35:44.405645 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: BEGIN
[0m20:35:44.405820 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:35:44.406154 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m20:35:44.406334 [debug] [Thread-1  ]: Using duckdb connection "model.youtube_dbt_project.stg_youtube_videos"
[0m20:35:44.406557 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.stg_youtube_videos"} */

  
  create view "youtube"."main_STAGING"."stg_youtube_videos__dbt_tmp" as (
    

with source as (

    select
        video_id,
        trending_date,
        title,
        channel_title,
        category_id,
        publish_time,
        tags,
        cast(views as bigint)          as views,
        cast(likes as bigint)          as likes,
        cast(dislikes as bigint)       as dislikes,
        cast(comment_count as bigint)  as comment_count,
        'US'                           as country,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from read_csv_auto(
        '../USvideos.csv',
        header = true
        sep = ',',
        quote = '"',
        escape = '"',
        ignore_errors = true
    )

),

cleaned as (

    select
        video_id,
        country,
        try_to_date(trending_date, 'YY.DD.MM')        as trending_date,
        try_to_timestamp_ntz(publish_time)            as publish_time,
        title,
        channel_title,
        category_id,
        tags,
        views,
        likes,
        dislikes,
        comment_count,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from source
)

select *
from cleaned
  );

[0m20:35:44.410383 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.stg_youtube_videos"} */

  
  create view "youtube"."main_STAGING"."stg_youtube_videos__dbt_tmp" as (
    

with source as (

    select
        video_id,
        trending_date,
        title,
        channel_title,
        category_id,
        publish_time,
        tags,
        cast(views as bigint)          as views,
        cast(likes as bigint)          as likes,
        cast(dislikes as bigint)       as dislikes,
        cast(comment_count as bigint)  as comment_count,
        'US'                           as country,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from read_csv_auto(
        '../USvideos.csv',
        header = true
        sep = ',',
        quote = '"',
        escape = '"',
        ignore_errors = true
    )

),

cleaned as (

    select
        video_id,
        country,
        try_to_date(trending_date, 'YY.DD.MM')        as trending_date,
        try_to_timestamp_ntz(publish_time)            as publish_time,
        title,
        channel_title,
        category_id,
        tags,
        views,
        likes,
        dislikes,
        comment_count,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from source
)

select *
from cleaned
  );

[0m20:35:44.410637 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m20:35:44.410870 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: ROLLBACK
[0m20:35:44.426742 [debug] [Thread-1  ]: Failed to rollback 'model.youtube_dbt_project.stg_youtube_videos'
[0m20:35:44.426986 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: Close
[0m20:35:44.430261 [debug] [Thread-1  ]: Runtime Error in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)
  Parser Error: syntax error at or near "sep"
  
  LINE 28:         sep = ',',
                   ^
[0m20:35:44.431419 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '213884e7-620f-4932-8651-a4aa8f6f61ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10543ce20>]}
[0m20:35:44.431801 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model main_STAGING.stg_youtube_videos ........... [[31mERROR[0m in 0.05s]
[0m20:35:44.432130 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.stg_youtube_videos
[0m20:35:44.432417 [debug] [Thread-7  ]: Marking all children of 'model.youtube_dbt_project.stg_youtube_videos' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)
  Parser Error: syntax error at or near "sep"
  
  LINE 28:         sep = ',',
                   ^.
[0m20:35:44.433017 [debug] [MainThread]: Using duckdb connection "master"
[0m20:35:44.433185 [debug] [MainThread]: On master: BEGIN
[0m20:35:44.433328 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:35:44.433623 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:35:44.433776 [debug] [MainThread]: On master: COMMIT
[0m20:35:44.433926 [debug] [MainThread]: Using duckdb connection "master"
[0m20:35:44.434064 [debug] [MainThread]: On master: COMMIT
[0m20:35:44.434256 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:35:44.434409 [debug] [MainThread]: On master: Close
[0m20:35:44.434602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:35:44.434736 [debug] [MainThread]: Connection 'model.youtube_dbt_project.stg_youtube_videos' was properly closed.
[0m20:35:44.434861 [debug] [MainThread]: Connection 'list_youtube_main_STAGING' was properly closed.
[0m20:35:44.435003 [info ] [MainThread]: 
[0m20:35:44.435166 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m20:35:44.435529 [debug] [MainThread]: Command end result
[0m20:35:44.451549 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m20:35:44.452481 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m20:35:44.456366 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m20:35:44.456529 [info ] [MainThread]: 
[0m20:35:44.456727 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:35:44.456895 [info ] [MainThread]: 
[0m20:35:44.457101 [error] [MainThread]: [31mFailure in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)[0m
[0m20:35:44.457302 [error] [MainThread]:   Runtime Error in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)
  Parser Error: syntax error at or near "sep"
  
  LINE 28:         sep = ',',
                   ^
[0m20:35:44.457457 [info ] [MainThread]: 
[0m20:35:44.457642 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/staging/stg_youtube_videos.sql
[0m20:35:44.457795 [info ] [MainThread]: 
[0m20:35:44.457964 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:35:44.459310 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9650163, "process_in_blocks": "0", "process_kernel_time": 0.234058, "process_mem_max_rss": "141803520", "process_out_blocks": "0", "process_user_time": 1.481977}
[0m20:35:44.459516 [debug] [MainThread]: Command `dbt run` failed at 20:35:44.459473 after 0.97 seconds
[0m20:35:44.459709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035e4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ecb370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038b1a00>]}
[0m20:35:44.459902 [debug] [MainThread]: Flushing usage events
[0m20:35:44.775036 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:37:54.701251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106080550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b4b5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b4b8e0>]}


============================== 20:37:54.704414 | 79901d17-de9b-41e0-bb40-0de588255f74 ==============================
[0m20:37:54.704414 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:37:54.704794 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'write_json': 'True', 'target_path': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'introspect': 'True', 'profiles_dir': '/Users/luc/.dbt', 'use_experimental_parser': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'static_parser': 'True', 'empty': 'False', 'invocation_command': 'dbt run --select stg_youtube_videos', 'no_print': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs'}
[0m20:37:54.889859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79901d17-de9b-41e0-bb40-0de588255f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d534f0>]}
[0m20:37:54.924883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79901d17-de9b-41e0-bb40-0de588255f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c7ac0>]}
[0m20:37:54.926448 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:37:55.007001 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:37:55.104075 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:37:55.104473 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/staging/stg_youtube_videos.sql
[0m20:37:55.377371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79901d17-de9b-41e0-bb40-0de588255f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105b8130>]}
[0m20:37:55.440252 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m20:37:55.441584 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m20:37:55.453778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79901d17-de9b-41e0-bb40-0de588255f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110594a60>]}
[0m20:37:55.454083 [info ] [MainThread]: Found 5 models, 13 data tests, 1 source, 456 macros
[0m20:37:55.454278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79901d17-de9b-41e0-bb40-0de588255f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105cb160>]}
[0m20:37:55.454963 [info ] [MainThread]: 
[0m20:37:55.455145 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:37:55.455300 [info ] [MainThread]: 
[0m20:37:55.455569 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:37:55.456025 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_youtube'
[0m20:37:55.489535 [debug] [ThreadPool]: Using duckdb connection "list_youtube"
[0m20:37:55.489838 [debug] [ThreadPool]: On list_youtube: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_youtube"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"youtube"'
    
  
  
[0m20:37:55.490019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:37:55.502697 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:37:55.503796 [debug] [ThreadPool]: On list_youtube: Close
[0m20:37:55.504177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_youtube, now create_youtube_main_STAGING)
[0m20:37:55.504455 [debug] [ThreadPool]: Creating schema "database: "youtube"
schema: "main_STAGING"
"
[0m20:37:55.508504 [debug] [ThreadPool]: Using duckdb connection "create_youtube_main_STAGING"
[0m20:37:55.508697 [debug] [ThreadPool]: On create_youtube_main_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "create_youtube_main_STAGING"} */

    
        select type from duckdb_databases()
        where lower(database_name)='youtube'
        and type='sqlite'
    
  
[0m20:37:55.508857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:37:55.509448 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:37:55.510097 [debug] [ThreadPool]: Using duckdb connection "create_youtube_main_STAGING"
[0m20:37:55.510258 [debug] [ThreadPool]: On create_youtube_main_STAGING: BEGIN
[0m20:37:55.510495 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:37:55.510651 [debug] [ThreadPool]: Using duckdb connection "create_youtube_main_STAGING"
[0m20:37:55.510807 [debug] [ThreadPool]: On create_youtube_main_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "create_youtube_main_STAGING"} */

    
    
        create schema if not exists "youtube"."main_STAGING"
    
[0m20:37:55.511204 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:37:55.511674 [debug] [ThreadPool]: On create_youtube_main_STAGING: COMMIT
[0m20:37:55.511833 [debug] [ThreadPool]: Using duckdb connection "create_youtube_main_STAGING"
[0m20:37:55.511975 [debug] [ThreadPool]: On create_youtube_main_STAGING: COMMIT
[0m20:37:55.512180 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:37:55.512342 [debug] [ThreadPool]: On create_youtube_main_STAGING: Close
[0m20:37:55.515627 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_youtube_main_STAGING, now list_youtube_main_STAGING)
[0m20:37:55.519011 [debug] [ThreadPool]: Using duckdb connection "list_youtube_main_STAGING"
[0m20:37:55.519196 [debug] [ThreadPool]: On list_youtube_main_STAGING: BEGIN
[0m20:37:55.519425 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_youtube_main_MARTS'
[0m20:37:55.519576 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:37:55.520831 [debug] [ThreadPool]: Using duckdb connection "list_youtube_main_MARTS"
[0m20:37:55.521086 [debug] [ThreadPool]: On list_youtube_main_MARTS: BEGIN
[0m20:37:55.521240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:37:55.521396 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:37:55.521605 [debug] [ThreadPool]: Using duckdb connection "list_youtube_main_STAGING"
[0m20:37:55.521782 [debug] [ThreadPool]: On list_youtube_main_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_youtube_main_STAGING"} */
select
      'youtube' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'youtube'
  
[0m20:37:55.521954 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:37:55.522163 [debug] [ThreadPool]: Using duckdb connection "list_youtube_main_MARTS"
[0m20:37:55.522324 [debug] [ThreadPool]: On list_youtube_main_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_youtube_main_MARTS"} */
select
      'youtube' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'youtube'
  
[0m20:37:55.531156 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:37:55.531357 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:37:55.532234 [debug] [ThreadPool]: On list_youtube_main_STAGING: ROLLBACK
[0m20:37:55.533503 [debug] [ThreadPool]: On list_youtube_main_MARTS: ROLLBACK
[0m20:37:55.534590 [debug] [ThreadPool]: Failed to rollback 'list_youtube_main_MARTS'
[0m20:37:55.534788 [debug] [ThreadPool]: Failed to rollback 'list_youtube_main_STAGING'
[0m20:37:55.534942 [debug] [ThreadPool]: On list_youtube_main_MARTS: Close
[0m20:37:55.535099 [debug] [ThreadPool]: On list_youtube_main_STAGING: Close
[0m20:37:55.535523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79901d17-de9b-41e0-bb40-0de588255f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103ee7c0>]}
[0m20:37:55.535790 [debug] [MainThread]: Using duckdb connection "master"
[0m20:37:55.535937 [debug] [MainThread]: On master: BEGIN
[0m20:37:55.536073 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:37:55.536318 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:37:55.536472 [debug] [MainThread]: On master: COMMIT
[0m20:37:55.536620 [debug] [MainThread]: Using duckdb connection "master"
[0m20:37:55.536758 [debug] [MainThread]: On master: COMMIT
[0m20:37:55.536957 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:37:55.537112 [debug] [MainThread]: On master: Close
[0m20:37:55.538453 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.stg_youtube_videos
[0m20:37:55.538752 [info ] [Thread-1  ]: 1 of 1 START sql view model main_STAGING.stg_youtube_videos .................... [RUN]
[0m20:37:55.538987 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_youtube_main_STAGING, now model.youtube_dbt_project.stg_youtube_videos)
[0m20:37:55.539187 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.stg_youtube_videos
[0m20:37:55.544133 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.stg_youtube_videos"
[0m20:37:55.544522 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.stg_youtube_videos
[0m20:37:55.562471 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.stg_youtube_videos"
[0m20:37:55.563094 [debug] [Thread-1  ]: Using duckdb connection "model.youtube_dbt_project.stg_youtube_videos"
[0m20:37:55.563293 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: BEGIN
[0m20:37:55.563468 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:37:55.563800 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m20:37:55.563985 [debug] [Thread-1  ]: Using duckdb connection "model.youtube_dbt_project.stg_youtube_videos"
[0m20:37:55.564205 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.stg_youtube_videos"} */

  
  create view "youtube"."main_STAGING"."stg_youtube_videos__dbt_tmp" as (
    

with source as (

    select
        video_id,
        trending_date,
        title,
        channel_title,
        category_id,
        publish_time,
        tags,
        cast(views as bigint)          as views,
        cast(likes as bigint)          as likes,
        cast(dislikes as bigint)       as dislikes,
        cast(comment_count as bigint)  as comment_count,
        'US'                           as country,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from read_csv_auto(
        '../USvideos.csv',
        header = true
        delim = ',',
        quote = '"',
        escape = '"',
        ignore_errors = true
    )

),

cleaned as (

    select
        video_id,
        country,
        try_to_date(trending_date, 'YY.DD.MM')        as trending_date,
        try_to_timestamp_ntz(publish_time)            as publish_time,
        title,
        channel_title,
        category_id,
        tags,
        views,
        likes,
        dislikes,
        comment_count,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from source
)

select *
from cleaned
  );

[0m20:37:55.567645 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.stg_youtube_videos"} */

  
  create view "youtube"."main_STAGING"."stg_youtube_videos__dbt_tmp" as (
    

with source as (

    select
        video_id,
        trending_date,
        title,
        channel_title,
        category_id,
        publish_time,
        tags,
        cast(views as bigint)          as views,
        cast(likes as bigint)          as likes,
        cast(dislikes as bigint)       as dislikes,
        cast(comment_count as bigint)  as comment_count,
        'US'                           as country,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from read_csv_auto(
        '../USvideos.csv',
        header = true
        delim = ',',
        quote = '"',
        escape = '"',
        ignore_errors = true
    )

),

cleaned as (

    select
        video_id,
        country,
        try_to_date(trending_date, 'YY.DD.MM')        as trending_date,
        try_to_timestamp_ntz(publish_time)            as publish_time,
        title,
        channel_title,
        category_id,
        tags,
        views,
        likes,
        dislikes,
        comment_count,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from source
)

select *
from cleaned
  );

[0m20:37:55.567898 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m20:37:55.568128 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: ROLLBACK
[0m20:37:55.583335 [debug] [Thread-1  ]: Failed to rollback 'model.youtube_dbt_project.stg_youtube_videos'
[0m20:37:55.583585 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: Close
[0m20:37:55.586754 [debug] [Thread-1  ]: Runtime Error in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)
  Parser Error: syntax error at or near "delim"
  
  LINE 28:         delim = ',',
                   ^
[0m20:37:55.587896 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79901d17-de9b-41e0-bb40-0de588255f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111409df0>]}
[0m20:37:55.588270 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model main_STAGING.stg_youtube_videos ........... [[31mERROR[0m in 0.05s]
[0m20:37:55.588589 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.stg_youtube_videos
[0m20:37:55.588874 [debug] [Thread-7  ]: Marking all children of 'model.youtube_dbt_project.stg_youtube_videos' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)
  Parser Error: syntax error at or near "delim"
  
  LINE 28:         delim = ',',
                   ^.
[0m20:37:55.589481 [debug] [MainThread]: Using duckdb connection "master"
[0m20:37:55.589680 [debug] [MainThread]: On master: BEGIN
[0m20:37:55.589830 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:37:55.590162 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:37:55.590325 [debug] [MainThread]: On master: COMMIT
[0m20:37:55.590480 [debug] [MainThread]: Using duckdb connection "master"
[0m20:37:55.590622 [debug] [MainThread]: On master: COMMIT
[0m20:37:55.590820 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:37:55.590978 [debug] [MainThread]: On master: Close
[0m20:37:55.591181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:37:55.591324 [debug] [MainThread]: Connection 'model.youtube_dbt_project.stg_youtube_videos' was properly closed.
[0m20:37:55.591452 [debug] [MainThread]: Connection 'list_youtube_main_MARTS' was properly closed.
[0m20:37:55.591598 [info ] [MainThread]: 
[0m20:37:55.591767 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m20:37:55.592127 [debug] [MainThread]: Command end result
[0m20:37:55.608348 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m20:37:55.609282 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m20:37:55.613411 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m20:37:55.613572 [info ] [MainThread]: 
[0m20:37:55.613769 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:37:55.613933 [info ] [MainThread]: 
[0m20:37:55.614139 [error] [MainThread]: [31mFailure in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)[0m
[0m20:37:55.614339 [error] [MainThread]:   Runtime Error in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)
  Parser Error: syntax error at or near "delim"
  
  LINE 28:         delim = ',',
                   ^
[0m20:37:55.614493 [info ] [MainThread]: 
[0m20:37:55.614690 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/staging/stg_youtube_videos.sql
[0m20:37:55.614841 [info ] [MainThread]: 
[0m20:37:55.615008 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:37:55.616178 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.95982873, "process_in_blocks": "0", "process_kernel_time": 0.223715, "process_mem_max_rss": "142983168", "process_out_blocks": "0", "process_user_time": 1.483902}
[0m20:37:55.616384 [debug] [MainThread]: Command `dbt run` failed at 20:37:55.616339 after 0.96 seconds
[0m20:37:55.616573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106080550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d534f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110594910>]}
[0m20:37:55.616770 [debug] [MainThread]: Flushing usage events
[0m20:37:55.931152 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:49:14.216610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075005b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099c9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099c97c0>]}


============================== 20:49:14.219963 | e4b3ee06-c9a5-4f84-8c0a-b84f2437d6c0 ==============================
[0m20:49:14.219963 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:49:14.220315 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'indirect_selection': 'eager', 'write_json': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/luc/.dbt', 'partial_parse': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'invocation_command': 'dbt debug', 'fail_fast': 'False', 'use_colors': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'printer_width': '80', 'debug': 'False', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'version_check': 'True', 'static_parser': 'True'}
[0m20:49:14.229307 [info ] [MainThread]: dbt version: 1.10.13
[0m20:49:14.229507 [info ] [MainThread]: python version: 3.9.6
[0m20:49:14.229675 [info ] [MainThread]: python path: /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/magpie_youtube/.venv_dbt/bin/python3
[0m20:49:14.229840 [info ] [MainThread]: os info: macOS-14.4.1-arm64-arm-64bit
[0m20:49:14.501335 [info ] [MainThread]: Using profiles dir at /Users/luc/.dbt
[0m20:49:14.501618 [info ] [MainThread]: Using profiles.yml file at /Users/luc/.dbt/profiles.yml
[0m20:49:14.501789 [info ] [MainThread]: Using dbt_project.yml file at /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/dbt_project.yml
[0m20:49:14.502210 [info ] [MainThread]: adapter type: snowflake
[0m20:49:14.502413 [info ] [MainThread]: adapter version: 1.8.4
[0m20:49:14.560989 [info ] [MainThread]: Configuration:
[0m20:49:14.561313 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:49:14.561480 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:49:14.561631 [info ] [MainThread]: Required dependencies:
[0m20:49:14.561857 [debug] [MainThread]: Executing "git --help"
[0m20:49:14.615928 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:49:14.616576 [debug] [MainThread]: STDERR: "b''"
[0m20:49:14.616823 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:49:14.617039 [info ] [MainThread]: Connection:
[0m20:49:14.617281 [info ] [MainThread]:   account: azb79167
[0m20:49:14.617443 [info ] [MainThread]:   user: MAGPIE
[0m20:49:14.617601 [info ] [MainThread]:   database: MAGPIE_FINAL_PROJECT
[0m20:49:14.617761 [info ] [MainThread]:   warehouse: TRAINING_WH
[0m20:49:14.617917 [info ] [MainThread]:   role: TRAINING_ROLE
[0m20:49:14.618070 [info ] [MainThread]:   schema: STAGING
[0m20:49:14.618222 [info ] [MainThread]:   authenticator: None
[0m20:49:14.618374 [info ] [MainThread]:   oauth_client_id: None
[0m20:49:14.618525 [info ] [MainThread]:   query_tag: None
[0m20:49:14.618680 [info ] [MainThread]:   client_session_keep_alive: False
[0m20:49:14.618832 [info ] [MainThread]:   host: None
[0m20:49:14.618981 [info ] [MainThread]:   port: None
[0m20:49:14.619130 [info ] [MainThread]:   proxy_host: None
[0m20:49:14.619280 [info ] [MainThread]:   proxy_port: None
[0m20:49:14.619429 [info ] [MainThread]:   protocol: None
[0m20:49:14.619580 [info ] [MainThread]:   connect_retries: 1
[0m20:49:14.619730 [info ] [MainThread]:   connect_timeout: None
[0m20:49:14.619881 [info ] [MainThread]:   retry_on_database_errors: False
[0m20:49:14.620033 [info ] [MainThread]:   retry_all: False
[0m20:49:14.620182 [info ] [MainThread]:   insecure_mode: False
[0m20:49:14.620333 [info ] [MainThread]:   reuse_connections: None
[0m20:49:14.620759 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:49:14.713547 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m20:49:14.714172 [debug] [MainThread]: Using snowflake connection "debug"
[0m20:49:14.714343 [debug] [MainThread]: On debug: select 1 as id
[0m20:49:14.714496 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:49:15.712786 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m20:49:15.713403 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m20:49:15.713837 [debug] [MainThread]: On debug: No close available on handle
[0m20:49:15.714272 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:49:15.714692 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:49:15.715090 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: azb79167.snowflakecomputing.com:443. JWT token is invalid. [cc1337d4-7abd-43c9-bfdf-b9412cb9089a]

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:49:15.718370 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 1.5470899, "process_in_blocks": "0", "process_kernel_time": 0.288996, "process_mem_max_rss": "152076288", "process_out_blocks": "0", "process_user_time": 1.316673}
[0m20:49:15.718989 [debug] [MainThread]: Command `dbt debug` failed at 20:49:15.718838 after 1.55 seconds
[0m20:49:15.719408 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:49:15.719851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075005b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ace2100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077cfb80>]}
[0m20:49:15.720379 [debug] [MainThread]: Flushing usage events
[0m20:49:16.060867 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:57:12.159571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054975b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106531550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106531880>]}


============================== 20:57:12.162973 | 87016b14-fc9f-42c9-a3d4-9f3cd2055507 ==============================
[0m20:57:12.162973 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:57:12.163347 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'no_print': 'None', 'introspect': 'True', 'debug': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'target_path': 'None', 'partial_parse': 'True', 'write_json': 'True', 'profiles_dir': '/Users/luc/.dbt', 'use_colors': 'True', 'empty': 'None', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'printer_width': '80', 'indirect_selection': 'eager', 'version_check': 'True', 'cache_selected_only': 'False'}
[0m20:57:12.172139 [info ] [MainThread]: dbt version: 1.10.13
[0m20:57:12.172352 [info ] [MainThread]: python version: 3.9.6
[0m20:57:12.172522 [info ] [MainThread]: python path: /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/magpie_youtube/.venv_dbt/bin/python3
[0m20:57:12.172683 [info ] [MainThread]: os info: macOS-14.4.1-arm64-arm-64bit
[0m20:57:12.452386 [info ] [MainThread]: Using profiles dir at /Users/luc/.dbt
[0m20:57:12.452681 [info ] [MainThread]: Using profiles.yml file at /Users/luc/.dbt/profiles.yml
[0m20:57:12.452849 [info ] [MainThread]: Using dbt_project.yml file at /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/dbt_project.yml
[0m20:57:12.453206 [info ] [MainThread]: adapter type: snowflake
[0m20:57:12.453410 [info ] [MainThread]: adapter version: 1.8.4
[0m20:57:12.512264 [info ] [MainThread]: Configuration:
[0m20:57:12.512584 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:57:12.512763 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:57:12.512922 [info ] [MainThread]: Required dependencies:
[0m20:57:12.513150 [debug] [MainThread]: Executing "git --help"
[0m20:57:12.528911 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:57:12.530003 [debug] [MainThread]: STDERR: "b''"
[0m20:57:12.530273 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:57:12.530474 [info ] [MainThread]: Connection:
[0m20:57:12.530719 [info ] [MainThread]:   account: azb79167
[0m20:57:12.530875 [info ] [MainThread]:   user: MAGPIE
[0m20:57:12.531026 [info ] [MainThread]:   database: MAGPIE_FINAL_PROJECT
[0m20:57:12.531170 [info ] [MainThread]:   warehouse: TRAINING_WH
[0m20:57:12.531311 [info ] [MainThread]:   role: TRAINING_ROLE
[0m20:57:12.531455 [info ] [MainThread]:   schema: STAGING
[0m20:57:12.531601 [info ] [MainThread]:   authenticator: None
[0m20:57:12.531746 [info ] [MainThread]:   oauth_client_id: None
[0m20:57:12.531891 [info ] [MainThread]:   query_tag: None
[0m20:57:12.532036 [info ] [MainThread]:   client_session_keep_alive: False
[0m20:57:12.532179 [info ] [MainThread]:   host: None
[0m20:57:12.532321 [info ] [MainThread]:   port: None
[0m20:57:12.532460 [info ] [MainThread]:   proxy_host: None
[0m20:57:12.532599 [info ] [MainThread]:   proxy_port: None
[0m20:57:12.532740 [info ] [MainThread]:   protocol: None
[0m20:57:12.532881 [info ] [MainThread]:   connect_retries: 1
[0m20:57:12.533023 [info ] [MainThread]:   connect_timeout: None
[0m20:57:12.533162 [info ] [MainThread]:   retry_on_database_errors: False
[0m20:57:12.533303 [info ] [MainThread]:   retry_all: False
[0m20:57:12.533444 [info ] [MainThread]:   insecure_mode: False
[0m20:57:12.533584 [info ] [MainThread]:   reuse_connections: None
[0m20:57:12.534116 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:57:12.628196 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m20:57:12.628811 [debug] [MainThread]: Using snowflake connection "debug"
[0m20:57:12.628979 [debug] [MainThread]: On debug: select 1 as id
[0m20:57:12.629133 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:57:12.629370 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m20:57:12.629519 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m20:57:12.629671 [debug] [MainThread]: On debug: No close available on handle
[0m20:57:12.629842 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:57:12.630007 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:57:12.630169 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  [Errno 2] No such file or directory: '/Users/luc/rsa_new_pkcs8.pem'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:57:12.631726 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.51810926, "process_in_blocks": "0", "process_kernel_time": 0.223777, "process_mem_max_rss": "123813888", "process_out_blocks": "0", "process_user_time": 1.035673}
[0m20:57:12.631974 [debug] [MainThread]: Command `dbt debug` failed at 20:57:12.631909 after 0.52 seconds
[0m20:57:12.632155 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:57:12.632332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054975b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10765c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d61f0>]}
[0m20:57:12.632561 [debug] [MainThread]: Flushing usage events
[0m20:57:13.024152 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:26:13.745648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112eab520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a49520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a49850>]}


============================== 22:26:13.749073 | 65ff14bb-e8ef-4921-b554-b50973dac91f ==============================
[0m22:26:13.749073 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:26:13.749435 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'profiles_dir': '/Users/luc/.dbt', 'target_path': 'None', 'empty': 'None', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'debug': 'False', 'no_print': 'None', 'fail_fast': 'False', 'printer_width': '80', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'warn_error': 'None', 'log_format': 'default', 'use_experimental_parser': 'False'}
[0m22:26:13.758468 [info ] [MainThread]: dbt version: 1.10.13
[0m22:26:13.758676 [info ] [MainThread]: python version: 3.9.6
[0m22:26:13.758846 [info ] [MainThread]: python path: /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/magpie_youtube/.venv_dbt/bin/python3
[0m22:26:13.759011 [info ] [MainThread]: os info: macOS-14.4.1-arm64-arm-64bit
[0m22:26:14.063561 [info ] [MainThread]: Using profiles dir at /Users/luc/.dbt
[0m22:26:14.063852 [info ] [MainThread]: Using profiles.yml file at /Users/luc/.dbt/profiles.yml
[0m22:26:14.064021 [info ] [MainThread]: Using dbt_project.yml file at /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/dbt_project.yml
[0m22:26:14.064372 [info ] [MainThread]: adapter type: snowflake
[0m22:26:14.064569 [info ] [MainThread]: adapter version: 1.8.4
[0m22:26:14.124248 [info ] [MainThread]: Configuration:
[0m22:26:14.124578 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:26:14.124755 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:26:14.124911 [info ] [MainThread]: Required dependencies:
[0m22:26:14.125131 [debug] [MainThread]: Executing "git --help"
[0m22:26:14.200167 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:26:14.200915 [debug] [MainThread]: STDERR: "b''"
[0m22:26:14.201211 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:26:14.201443 [info ] [MainThread]: Connection:
[0m22:26:14.201719 [info ] [MainThread]:   account: azb79167
[0m22:26:14.201893 [info ] [MainThread]:   user: MAGPIE
[0m22:26:14.202067 [info ] [MainThread]:   database: MAGPIE_FINAL_PROJECT
[0m22:26:14.202230 [info ] [MainThread]:   warehouse: TRAINING_WH
[0m22:26:14.202393 [info ] [MainThread]:   role: TRAINING_ROLE
[0m22:26:14.202557 [info ] [MainThread]:   schema: STAGING
[0m22:26:14.202718 [info ] [MainThread]:   authenticator: None
[0m22:26:14.202879 [info ] [MainThread]:   oauth_client_id: None
[0m22:26:14.203041 [info ] [MainThread]:   query_tag: None
[0m22:26:14.203206 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:26:14.203368 [info ] [MainThread]:   host: None
[0m22:26:14.203537 [info ] [MainThread]:   port: None
[0m22:26:14.203695 [info ] [MainThread]:   proxy_host: None
[0m22:26:14.203851 [info ] [MainThread]:   proxy_port: None
[0m22:26:14.204007 [info ] [MainThread]:   protocol: None
[0m22:26:14.204167 [info ] [MainThread]:   connect_retries: 1
[0m22:26:14.204324 [info ] [MainThread]:   connect_timeout: None
[0m22:26:14.204480 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:26:14.204637 [info ] [MainThread]:   retry_all: False
[0m22:26:14.204796 [info ] [MainThread]:   insecure_mode: False
[0m22:26:14.204956 [info ] [MainThread]:   reuse_connections: None
[0m22:26:14.205416 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:26:14.299284 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:26:14.299891 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:26:14.300066 [debug] [MainThread]: On debug: select 1 as id
[0m22:26:14.300223 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:26:15.609819 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.309 seconds
[0m22:26:15.611742 [debug] [MainThread]: On debug: Close
[0m22:26:15.809077 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:26:15.810234 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:26:15.815272 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.117621, "process_in_blocks": "0", "process_kernel_time": 0.317006, "process_mem_max_rss": "152502272", "process_out_blocks": "0", "process_user_time": 1.380874}
[0m22:26:15.816108 [debug] [MainThread]: Command `dbt debug` succeeded at 22:26:15.815932 after 2.12 seconds
[0m22:26:15.816632 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:26:15.817168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112eab520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a151f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149f79d0>]}
[0m22:26:15.817800 [debug] [MainThread]: Flushing usage events
[0m22:26:16.184626 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:30:18.372206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10702b5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c6790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c6ac0>]}


============================== 22:30:18.375427 | 31df0285-153a-4f9c-b55b-16683123ebf9 ==============================
[0m22:30:18.375427 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:30:18.375773 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'empty': 'False', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'use_colors': 'True', 'log_format': 'default', 'profiles_dir': '/Users/luc/.dbt', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'warn_error': 'None', 'write_json': 'True', 'version_check': 'True', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'printer_width': '80', 'target_path': 'None', 'partial_parse': 'True'}
[0m22:30:18.796496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31df0285-153a-4f9c-b55b-16683123ebf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057bc1c0>]}
[0m22:30:18.857906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31df0285-153a-4f9c-b55b-16683123ebf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109371430>]}
[0m22:30:18.860277 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:30:19.036720 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:30:19.136327 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:30:19.136800 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m22:30:19.137135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '31df0285-153a-4f9c-b55b-16683123ebf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10793ef40>]}
[0m22:30:19.994332 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m22:30:19.994691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '31df0285-153a-4f9c-b55b-16683123ebf9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109996f70>]}
[0m22:30:20.140757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31df0285-153a-4f9c-b55b-16683123ebf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5c1130>]}
[0m22:30:20.200593 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m22:30:20.202128 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m22:30:20.214019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31df0285-153a-4f9c-b55b-16683123ebf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098ef100>]}
[0m22:30:20.214329 [info ] [MainThread]: Found 5 models, 13 data tests, 1 source, 477 macros
[0m22:30:20.214514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31df0285-153a-4f9c-b55b-16683123ebf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5b75b0>]}
[0m22:30:20.215414 [info ] [MainThread]: 
[0m22:30:20.215611 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:30:20.215770 [info ] [MainThread]: 
[0m22:30:20.216041 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:30:20.218944 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m22:30:20.227016 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m22:30:20.227213 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m22:30:20.227379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:21.648845 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.421 seconds
[0m22:30:21.652198 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m22:30:21.856851 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m22:30:21.857529 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m22:30:21.858030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:30:22.753565 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.895 seconds
[0m22:30:22.759295 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m22:30:23.211148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now create_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m22:30:23.212737 [debug] [ThreadPool]: Creating schema "database: "MAGPIE_FINAL_PROJECT"
schema: "STAGING_STAGING"
"
[0m22:30:23.222969 [debug] [ThreadPool]: Using snowflake connection "create_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m22:30:23.223547 [debug] [ThreadPool]: On create_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "create_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
create schema if not exists MAGPIE_FINAL_PROJECT.STAGING_STAGING
[0m22:30:23.224025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:30:24.063418 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.839 seconds
[0m22:30:24.066710 [debug] [ThreadPool]: On create_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m22:30:24.249149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now create_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m22:30:24.250225 [debug] [ThreadPool]: Creating schema "database: "MAGPIE_FINAL_PROJECT"
schema: "STAGING_MARTS"
"
[0m22:30:24.256879 [debug] [ThreadPool]: Using snowflake connection "create_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m22:30:24.257638 [debug] [ThreadPool]: On create_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "create_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
create schema if not exists MAGPIE_FINAL_PROJECT.STAGING_MARTS
[0m22:30:24.258143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:30:25.300544 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.042 seconds
[0m22:30:25.303048 [debug] [ThreadPool]: On create_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m22:30:25.528015 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m22:30:25.544751 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m22:30:25.545297 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m22:30:25.545706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:30:26.500732 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.955 seconds
[0m22:30:26.504814 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m22:30:26.698188 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m22:30:26.702348 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m22:30:26.702656 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m22:30:26.702858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:30:27.723435 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.020 seconds
[0m22:30:27.727780 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m22:30:27.911606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31df0285-153a-4f9c-b55b-16683123ebf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa8f70>]}
[0m22:30:27.915508 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.dim_city
[0m22:30:27.916053 [info ] [Thread-1  ]: 1 of 5 START sql view model STAGING_MARTS.dim_city ............................. [RUN]
[0m22:30:27.916396 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now model.youtube_dbt_project.dim_city)
[0m22:30:27.916619 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.dim_city
[0m22:30:27.922964 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.dim_city"
[0m22:30:27.923723 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.dim_city
[0m22:30:27.944708 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.dim_city"
[0m22:30:27.945892 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.dim_city"
[0m22:30:27.946183 [debug] [Thread-1  ]: On model.youtube_dbt_project.dim_city: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.dim_city"} */
create or replace   view MAGPIE_FINAL_PROJECT.STAGING_MARTS.dim_city
  
   as (
    -- models/marts/dim_city.sql

SELECT
    'Chicago' AS city,
    41.8781 AS latitude,
    -87.6298 AS longitude,
    'America/Chicago' AS timezone
  );
[0m22:30:27.946442 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:30:29.101567 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.154 seconds
[0m22:30:29.136452 [debug] [Thread-1  ]: On model.youtube_dbt_project.dim_city: Close
[0m22:30:29.407181 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31df0285-153a-4f9c-b55b-16683123ebf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10914b4c0>]}
[0m22:30:29.408415 [info ] [Thread-1  ]: 1 of 5 OK created sql view model STAGING_MARTS.dim_city ........................ [[32mSUCCESS 1[0m in 1.49s]
[0m22:30:29.409403 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.dim_city
[0m22:30:29.410044 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.stg_weather
[0m22:30:29.410921 [info ] [Thread-1  ]: 2 of 5 START sql view model STAGING_STAGING.stg_weather ........................ [RUN]
[0m22:30:29.411716 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtube_dbt_project.dim_city, now model.youtube_dbt_project.stg_weather)
[0m22:30:29.412327 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.stg_weather
[0m22:30:29.416273 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.stg_weather"
[0m22:30:29.417192 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.stg_weather
[0m22:30:29.421505 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.stg_weather"
[0m22:30:29.422939 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.stg_weather"
[0m22:30:29.423462 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.stg_weather"} */
create or replace   view MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_weather
  
   as (
    -- models/staging/stg_weather.sql

SELECT					-- note there is no CREATE TABLE
    time,
    CAST(time AS TIMESTAMP) AS datetime,
    temperature_2m,
    relative_humidity_2m,
    windspeed_10m,
    'Chicago' AS city
FROM raw_weather
WHERE time IS NOT NULL
  );
[0m22:30:29.423972 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:30:30.305566 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e22e-0307-3356-000e-9ce300bc3a26
[0m22:30:30.306219 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'MAGPIE_FINAL_PROJECT.STAGING_STAGING.RAW_WEATHER' does not exist or not authorized.
[0m22:30:30.306785 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_weather: Close
[0m22:30:30.536938 [debug] [Thread-1  ]: Database Error in model stg_weather (models/staging/stg_weather.sql)
  002003 (42S02): SQL compilation error:
  Object 'MAGPIE_FINAL_PROJECT.STAGING_STAGING.RAW_WEATHER' does not exist or not authorized.
  compiled code at target/run/youtube_dbt_project/models/staging/stg_weather.sql
[0m22:30:30.537778 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31df0285-153a-4f9c-b55b-16683123ebf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106acc220>]}
[0m22:30:30.538663 [error] [Thread-1  ]: 2 of 5 ERROR creating sql view model STAGING_STAGING.stg_weather ............... [[31mERROR[0m in 1.13s]
[0m22:30:30.539447 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.stg_weather
[0m22:30:30.539955 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.stg_youtube_videos
[0m22:30:30.540620 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.stg_weather' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather (models/staging/stg_weather.sql)
  002003 (42S02): SQL compilation error:
  Object 'MAGPIE_FINAL_PROJECT.STAGING_STAGING.RAW_WEATHER' does not exist or not authorized.
  compiled code at target/run/youtube_dbt_project/models/staging/stg_weather.sql.
[0m22:30:30.541308 [info ] [Thread-1  ]: 3 of 5 START sql view model STAGING_STAGING.stg_youtube_videos ................. [RUN]
[0m22:30:30.542136 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtube_dbt_project.stg_weather, now model.youtube_dbt_project.stg_youtube_videos)
[0m22:30:30.542575 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.stg_youtube_videos
[0m22:30:30.547470 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.stg_youtube_videos"
[0m22:30:30.548303 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.stg_youtube_videos
[0m22:30:30.551997 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.stg_youtube_videos"
[0m22:30:30.554129 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.stg_youtube_videos"
[0m22:30:30.554617 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.stg_youtube_videos"} */
create or replace   view MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
  
   as (
    

with source as (

    select
        video_id,
        trending_date,
        title,
        channel_title,
        category_id,
        publish_time,
        tags,
        views::number                as views,
        likes::number                as likes,
        dislikes::number             as dislikes,
        comment_count::number        as comment_count,
        country,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from MAGPIE_FINAL_PROJECT.RAW.RAW_YOUTUBE_TRENDING

),

cleaned as (

    select
        video_id,
        to_date(trending_date, 'YY.DD.MM') as trending_date,
        title,
        channel_title,
        category_id::number                as category_id,
        to_timestamp(publish_time)         as publish_ts,
        tags,
        views,
        likes,
        dislikes,
        comment_count,
        country,
        comments_disabled::boolean         as comments_disabled,
        ratings_disabled::boolean          as ratings_disabled,
        video_error_or_removed::boolean    as video_error_or_removed
    from source

)

select *
from cleaned;
[0m22:30:30.555080 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:30:31.464814 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e22e-0307-3709-000e-9ce300bc0b7a
[0m22:30:31.465466 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 51 at position 12 unexpected ';'.
[0m22:30:31.466082 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: Close
[0m22:30:31.691511 [debug] [Thread-1  ]: Database Error in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 51 at position 12 unexpected ';'.
  compiled code at target/run/youtube_dbt_project/models/staging/stg_youtube_videos.sql
[0m22:30:31.692574 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31df0285-153a-4f9c-b55b-16683123ebf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10914b4c0>]}
[0m22:30:31.693530 [error] [Thread-1  ]: 3 of 5 ERROR creating sql view model STAGING_STAGING.stg_youtube_videos ........ [[31mERROR[0m in 1.15s]
[0m22:30:31.694303 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.stg_youtube_videos
[0m22:30:31.694825 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fact_weather
[0m22:30:31.695496 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.stg_youtube_videos' to be skipped because of status 'error'.  Reason: Database Error in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 51 at position 12 unexpected ';'.
  compiled code at target/run/youtube_dbt_project/models/staging/stg_youtube_videos.sql.
[0m22:30:31.696085 [info ] [Thread-1  ]: 4 of 5 SKIP relation STAGING_MARTS.fact_weather ................................ [[33mSKIP[0m]
[0m22:30:31.696863 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fact_weather
[0m22:30:31.697776 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fact_weather_daily
[0m22:30:31.698311 [info ] [Thread-1  ]: 5 of 5 SKIP relation STAGING_MARTS.fact_weather_daily .......................... [[33mSKIP[0m]
[0m22:30:31.698786 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fact_weather_daily
[0m22:30:31.699897 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:30:31.700286 [debug] [MainThread]: Connection 'model.youtube_dbt_project.stg_youtube_videos' was properly closed.
[0m22:30:31.700715 [info ] [MainThread]: 
[0m22:30:31.701086 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 11.48 seconds (11.48s).
[0m22:30:31.702259 [debug] [MainThread]: Command end result
[0m22:30:31.732294 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m22:30:31.733825 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m22:30:31.739364 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m22:30:31.739590 [info ] [MainThread]: 
[0m22:30:31.739850 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:30:31.740063 [info ] [MainThread]: 
[0m22:30:31.740326 [error] [MainThread]: [31mFailure in model stg_weather (models/staging/stg_weather.sql)[0m
[0m22:30:31.740582 [error] [MainThread]:   Database Error in model stg_weather (models/staging/stg_weather.sql)
  002003 (42S02): SQL compilation error:
  Object 'MAGPIE_FINAL_PROJECT.STAGING_STAGING.RAW_WEATHER' does not exist or not authorized.
  compiled code at target/run/youtube_dbt_project/models/staging/stg_weather.sql
[0m22:30:31.740781 [info ] [MainThread]: 
[0m22:30:31.741016 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/staging/stg_weather.sql
[0m22:30:31.741212 [info ] [MainThread]: 
[0m22:30:31.741457 [error] [MainThread]: [31mFailure in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)[0m
[0m22:30:31.741705 [error] [MainThread]:   Database Error in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 51 at position 12 unexpected ';'.
  compiled code at target/run/youtube_dbt_project/models/staging/stg_youtube_videos.sql
[0m22:30:31.741897 [info ] [MainThread]: 
[0m22:30:31.742129 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/staging/stg_youtube_videos.sql
[0m22:30:31.742317 [info ] [MainThread]: 
[0m22:30:31.742526 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=2 NO-OP=0 TOTAL=5
[0m22:30:31.742942 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:30:31.744660 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 13.4192705, "process_in_blocks": "0", "process_kernel_time": 0.433309, "process_mem_max_rss": "161234944", "process_out_blocks": "0", "process_user_time": 5.081674}
[0m22:30:31.744923 [debug] [MainThread]: Command `dbt run` failed at 22:30:31.744866 after 13.42 seconds
[0m22:30:31.745169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10702b5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057bc1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109371430>]}
[0m22:30:31.745410 [debug] [MainThread]: Flushing usage events
[0m22:30:32.044406 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:38:16.934725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107173610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10820f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10820fa60>]}


============================== 22:38:16.938008 | 5c9e0457-e083-4932-b10f-ca4c75fff664 ==============================
[0m22:38:16.938008 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:38:16.938367 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'introspect': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'invocation_command': 'dbt run --select stg_youtube_videos', 'log_cache_events': 'False', 'partial_parse': 'True', 'log_format': 'default', 'target_path': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/luc/.dbt', 'use_experimental_parser': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'use_colors': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'static_parser': 'True', 'version_check': 'True', 'fail_fast': 'False'}
[0m22:38:17.268419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c9e0457-e083-4932-b10f-ca4c75fff664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10937b9a0>]}
[0m22:38:17.302784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c9e0457-e083-4932-b10f-ca4c75fff664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094b0580>]}
[0m22:38:17.303311 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:38:17.401376 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:38:17.499644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m22:38:17.500057 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/staging/stg_weather.sql
[0m22:38:17.500297 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/marts/fact_weather_daily.sql
[0m22:38:17.500518 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/staging/stg_youtube_videos.sql
[0m22:38:17.500730 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/marts/fact_weather.sql
[0m22:38:17.705173 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m22:38:17.705509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5c9e0457-e083-4932-b10f-ca4c75fff664', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b81880>]}
[0m22:38:17.730879 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.youtube_dbt_project.stg_youtube_videos' (models/staging/stg_youtube_videos.sql) depends on a source named 'raw.RAW_YOUTUBE_TRENDING' which was not found
[0m22:38:17.731262 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:38:17.733582 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8463444, "process_in_blocks": "0", "process_kernel_time": 0.232204, "process_mem_max_rss": "139132928", "process_out_blocks": "0", "process_user_time": 1.365465}
[0m22:38:17.733817 [debug] [MainThread]: Command `dbt run` failed at 22:38:17.733764 after 0.85 seconds
[0m22:38:17.734020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107173610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106650880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a1d8b0>]}
[0m22:38:17.734214 [debug] [MainThread]: Flushing usage events
[0m22:38:18.087044 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:40:58.676444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079645e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089ff7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089ffaf0>]}


============================== 22:40:58.679714 | c8f1b118-0c21-4ef3-b9dc-c7222f88ed70 ==============================
[0m22:40:58.679714 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:40:58.680071 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'warn_error': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'fail_fast': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'profiles_dir': '/Users/luc/.dbt', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'debug': 'False', 'empty': 'False', 'quiet': 'False', 'invocation_command': 'dbt run --select stg_youtube_videos', 'log_cache_events': 'False', 'printer_width': '80', 'write_json': 'True', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'version_check': 'True'}
[0m22:40:59.021008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8f1b118-0c21-4ef3-b9dc-c7222f88ed70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bad7f0>]}
[0m22:40:59.055880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8f1b118-0c21-4ef3-b9dc-c7222f88ed70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109acc520>]}
[0m22:40:59.056424 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:40:59.155593 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:40:59.255434 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 4 files changed.
[0m22:40:59.255802 [debug] [MainThread]: Partial parsing: added file: youtube_dbt_project://models/sources.yml
[0m22:40:59.256059 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/staging/stg_weather.sql
[0m22:40:59.256294 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/marts/fact_weather.sql
[0m22:40:59.256521 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/marts/fact_weather_daily.sql
[0m22:40:59.256737 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/staging/stg_youtube_videos.sql
[0m22:40:59.506388 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m22:40:59.506753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c8f1b118-0c21-4ef3-b9dc-c7222f88ed70', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af3a850>]}
[0m22:40:59.544195 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_stg_weather_datetime.554d39b0ed' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m22:40:59.544494 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.unique_stg_weather_datetime.ea99166edf' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m22:40:59.544663 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_stg_weather_temperature_2m.4552381acc' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m22:40:59.544823 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.accepted_values_stg_weather_city__Chicago__Evanston__Aurora.3a5db1bdc4' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m22:40:59.544977 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_datetime.36fca5f850' (models/marts/schema.yml) depends on a node named 'fact_weather' which is disabled
[0m22:40:59.545134 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.unique_fact_weather_datetime.f553e65bbe' (models/marts/schema.yml) depends on a node named 'fact_weather' which is disabled
[0m22:40:59.545285 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_feels_like.cf8e8e9258' (models/marts/schema.yml) depends on a node named 'fact_weather' which is disabled
[0m22:40:59.545432 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_daily_date.b304b6aad7' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m22:40:59.545582 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.unique_fact_weather_daily_date.1ee454b4b0' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m22:40:59.545729 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_daily_avg_temperature.c0f9fdc06f' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m22:40:59.545877 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.accepted_values_fact_weather_daily_hourly_records__24.a8a2f8b558' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m22:40:59.625822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8f1b118-0c21-4ef3-b9dc-c7222f88ed70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a201f40>]}
[0m22:40:59.685907 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m22:40:59.687246 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m22:40:59.698632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8f1b118-0c21-4ef3-b9dc-c7222f88ed70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2744f0>]}
[0m22:40:59.698931 [info ] [MainThread]: Found 2 models, 2 data tests, 2 sources, 477 macros
[0m22:40:59.699121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8f1b118-0c21-4ef3-b9dc-c7222f88ed70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a285220>]}
[0m22:40:59.699760 [info ] [MainThread]: 
[0m22:40:59.699951 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:40:59.700116 [info ] [MainThread]: 
[0m22:40:59.700381 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:40:59.700825 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m22:40:59.708821 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m22:40:59.709032 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m22:40:59.709200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:41:01.111725 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.402 seconds
[0m22:41:01.115450 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m22:41:01.345564 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m22:41:01.361553 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m22:41:01.362115 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m22:41:01.362515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:41:02.489778 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.127 seconds
[0m22:41:02.494487 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m22:41:02.683431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m22:41:02.691291 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m22:41:02.691940 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m22:41:02.692410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:41:03.883724 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.191 seconds
[0m22:41:03.888538 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m22:41:04.089061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8f1b118-0c21-4ef3-b9dc-c7222f88ed70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2aaf70>]}
[0m22:41:04.094049 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.stg_youtube_videos
[0m22:41:04.094944 [info ] [Thread-1  ]: 1 of 1 START sql view model STAGING_STAGING.stg_youtube_videos ................. [RUN]
[0m22:41:04.095663 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now model.youtube_dbt_project.stg_youtube_videos)
[0m22:41:04.096247 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.stg_youtube_videos
[0m22:41:04.110799 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.stg_youtube_videos"
[0m22:41:04.111913 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.stg_youtube_videos
[0m22:41:04.142515 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.stg_youtube_videos"
[0m22:41:04.144609 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.stg_youtube_videos"
[0m22:41:04.144989 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.stg_youtube_videos"} */
create or replace   view MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
  
   as (
    

with source as (

    select
        video_id,
        trending_date,
        title,
        channel_title,
        category_id,
        publish_time,
        tags,
        views,
        likes,
        dislikes,
        comment_count,
        country,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from MAGPIE_FINAL_PROJECT.STAGING.RAW_YOUTUBE_TRENDING

),

casted as (

    select
        video_id,
        try_to_date(trending_date)                            as trending_date,
        title,
        channel_title,
        try_to_number(category_id)                            as category_id,
        try_to_timestamp_ntz(publish_time)                    as publish_ts,
        tags,
        try_to_number(views)                                  as views,
        try_to_number(likes)                                  as likes,
        try_to_number(dislikes)                               as dislikes,
        try_to_number(comment_count)                          as comment_count,
        country,
        iff(comments_disabled = 'True', true, false)          as comments_disabled_flag,
        iff(ratings_disabled  = 'True', true, false)          as ratings_disabled_flag,
        iff(video_error_or_removed = 'True', true, false)     as video_error_or_removed_flag
    from source

)

select *
from casted;
[0m22:41:04.145330 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:41:05.331021 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e239-0307-3356-000e-9ce300bc3a76
[0m22:41:05.331616 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 51 at position 11 unexpected ';'.
[0m22:41:05.332161 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: Close
[0m22:41:05.553652 [debug] [Thread-1  ]: Database Error in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 51 at position 11 unexpected ';'.
  compiled code at target/run/youtube_dbt_project/models/staging/stg_youtube_videos.sql
[0m22:41:05.556556 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8f1b118-0c21-4ef3-b9dc-c7222f88ed70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be6f2e0>]}
[0m22:41:05.557508 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model STAGING_STAGING.stg_youtube_videos ........ [[31mERROR[0m in 1.46s]
[0m22:41:05.558299 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.stg_youtube_videos
[0m22:41:05.558960 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.stg_youtube_videos' to be skipped because of status 'error'.  Reason: Database Error in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 51 at position 11 unexpected ';'.
  compiled code at target/run/youtube_dbt_project/models/staging/stg_youtube_videos.sql.
[0m22:41:05.560269 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:41:05.560640 [debug] [MainThread]: Connection 'model.youtube_dbt_project.stg_youtube_videos' was properly closed.
[0m22:41:05.560976 [info ] [MainThread]: 
[0m22:41:05.561334 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.86 seconds (5.86s).
[0m22:41:05.562076 [debug] [MainThread]: Command end result
[0m22:41:05.592566 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m22:41:05.593932 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m22:41:05.599402 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m22:41:05.599641 [info ] [MainThread]: 
[0m22:41:05.599907 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:41:05.600121 [info ] [MainThread]: 
[0m22:41:05.600384 [error] [MainThread]: [31mFailure in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)[0m
[0m22:41:05.600646 [error] [MainThread]:   Database Error in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 51 at position 11 unexpected ';'.
  compiled code at target/run/youtube_dbt_project/models/staging/stg_youtube_videos.sql
[0m22:41:05.600846 [info ] [MainThread]: 
[0m22:41:05.601084 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/staging/stg_youtube_videos.sql
[0m22:41:05.601270 [info ] [MainThread]: 
[0m22:41:05.601478 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:41:05.601848 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:41:05.603653 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.975883, "process_in_blocks": "0", "process_kernel_time": 0.337149, "process_mem_max_rss": "167723008", "process_out_blocks": "0", "process_user_time": 2.946697}
[0m22:41:05.603929 [debug] [MainThread]: Command `dbt run` failed at 22:41:05.603870 after 6.98 seconds
[0m22:41:05.604186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079645e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2744f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c07850>]}
[0m22:41:05.604444 [debug] [MainThread]: Flushing usage events
[0m22:41:05.947630 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:43:44.969779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d705e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10790b7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10790baf0>]}


============================== 22:43:44.972944 | 34ee6ba9-4278-4320-a7c7-0b053ec0eab9 ==============================
[0m22:43:44.972944 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:43:44.973293 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'debug': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'printer_width': '80', 'version_check': 'True', 'invocation_command': 'dbt run --select stg_youtube_videos', 'empty': 'False', 'profiles_dir': '/Users/luc/.dbt', 'log_format': 'default', 'static_parser': 'True', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None'}
[0m22:43:45.311210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34ee6ba9-4278-4320-a7c7-0b053ec0eab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c947f0>]}
[0m22:43:45.346144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34ee6ba9-4278-4320-a7c7-0b053ec0eab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c64520>]}
[0m22:43:45.346730 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:43:45.446627 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:43:45.546153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:43:45.546554 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/staging/stg_youtube_videos.sql
[0m22:43:45.794991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34ee6ba9-4278-4320-a7c7-0b053ec0eab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112991130>]}
[0m22:43:45.858254 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m22:43:45.859554 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m22:43:45.908755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34ee6ba9-4278-4320-a7c7-0b053ec0eab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112879fa0>]}
[0m22:43:45.909101 [info ] [MainThread]: Found 2 models, 2 data tests, 2 sources, 477 macros
[0m22:43:45.909297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34ee6ba9-4278-4320-a7c7-0b053ec0eab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128b8fa0>]}
[0m22:43:45.909918 [info ] [MainThread]: 
[0m22:43:45.910103 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:43:45.910257 [info ] [MainThread]: 
[0m22:43:45.910518 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:43:45.911011 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m22:43:45.918684 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m22:43:45.918879 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m22:43:45.919042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:47.431372 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.512 seconds
[0m22:43:47.435780 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m22:43:47.658929 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m22:43:47.674858 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m22:43:47.675402 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m22:43:47.675810 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:43:48.728266 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.052 seconds
[0m22:43:48.732656 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m22:43:48.924254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m22:43:48.930512 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m22:43:48.931099 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m22:43:48.931584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:43:49.836423 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.904 seconds
[0m22:43:49.840765 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m22:43:50.051972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34ee6ba9-4278-4320-a7c7-0b053ec0eab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10418d460>]}
[0m22:43:50.056784 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.stg_youtube_videos
[0m22:43:50.057770 [info ] [Thread-1  ]: 1 of 1 START sql view model STAGING_STAGING.stg_youtube_videos ................. [RUN]
[0m22:43:50.058522 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now model.youtube_dbt_project.stg_youtube_videos)
[0m22:43:50.059110 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.stg_youtube_videos
[0m22:43:50.073197 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.stg_youtube_videos"
[0m22:43:50.074467 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.stg_youtube_videos
[0m22:43:50.105396 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.stg_youtube_videos"
[0m22:43:50.107166 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.stg_youtube_videos"
[0m22:43:50.107534 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.stg_youtube_videos"} */
create or replace   view MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
  
   as (
    

with source as (

    select
        video_id,
        trending_date,
        title,
        channel_title,
        category_id,
        publish_time,
        tags,
        views::number         as views,
        likes::number         as likes,
        dislikes::number      as dislikes,
        comment_count::number as comment_count,
        country,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from MAGPIE_FINAL_PROJECT.STAGING.RAW_YOUTUBE_TRENDING

),

cleaned as (

    select
        video_id,
        to_date(trending_date)            as trending_date,
        title,
        channel_title,
        category_id::number               as category_id,
        to_timestamp(publish_time)        as publish_ts,
        tags,
        views,
        likes,
        dislikes,
        comment_count,
        upper(country)                    as country,
        comments_disabled::boolean        as comments_disabled,
        ratings_disabled::boolean         as ratings_disabled,
        video_error_or_removed::boolean   as video_error_or_removed
    from source

)

select *
from cleaned
  );
[0m22:43:50.107873 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:43:50.971816 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e23b-0307-3709-000e-9ce300bc0bce
[0m22:43:50.972440 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'MAGPIE_FINAL_PROJECT.STAGING' does not exist or not authorized.
[0m22:43:50.973023 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: Close
[0m22:43:51.515687 [debug] [Thread-1  ]: Database Error in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)
  002003 (02000): SQL compilation error:
  Schema 'MAGPIE_FINAL_PROJECT.STAGING' does not exist or not authorized.
  compiled code at target/run/youtube_dbt_project/models/staging/stg_youtube_videos.sql
[0m22:43:51.519037 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34ee6ba9-4278-4320-a7c7-0b053ec0eab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056c4580>]}
[0m22:43:51.519959 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model STAGING_STAGING.stg_youtube_videos ........ [[31mERROR[0m in 1.46s]
[0m22:43:51.520748 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.stg_youtube_videos
[0m22:43:51.521416 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.stg_youtube_videos' to be skipped because of status 'error'.  Reason: Database Error in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)
  002003 (02000): SQL compilation error:
  Schema 'MAGPIE_FINAL_PROJECT.STAGING' does not exist or not authorized.
  compiled code at target/run/youtube_dbt_project/models/staging/stg_youtube_videos.sql.
[0m22:43:51.522614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:43:51.522935 [debug] [MainThread]: Connection 'model.youtube_dbt_project.stg_youtube_videos' was properly closed.
[0m22:43:51.523246 [info ] [MainThread]: 
[0m22:43:51.523578 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.61 seconds (5.61s).
[0m22:43:51.524298 [debug] [MainThread]: Command end result
[0m22:43:51.554711 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m22:43:51.556133 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m22:43:51.561708 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m22:43:51.561945 [info ] [MainThread]: 
[0m22:43:51.562217 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:43:51.562439 [info ] [MainThread]: 
[0m22:43:51.562705 [error] [MainThread]: [31mFailure in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)[0m
[0m22:43:51.562972 [error] [MainThread]:   Database Error in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)
  002003 (02000): SQL compilation error:
  Schema 'MAGPIE_FINAL_PROJECT.STAGING' does not exist or not authorized.
  compiled code at target/run/youtube_dbt_project/models/staging/stg_youtube_videos.sql
[0m22:43:51.563174 [info ] [MainThread]: 
[0m22:43:51.563408 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/staging/stg_youtube_videos.sql
[0m22:43:51.563601 [info ] [MainThread]: 
[0m22:43:51.563810 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:43:51.565420 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.641707, "process_in_blocks": "0", "process_kernel_time": 0.321974, "process_mem_max_rss": "166985728", "process_out_blocks": "0", "process_user_time": 2.843842}
[0m22:43:51.565691 [debug] [MainThread]: Command `dbt run` failed at 22:43:51.565635 after 6.64 seconds
[0m22:43:51.565945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d705e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128f3f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128f3430>]}
[0m22:43:51.566201 [debug] [MainThread]: Flushing usage events
[0m22:43:51.795650 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:49:50.511866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10596b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a07730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a07a60>]}


============================== 22:49:50.515039 | 9f97212d-432c-45f9-afe6-3280dc9f2f74 ==============================
[0m22:49:50.515039 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:49:50.515405 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'version_check': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'profiles_dir': '/Users/luc/.dbt', 'empty': 'False', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'no_print': 'None', 'log_format': 'default', 'write_json': 'True', 'fail_fast': 'False', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager', 'quiet': 'False', 'invocation_command': 'dbt run --select stg_youtube_videos', 'debug': 'False', 'use_colors': 'True'}
[0m22:49:50.850238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f97212d-432c-45f9-afe6-3280dc9f2f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac39a0>]}
[0m22:49:50.884968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f97212d-432c-45f9-afe6-3280dc9f2f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ca8580>]}
[0m22:49:50.885530 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:49:50.983818 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:49:51.083811 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:49:51.084208 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/staging/sources.yml
[0m22:49:51.138215 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "raw_RAW_YOUTUBE_TRENDING".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("raw", "RAW_YOUTUBE_TRENDING").
  
  To fix this, change the name of one of these resources:
  - source.youtube_dbt_project.raw.RAW_YOUTUBE_TRENDING (models/staging/sources.yml)
  - source.youtube_dbt_project.raw.RAW_YOUTUBE_TRENDING (models/sources.yml)
[0m22:49:51.140406 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6749755, "process_in_blocks": "0", "process_kernel_time": 0.240686, "process_mem_max_rss": "134922240", "process_out_blocks": "0", "process_user_time": 1.199599}
[0m22:49:51.140669 [debug] [MainThread]: Command `dbt run` failed at 22:49:51.140610 after 0.68 seconds
[0m22:49:51.140890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10596b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d6eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10824d940>]}
[0m22:49:51.141111 [debug] [MainThread]: Flushing usage events
[0m22:49:51.535370 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:52:20.754728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d00610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fcb730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fcba60>]}


============================== 22:52:20.757876 | 84f63830-ab30-4172-8be4-cbfc78ef8947 ==============================
[0m22:52:20.757876 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:52:20.758249 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'write_json': 'True', 'introspect': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt run --select stg_youtube_videos', 'quiet': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'debug': 'False', 'printer_width': '80', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'static_parser': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'profiles_dir': '/Users/luc/.dbt', 'empty': 'False', 'fail_fast': 'False'}
[0m22:52:21.095691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84f63830-ab30-4172-8be4-cbfc78ef8947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c539a0>]}
[0m22:52:21.130765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84f63830-ab30-4172-8be4-cbfc78ef8947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e98580>]}
[0m22:52:21.131297 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:52:21.232696 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:52:21.332812 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m22:52:21.333163 [debug] [MainThread]: Partial parsing: added file: youtube_dbt_project://models/staging/sources_backup.yml
[0m22:52:21.333475 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/sources.yml
[0m22:52:21.568553 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "raw_RAW_YOUTUBE_TRENDING".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("raw", "RAW_YOUTUBE_TRENDING").
  
  To fix this, change the name of one of these resources:
  - source.youtube_dbt_project.raw.RAW_YOUTUBE_TRENDING (models/sources.yml)
  - source.youtube_dbt_project.raw.RAW_YOUTUBE_TRENDING (models/staging/sources_backup.yml)
[0m22:52:21.571459 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8634456, "process_in_blocks": "0", "process_kernel_time": 0.234906, "process_mem_max_rss": "140279808", "process_out_blocks": "0", "process_user_time": 1.388811}
[0m22:52:21.571766 [debug] [MainThread]: Command `dbt run` failed at 22:52:21.571663 after 0.86 seconds
[0m22:52:21.572145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d00610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b540be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b540e20>]}
[0m22:52:21.572373 [debug] [MainThread]: Flushing usage events
[0m22:52:21.907054 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:55:39.804912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049ec5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10658b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10658b9d0>]}


============================== 22:55:39.808100 | 236fc73f-34e1-44c7-8a17-62e24f4b6e59 ==============================
[0m22:55:39.808100 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:55:39.808453 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'static_parser': 'True', 'version_check': 'True', 'log_format': 'default', 'write_json': 'True', 'invocation_command': 'dbt run --select stg_youtube_videos', 'target_path': 'None', 'empty': 'False', 'no_print': 'None', 'introspect': 'True', 'use_colors': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/Users/luc/.dbt', 'fail_fast': 'False', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs'}
[0m22:55:40.157000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '236fc73f-34e1-44c7-8a17-62e24f4b6e59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107902100>]}
[0m22:55:40.193116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '236fc73f-34e1-44c7-8a17-62e24f4b6e59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b5e20>]}
[0m22:55:40.193829 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:55:40.296259 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:55:40.399713 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m22:55:40.400185 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/sources.yml
[0m22:55:40.705811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '236fc73f-34e1-44c7-8a17-62e24f4b6e59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12191b130>]}
[0m22:55:40.805280 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m22:55:40.806746 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m22:55:40.817172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '236fc73f-34e1-44c7-8a17-62e24f4b6e59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121920eb0>]}
[0m22:55:40.817468 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 477 macros
[0m22:55:40.817656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '236fc73f-34e1-44c7-8a17-62e24f4b6e59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12032d8e0>]}
[0m22:55:40.818260 [info ] [MainThread]: 
[0m22:55:40.818456 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:55:40.818612 [info ] [MainThread]: 
[0m22:55:40.818883 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:55:40.819347 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m22:55:40.827371 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m22:55:40.827577 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m22:55:40.827747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:42.198119 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.370 seconds
[0m22:55:42.201897 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m22:55:42.430948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m22:55:42.447369 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m22:55:42.447953 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m22:55:42.448356 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:55:43.731059 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.282 seconds
[0m22:55:43.735017 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m22:55:43.922693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m22:55:43.930982 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m22:55:43.931570 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m22:55:43.932046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:55:45.034282 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.102 seconds
[0m22:55:45.037186 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m22:55:45.221476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '236fc73f-34e1-44c7-8a17-62e24f4b6e59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12191b2e0>]}
[0m22:55:45.226456 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.stg_youtube_videos
[0m22:55:45.227515 [info ] [Thread-1  ]: 1 of 1 START sql view model STAGING_STAGING.stg_youtube_videos ................. [RUN]
[0m22:55:45.228258 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now model.youtube_dbt_project.stg_youtube_videos)
[0m22:55:45.228849 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.stg_youtube_videos
[0m22:55:45.243767 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.stg_youtube_videos"
[0m22:55:45.244597 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.stg_youtube_videos
[0m22:55:45.275522 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.stg_youtube_videos"
[0m22:55:45.277519 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.stg_youtube_videos"
[0m22:55:45.277886 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.stg_youtube_videos"} */
create or replace   view MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
  
   as (
    

with source as (

    select
        video_id,
        trending_date,
        title,
        channel_title,
        category_id,
        publish_time,
        tags,
        views::number         as views,
        likes::number         as likes,
        dislikes::number      as dislikes,
        comment_count::number as comment_count,
        country,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from MAGPIE_FINAL_PROJECT.RAW.RAW_YOUTUBE_TRENDING

),

cleaned as (

    select
        video_id,
        to_date(trending_date)            as trending_date,
        title,
        channel_title,
        category_id::number               as category_id,
        to_timestamp(publish_time)        as publish_ts,
        tags,
        views,
        likes,
        dislikes,
        comment_count,
        upper(country)                    as country,
        comments_disabled::boolean        as comments_disabled,
        ratings_disabled::boolean         as ratings_disabled,
        video_error_or_removed::boolean   as video_error_or_removed
    from source

)

select *
from cleaned
  );
[0m22:55:45.278208 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:55:46.819843 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.541 seconds
[0m22:55:46.860319 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: Close
[0m22:55:47.057437 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '236fc73f-34e1-44c7-8a17-62e24f4b6e59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ec4f0>]}
[0m22:55:47.058918 [info ] [Thread-1  ]: 1 of 1 OK created sql view model STAGING_STAGING.stg_youtube_videos ............ [[32mSUCCESS 1[0m in 1.83s]
[0m22:55:47.059965 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.stg_youtube_videos
[0m22:55:47.061624 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:55:47.062158 [debug] [MainThread]: Connection 'model.youtube_dbt_project.stg_youtube_videos' was properly closed.
[0m22:55:47.062647 [info ] [MainThread]: 
[0m22:55:47.063163 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.24 seconds (6.24s).
[0m22:55:47.064205 [debug] [MainThread]: Command end result
[0m22:55:47.100996 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m22:55:47.103512 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m22:55:47.111503 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m22:55:47.111880 [info ] [MainThread]: 
[0m22:55:47.112220 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:55:47.112456 [info ] [MainThread]: 
[0m22:55:47.112762 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:55:47.115485 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.356944, "process_in_blocks": "0", "process_kernel_time": 0.34329, "process_mem_max_rss": "158384128", "process_out_blocks": "0", "process_user_time": 2.874345}
[0m22:55:47.115922 [debug] [MainThread]: Command `dbt run` succeeded at 22:55:47.115848 after 7.36 seconds
[0m22:55:47.116268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049ec5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121920100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5cb50>]}
[0m22:55:47.116577 [debug] [MainThread]: Flushing usage events
[0m22:55:47.481426 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:02:03.211219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104730610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10620a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10620ab80>]}


============================== 23:02:03.214672 | da2fccb1-490e-4dae-873e-3ccf395a9387 ==============================
[0m23:02:03.214672 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:02:03.215035 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'profiles_dir': '/Users/luc/.dbt', 'introspect': 'True', 'debug': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'log_cache_events': 'False', 'empty': 'None', 'write_json': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'target_path': 'None', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error': 'None', 'quiet': 'False', 'version_check': 'True', 'log_format': 'default'}
[0m23:02:03.560107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da2fccb1-490e-4dae-873e-3ccf395a9387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b8d730>]}
[0m23:02:03.595092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da2fccb1-490e-4dae-873e-3ccf395a9387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ad7f0>]}
[0m23:02:03.595653 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:02:03.695119 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:02:03.795657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:02:03.795922 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:02:03.828581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da2fccb1-490e-4dae-873e-3ccf395a9387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d84ee0>]}
[0m23:02:03.892379 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m23:02:03.893688 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m23:02:03.909610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da2fccb1-490e-4dae-873e-3ccf395a9387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eeaa90>]}
[0m23:02:03.909939 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 477 macros
[0m23:02:03.910182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da2fccb1-490e-4dae-873e-3ccf395a9387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb7d00>]}
[0m23:02:03.910935 [info ] [MainThread]: 
[0m23:02:03.911138 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:02:03.911307 [info ] [MainThread]: 
[0m23:02:03.911592 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:02:03.912097 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT_STAGING_MARTS'
[0m23:02:03.922076 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m23:02:03.922277 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m23:02:03.922446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:05.479491 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.557 seconds
[0m23:02:05.482853 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m23:02:05.816295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m23:02:05.822807 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m23:02:05.823487 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m23:02:05.823972 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:02:07.246055 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.422 seconds
[0m23:02:07.250083 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m23:02:07.726581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da2fccb1-490e-4dae-873e-3ccf395a9387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f126d0>]}
[0m23:02:07.732815 [debug] [Thread-1  ]: Began running node test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8
[0m23:02:07.733593 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_youtube_videos_trending_date .................... [RUN]
[0m23:02:07.734351 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8)
[0m23:02:07.734951 [debug] [Thread-1  ]: Began compiling node test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8
[0m23:02:07.761339 [debug] [Thread-1  ]: Writing injected SQL for node "test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8"
[0m23:02:07.762258 [debug] [Thread-1  ]: Began executing node test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8
[0m23:02:07.784496 [debug] [Thread-1  ]: Writing runtime sql for node "test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8"
[0m23:02:07.785551 [debug] [Thread-1  ]: Using snowflake connection "test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8"
[0m23:02:07.785868 [debug] [Thread-1  ]: On test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trending_date
from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
where trending_date is null



  
  
      
    ) dbt_internal_test
[0m23:02:07.786152 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:02:09.811363 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e24e-0307-3743-000e-9ce300bc2a22
[0m23:02:09.812038 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100040 (22007): Date '18.13.03' is not recognized
[0m23:02:09.812660 [debug] [Thread-1  ]: On test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8: Close
[0m23:02:10.043822 [debug] [Thread-1  ]: Database Error in test not_null_stg_youtube_videos_trending_date (models/schema.yml)
  100040 (22007): Date '18.13.03' is not recognized
  compiled code at target/run/youtube_dbt_project/models/schema.yml/not_null_stg_youtube_videos_trending_date.sql
[0m23:02:10.044721 [error] [Thread-1  ]: 1 of 2 ERROR not_null_stg_youtube_videos_trending_date ......................... [[31mERROR[0m in 2.31s]
[0m23:02:10.045514 [debug] [Thread-1  ]: Finished running node test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8
[0m23:02:10.046041 [debug] [Thread-1  ]: Began running node test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109
[0m23:02:10.046685 [debug] [Thread-4  ]: Marking all children of 'test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_youtube_videos_trending_date (models/schema.yml)
  100040 (22007): Date '18.13.03' is not recognized
  compiled code at target/run/youtube_dbt_project/models/schema.yml/not_null_stg_youtube_videos_trending_date.sql.
[0m23:02:10.047239 [info ] [Thread-1  ]: 2 of 2 START test not_null_stg_youtube_videos_video_id ......................... [RUN]
[0m23:02:10.048111 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8, now test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109)
[0m23:02:10.048677 [debug] [Thread-1  ]: Began compiling node test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109
[0m23:02:10.054989 [debug] [Thread-1  ]: Writing injected SQL for node "test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109"
[0m23:02:10.055981 [debug] [Thread-1  ]: Began executing node test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109
[0m23:02:10.059613 [debug] [Thread-1  ]: Writing runtime sql for node "test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109"
[0m23:02:10.060856 [debug] [Thread-1  ]: Using snowflake connection "test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109"
[0m23:02:10.061249 [debug] [Thread-1  ]: On test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select video_id
from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
where video_id is null



  
  
      
    ) dbt_internal_test
[0m23:02:10.061613 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:02:11.734126 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.672 seconds
[0m23:02:11.743777 [debug] [Thread-1  ]: On test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109: Close
[0m23:02:11.987513 [info ] [Thread-1  ]: 2 of 2 PASS not_null_stg_youtube_videos_video_id ............................... [[32mPASS[0m in 1.94s]
[0m23:02:11.988816 [debug] [Thread-1  ]: Finished running node test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109
[0m23:02:11.990411 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:02:11.990881 [debug] [MainThread]: Connection 'test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109' was properly closed.
[0m23:02:11.991321 [info ] [MainThread]: 
[0m23:02:11.991580 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 8.08 seconds (8.08s).
[0m23:02:11.992096 [debug] [MainThread]: Command end result
[0m23:02:12.009280 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m23:02:12.010502 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m23:02:12.015012 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m23:02:12.015215 [info ] [MainThread]: 
[0m23:02:12.015428 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:02:12.015671 [info ] [MainThread]: 
[0m23:02:12.015916 [error] [MainThread]: [31mFailure in test not_null_stg_youtube_videos_trending_date (models/schema.yml)[0m
[0m23:02:12.016135 [error] [MainThread]:   Database Error in test not_null_stg_youtube_videos_trending_date (models/schema.yml)
  100040 (22007): Date '18.13.03' is not recognized
  compiled code at target/run/youtube_dbt_project/models/schema.yml/not_null_stg_youtube_videos_trending_date.sql
[0m23:02:12.016301 [info ] [MainThread]: 
[0m23:02:12.016506 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/schema.yml/not_null_stg_youtube_videos_trending_date.sql
[0m23:02:12.016687 [info ] [MainThread]: 
[0m23:02:12.016868 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m23:02:12.018622 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 8.855783, "process_in_blocks": "0", "process_kernel_time": 0.322875, "process_mem_max_rss": "157728768", "process_out_blocks": "0", "process_user_time": 2.617346}
[0m23:02:12.018903 [debug] [MainThread]: Command `dbt test` failed at 23:02:12.018852 after 8.86 seconds
[0m23:02:12.019128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104730610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10597d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eede20>]}
[0m23:02:12.019362 [debug] [MainThread]: Flushing usage events
[0m23:02:12.340050 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:07:36.325359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d97640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e33790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e33ac0>]}


============================== 23:07:36.328516 | ff797b94-5393-47d7-a643-b1569f576ef0 ==============================
[0m23:07:36.328516 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:07:36.328858 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'fail_fast': 'False', 'printer_width': '80', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'invocation_command': 'dbt run --select stg_youtube_videos', 'warn_error': 'None', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'use_colors': 'True', 'empty': 'False', 'profiles_dir': '/Users/luc/.dbt', 'static_parser': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'log_cache_events': 'False', 'target_path': 'None', 'quiet': 'False'}
[0m23:07:36.668334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff797b94-5393-47d7-a643-b1569f576ef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f9f6a0>]}
[0m23:07:36.703148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff797b94-5393-47d7-a643-b1569f576ef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec9a90>]}
[0m23:07:36.703689 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:07:36.803741 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:07:36.903936 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:07:36.904381 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/staging/stg_youtube_videos.sql
[0m23:07:37.152741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff797b94-5393-47d7-a643-b1569f576ef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092fa130>]}
[0m23:07:37.253381 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m23:07:37.254607 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m23:07:37.264764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff797b94-5393-47d7-a643-b1569f576ef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108536fd0>]}
[0m23:07:37.265060 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 477 macros
[0m23:07:37.265252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff797b94-5393-47d7-a643-b1569f576ef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109353d60>]}
[0m23:07:37.265895 [info ] [MainThread]: 
[0m23:07:37.266082 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:07:37.266240 [info ] [MainThread]: 
[0m23:07:37.266519 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:07:37.266965 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m23:07:37.274757 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m23:07:37.274954 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m23:07:37.275118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:38.607372 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.332 seconds
[0m23:07:38.610979 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m23:07:38.832868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m23:07:38.848639 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m23:07:38.849148 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m23:07:38.849550 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:07:39.992583 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.143 seconds
[0m23:07:39.996916 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m23:07:40.192373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m23:07:40.199631 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m23:07:40.200487 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m23:07:40.200992 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:07:41.816332 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.615 seconds
[0m23:07:41.821272 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m23:07:42.001412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff797b94-5393-47d7-a643-b1569f576ef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10875db20>]}
[0m23:07:42.007227 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.stg_youtube_videos
[0m23:07:42.008296 [info ] [Thread-1  ]: 1 of 1 START sql view model STAGING_STAGING.stg_youtube_videos ................. [RUN]
[0m23:07:42.009054 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now model.youtube_dbt_project.stg_youtube_videos)
[0m23:07:42.009654 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.stg_youtube_videos
[0m23:07:42.024871 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.stg_youtube_videos"
[0m23:07:42.026101 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.stg_youtube_videos
[0m23:07:42.056152 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.stg_youtube_videos"
[0m23:07:42.057651 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.stg_youtube_videos"
[0m23:07:42.058019 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.stg_youtube_videos"} */
create or replace   view MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
  
   as (
    with source as (

    select
        *
    from MAGPIE_FINAL_PROJECT.RAW.RAW_YOUTUBE_TRENDING

),

cleaned as (

    select
        video_id,
        trending_date as trending_date_raw,

        -- 正确将 "17.14.11" 这种格式解析成日期
        try_to_date(trending_date, 'YY.DD.MM') as trending_date,

        title,
        channel_title,
        category_id,
        publish_time,
        tags,
        views::number          as views,
        likes::number          as likes,
        dislikes::number       as dislikes,
        comment_count::number  as comment_count,
        country,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed

    from source
    where try_to_date(trending_date, 'YY.DD.MM') is not null
)

select *
from cleaned;
[0m23:07:42.058340 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:07:43.279727 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e253-0307-3356-000e-9ce300bc3bca
[0m23:07:43.280314 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 40 at position 12 unexpected ';'.
[0m23:07:43.280853 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: Close
[0m23:07:43.476098 [debug] [Thread-1  ]: Database Error in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 40 at position 12 unexpected ';'.
  compiled code at target/run/youtube_dbt_project/models/staging/stg_youtube_videos.sql
[0m23:07:43.478777 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff797b94-5393-47d7-a643-b1569f576ef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e469d0>]}
[0m23:07:43.479702 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model STAGING_STAGING.stg_youtube_videos ........ [[31mERROR[0m in 1.47s]
[0m23:07:43.480485 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.stg_youtube_videos
[0m23:07:43.481195 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.stg_youtube_videos' to be skipped because of status 'error'.  Reason: Database Error in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 40 at position 12 unexpected ';'.
  compiled code at target/run/youtube_dbt_project/models/staging/stg_youtube_videos.sql.
[0m23:07:43.482596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:07:43.482975 [debug] [MainThread]: Connection 'model.youtube_dbt_project.stg_youtube_videos' was properly closed.
[0m23:07:43.483342 [info ] [MainThread]: 
[0m23:07:43.483712 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.22 seconds (6.22s).
[0m23:07:43.484434 [debug] [MainThread]: Command end result
[0m23:07:43.513767 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m23:07:43.515097 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m23:07:43.520719 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m23:07:43.520994 [info ] [MainThread]: 
[0m23:07:43.521281 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:07:43.521503 [info ] [MainThread]: 
[0m23:07:43.521780 [error] [MainThread]: [31mFailure in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)[0m
[0m23:07:43.522057 [error] [MainThread]:   Database Error in model stg_youtube_videos (models/staging/stg_youtube_videos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 40 at position 12 unexpected ';'.
  compiled code at target/run/youtube_dbt_project/models/staging/stg_youtube_videos.sql
[0m23:07:43.522259 [info ] [MainThread]: 
[0m23:07:43.522499 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/staging/stg_youtube_videos.sql
[0m23:07:43.522692 [info ] [MainThread]: 
[0m23:07:43.522909 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m23:07:43.524696 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.2423577, "process_in_blocks": "0", "process_kernel_time": 0.333044, "process_mem_max_rss": "162758656", "process_out_blocks": "0", "process_user_time": 2.826071}
[0m23:07:43.524973 [debug] [MainThread]: Command `dbt run` failed at 23:07:43.524917 after 7.24 seconds
[0m23:07:43.525241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d97640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092d6ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092d6910>]}
[0m23:07:43.525511 [debug] [MainThread]: Flushing usage events
[0m23:07:43.795230 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:08:15.594232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038ab5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049476a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049479d0>]}


============================== 23:08:15.598045 | 55b33ffc-5afe-4984-a087-45173677ba3b ==============================
[0m23:08:15.598045 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:08:15.598423 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'printer_width': '80', 'empty': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select stg_youtube_videos', 'introspect': 'True', 'log_format': 'default', 'warn_error': 'None', 'profiles_dir': '/Users/luc/.dbt', 'version_check': 'True', 'debug': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'target_path': 'None'}
[0m23:08:15.989096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55b33ffc-5afe-4984-a087-45173677ba3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c02100>]}
[0m23:08:16.023526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55b33ffc-5afe-4984-a087-45173677ba3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104771e20>]}
[0m23:08:16.024111 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:08:16.122665 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:08:16.224709 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:08:16.225126 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/staging/stg_youtube_videos.sql
[0m23:08:16.469662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55b33ffc-5afe-4984-a087-45173677ba3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107160130>]}
[0m23:08:16.570601 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m23:08:16.571857 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m23:08:16.582152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55b33ffc-5afe-4984-a087-45173677ba3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071a6d90>]}
[0m23:08:16.582451 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 477 macros
[0m23:08:16.582640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55b33ffc-5afe-4984-a087-45173677ba3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071730a0>]}
[0m23:08:16.583286 [info ] [MainThread]: 
[0m23:08:16.583481 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:08:16.583637 [info ] [MainThread]: 
[0m23:08:16.583901 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:08:16.584356 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m23:08:16.592086 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m23:08:16.592276 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m23:08:16.592439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:17.687895 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.095 seconds
[0m23:08:17.691338 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m23:08:17.903243 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m23:08:17.919690 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m23:08:17.920209 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m23:08:17.920611 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:08:18.816036 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.895 seconds
[0m23:08:18.819500 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m23:08:19.011179 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m23:08:19.015914 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m23:08:19.016216 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m23:08:19.016404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:08:19.881384 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.864 seconds
[0m23:08:19.886387 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m23:08:20.072398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55b33ffc-5afe-4984-a087-45173677ba3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f75310>]}
[0m23:08:20.078317 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.stg_youtube_videos
[0m23:08:20.079362 [info ] [Thread-1  ]: 1 of 1 START sql view model STAGING_STAGING.stg_youtube_videos ................. [RUN]
[0m23:08:20.080139 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now model.youtube_dbt_project.stg_youtube_videos)
[0m23:08:20.080778 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.stg_youtube_videos
[0m23:08:20.097167 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.stg_youtube_videos"
[0m23:08:20.098176 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.stg_youtube_videos
[0m23:08:20.127481 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.stg_youtube_videos"
[0m23:08:20.129142 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.stg_youtube_videos"
[0m23:08:20.129533 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.stg_youtube_videos"} */
create or replace   view MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
  
   as (
    with source as (

    select
        *
    from MAGPIE_FINAL_PROJECT.RAW.RAW_YOUTUBE_TRENDING

),

cleaned as (

    select
        video_id,
        trending_date as trending_date_raw,

        -- 正确将 "17.14.11" 这种格式解析成日期
        try_to_date(trending_date, 'YY.DD.MM') as trending_date,

        title,
        channel_title,
        category_id,
        publish_time,
        tags,
        views::number          as views,
        likes::number          as likes,
        dislikes::number       as dislikes,
        comment_count::number  as comment_count,
        country,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed

    from source
    where try_to_date(trending_date, 'YY.DD.MM') is not null
)

select *
from cleaned
  );
[0m23:08:20.129887 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:08:21.132434 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.002 seconds
[0m23:08:21.174171 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: Close
[0m23:08:21.436923 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55b33ffc-5afe-4984-a087-45173677ba3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110742af0>]}
[0m23:08:21.438360 [info ] [Thread-1  ]: 1 of 1 OK created sql view model STAGING_STAGING.stg_youtube_videos ............ [[32mSUCCESS 1[0m in 1.35s]
[0m23:08:21.440275 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.stg_youtube_videos
[0m23:08:21.442305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:08:21.442851 [debug] [MainThread]: Connection 'model.youtube_dbt_project.stg_youtube_videos' was properly closed.
[0m23:08:21.443376 [info ] [MainThread]: 
[0m23:08:21.443908 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.86 seconds (4.86s).
[0m23:08:21.444978 [debug] [MainThread]: Command end result
[0m23:08:21.481142 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m23:08:21.482874 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m23:08:21.488597 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m23:08:21.488845 [info ] [MainThread]: 
[0m23:08:21.489145 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:08:21.489367 [info ] [MainThread]: 
[0m23:08:21.489611 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:08:21.491568 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.9481735, "process_in_blocks": "0", "process_kernel_time": 0.336329, "process_mem_max_rss": "162217984", "process_out_blocks": "0", "process_user_time": 2.784429}
[0m23:08:21.491898 [debug] [MainThread]: Command `dbt run` succeeded at 23:08:21.491832 after 5.95 seconds
[0m23:08:21.492260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038ab5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b4fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c02100>]}
[0m23:08:21.492597 [debug] [MainThread]: Flushing usage events
[0m23:08:21.677870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:08:29.582957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e30610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ca850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060cab80>]}


============================== 23:08:29.585583 | 2edafc19-69b1-4abd-b9e2-9511a9fa0b1e ==============================
[0m23:08:29.585583 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:08:29.585926 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'profiles_dir': '/Users/luc/.dbt', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'static_parser': 'True', 'quiet': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test', 'log_format': 'default', 'debug': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'empty': 'None', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'no_print': 'None', 'version_check': 'True', 'printer_width': '80'}
[0m23:08:29.888727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2edafc19-69b1-4abd-b9e2-9511a9fa0b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1021508e0>]}
[0m23:08:29.922877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2edafc19-69b1-4abd-b9e2-9511a9fa0b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10586e7f0>]}
[0m23:08:29.923577 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:08:30.022244 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:08:30.119844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:08:30.120115 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:08:30.153724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2edafc19-69b1-4abd-b9e2-9511a9fa0b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d44ee0>]}
[0m23:08:30.218152 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m23:08:30.219297 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m23:08:30.234077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2edafc19-69b1-4abd-b9e2-9511a9fa0b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eaaa90>]}
[0m23:08:30.234394 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 477 macros
[0m23:08:30.234635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2edafc19-69b1-4abd-b9e2-9511a9fa0b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e77d00>]}
[0m23:08:30.235388 [info ] [MainThread]: 
[0m23:08:30.235586 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:08:30.235743 [info ] [MainThread]: 
[0m23:08:30.236026 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:08:30.236554 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT_STAGING_STAGING'
[0m23:08:30.246563 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m23:08:30.246767 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m23:08:30.246932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:31.236207 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.989 seconds
[0m23:08:31.240912 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m23:08:31.968385 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m23:08:31.974369 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m23:08:31.974938 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m23:08:31.975405 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:08:32.877590 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.902 seconds
[0m23:08:32.883014 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m23:08:33.088643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2edafc19-69b1-4abd-b9e2-9511a9fa0b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed26d0>]}
[0m23:08:33.093830 [debug] [Thread-1  ]: Began running node test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8
[0m23:08:33.094620 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_youtube_videos_trending_date .................... [RUN]
[0m23:08:33.095386 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8)
[0m23:08:33.096004 [debug] [Thread-1  ]: Began compiling node test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8
[0m23:08:33.122900 [debug] [Thread-1  ]: Writing injected SQL for node "test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8"
[0m23:08:33.124117 [debug] [Thread-1  ]: Began executing node test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8
[0m23:08:33.146543 [debug] [Thread-1  ]: Writing runtime sql for node "test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8"
[0m23:08:33.147555 [debug] [Thread-1  ]: Using snowflake connection "test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8"
[0m23:08:33.147880 [debug] [Thread-1  ]: On test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trending_date
from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
where trending_date is null



  
  
      
    ) dbt_internal_test
[0m23:08:33.148176 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:08:34.860156 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.711 seconds
[0m23:08:34.878492 [debug] [Thread-1  ]: On test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8: Close
[0m23:08:35.068922 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_youtube_videos_trending_date .......................... [[32mPASS[0m in 1.97s]
[0m23:08:35.071006 [debug] [Thread-1  ]: Finished running node test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8
[0m23:08:35.072129 [debug] [Thread-1  ]: Began running node test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109
[0m23:08:35.072926 [info ] [Thread-1  ]: 2 of 2 START test not_null_stg_youtube_videos_video_id ......................... [RUN]
[0m23:08:35.073767 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8, now test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109)
[0m23:08:35.074418 [debug] [Thread-1  ]: Began compiling node test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109
[0m23:08:35.082806 [debug] [Thread-1  ]: Writing injected SQL for node "test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109"
[0m23:08:35.083852 [debug] [Thread-1  ]: Began executing node test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109
[0m23:08:35.089570 [debug] [Thread-1  ]: Writing runtime sql for node "test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109"
[0m23:08:35.091036 [debug] [Thread-1  ]: Using snowflake connection "test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109"
[0m23:08:35.091584 [debug] [Thread-1  ]: On test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select video_id
from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
where video_id is null



  
  
      
    ) dbt_internal_test
[0m23:08:35.092117 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:08:35.986269 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.894 seconds
[0m23:08:35.991679 [debug] [Thread-1  ]: On test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109: Close
[0m23:08:36.178846 [info ] [Thread-1  ]: 2 of 2 PASS not_null_stg_youtube_videos_video_id ............................... [[32mPASS[0m in 1.10s]
[0m23:08:36.180267 [debug] [Thread-1  ]: Finished running node test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109
[0m23:08:36.182323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:08:36.183055 [debug] [MainThread]: Connection 'test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109' was properly closed.
[0m23:08:36.183557 [info ] [MainThread]: 
[0m23:08:36.184076 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 5.95 seconds (5.95s).
[0m23:08:36.185402 [debug] [MainThread]: Command end result
[0m23:08:36.223682 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m23:08:36.225320 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m23:08:36.232205 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m23:08:36.232496 [info ] [MainThread]: 
[0m23:08:36.232824 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:08:36.233070 [info ] [MainThread]: 
[0m23:08:36.233342 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m23:08:36.234967 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.696844, "process_in_blocks": "0", "process_kernel_time": 0.254694, "process_mem_max_rss": "160399360", "process_out_blocks": "0", "process_user_time": 2.637114}
[0m23:08:36.235270 [debug] [MainThread]: Command `dbt test` succeeded at 23:08:36.235205 after 6.70 seconds
[0m23:08:36.235548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e30610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10586e7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ead730>]}
[0m23:08:36.235829 [debug] [MainThread]: Flushing usage events
[0m23:08:36.389257 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:13:37.033497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10446c5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f0a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f0aac0>]}


============================== 23:13:37.036669 | 5accef86-9d66-4233-8b41-b2786d321658 ==============================
[0m23:13:37.036669 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:13:37.037047 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'empty': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'no_print': 'None', 'printer_width': '80', 'profiles_dir': '/Users/luc/.dbt', 'fail_fast': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'quiet': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'version_check': 'True', 'introspect': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt run'}
[0m23:13:37.389024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5accef86-9d66-4233-8b41-b2786d321658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10288c1c0>]}
[0m23:13:37.424264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5accef86-9d66-4233-8b41-b2786d321658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a1430>]}
[0m23:13:37.424930 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:13:37.523337 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:13:37.626586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:13:37.626851 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:13:37.660615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5accef86-9d66-4233-8b41-b2786d321658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c4130>]}
[0m23:13:37.725945 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m23:13:37.727311 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m23:13:37.738055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5accef86-9d66-4233-8b41-b2786d321658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107663550>]}
[0m23:13:37.738355 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 477 macros
[0m23:13:37.738556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5accef86-9d66-4233-8b41-b2786d321658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108519ac0>]}
[0m23:13:37.739304 [info ] [MainThread]: 
[0m23:13:37.739503 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:13:37.739659 [info ] [MainThread]: 
[0m23:13:37.739938 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:13:37.742746 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m23:13:37.751561 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m23:13:37.751771 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m23:13:37.751943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:13:39.164689 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.413 seconds
[0m23:13:39.168355 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m23:13:39.382438 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m23:13:39.383128 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m23:13:39.383625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:13:40.570276 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.186 seconds
[0m23:13:40.574716 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m23:13:40.770111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m23:13:40.786941 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m23:13:40.787482 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m23:13:40.787885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:13:41.999684 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.211 seconds
[0m23:13:42.004738 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m23:13:42.197745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m23:13:42.206419 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m23:13:42.207100 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m23:13:42.207579 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:13:43.915549 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.708 seconds
[0m23:13:43.920434 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m23:13:44.426658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5accef86-9d66-4233-8b41-b2786d321658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107355220>]}
[0m23:13:44.432233 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.dim_city
[0m23:13:44.433205 [info ] [Thread-1  ]: 1 of 2 START sql view model STAGING_MARTS.dim_city ............................. [RUN]
[0m23:13:44.433990 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now model.youtube_dbt_project.dim_city)
[0m23:13:44.434586 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.dim_city
[0m23:13:44.447114 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.dim_city"
[0m23:13:44.448911 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.dim_city
[0m23:13:44.479910 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.dim_city"
[0m23:13:44.481029 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.dim_city"
[0m23:13:44.481369 [debug] [Thread-1  ]: On model.youtube_dbt_project.dim_city: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.dim_city"} */
create or replace   view MAGPIE_FINAL_PROJECT.STAGING_MARTS.dim_city
  
   as (
    -- models/marts/dim_city.sql

SELECT
    'Chicago' AS city,
    41.8781 AS latitude,
    -87.6298 AS longitude,
    'America/Chicago' AS timezone
  );
[0m23:13:44.481655 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:13:45.654158 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.172 seconds
[0m23:13:45.692890 [debug] [Thread-1  ]: On model.youtube_dbt_project.dim_city: Close
[0m23:13:45.884846 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5accef86-9d66-4233-8b41-b2786d321658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10726b4c0>]}
[0m23:13:45.886145 [info ] [Thread-1  ]: 1 of 2 OK created sql view model STAGING_MARTS.dim_city ........................ [[32mSUCCESS 1[0m in 1.45s]
[0m23:13:45.887105 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.dim_city
[0m23:13:45.887753 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.stg_youtube_videos
[0m23:13:45.888575 [info ] [Thread-1  ]: 2 of 2 START sql view model STAGING_STAGING.stg_youtube_videos ................. [RUN]
[0m23:13:45.889269 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtube_dbt_project.dim_city, now model.youtube_dbt_project.stg_youtube_videos)
[0m23:13:45.889841 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.stg_youtube_videos
[0m23:13:45.895754 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.stg_youtube_videos"
[0m23:13:45.897333 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.stg_youtube_videos
[0m23:13:45.901734 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.stg_youtube_videos"
[0m23:13:45.904465 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.stg_youtube_videos"
[0m23:13:45.905043 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.stg_youtube_videos"} */
create or replace   view MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
  
   as (
    with source as (

    select
        *
    from MAGPIE_FINAL_PROJECT.RAW.RAW_YOUTUBE_TRENDING

),

cleaned as (

    select
        video_id,
        trending_date as trending_date_raw,

        -- 正确将 "17.14.11" 这种格式解析成日期
        try_to_date(trending_date, 'YY.DD.MM') as trending_date,

        title,
        channel_title,
        category_id,
        publish_time,
        tags,
        views::number          as views,
        likes::number          as likes,
        dislikes::number       as dislikes,
        comment_count::number  as comment_count,
        country,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed

    from source
    where try_to_date(trending_date, 'YY.DD.MM') is not null
)

select *
from cleaned
  );
[0m23:13:45.905514 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:13:47.401884 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.496 seconds
[0m23:13:47.406827 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: Close
[0m23:13:47.612937 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5accef86-9d66-4233-8b41-b2786d321658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10435c220>]}
[0m23:13:47.614902 [info ] [Thread-1  ]: 2 of 2 OK created sql view model STAGING_STAGING.stg_youtube_videos ............ [[32mSUCCESS 1[0m in 1.72s]
[0m23:13:47.616185 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.stg_youtube_videos
[0m23:13:47.617748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:13:47.618292 [debug] [MainThread]: Connection 'model.youtube_dbt_project.stg_youtube_videos' was properly closed.
[0m23:13:47.618870 [info ] [MainThread]: 
[0m23:13:47.619391 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 9.88 seconds (9.88s).
[0m23:13:47.620679 [debug] [MainThread]: Command end result
[0m23:13:47.659681 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m23:13:47.661310 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m23:13:47.667490 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m23:13:47.667764 [info ] [MainThread]: 
[0m23:13:47.668060 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:13:47.668293 [info ] [MainThread]: 
[0m23:13:47.668537 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m23:13:47.670460 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.684344, "process_in_blocks": "0", "process_kernel_time": 0.341649, "process_mem_max_rss": "159301632", "process_out_blocks": "0", "process_user_time": 3.228953}
[0m23:13:47.670766 [debug] [MainThread]: Command `dbt run` succeeded at 23:13:47.670701 after 10.68 seconds
[0m23:13:47.671038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10446c5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085575e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076630d0>]}
[0m23:13:47.671322 [debug] [MainThread]: Flushing usage events
[0m23:13:47.924381 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:13:49.129731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070af5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10814a7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10814ab20>]}


============================== 23:13:49.132435 | 9fb48e2f-8c7f-48a9-85b2-d1fc1d5c8765 ==============================
[0m23:13:49.132435 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:13:49.132770 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'introspect': 'True', 'quiet': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'version_check': 'True', 'target_path': 'None', 'no_print': 'None', 'profiles_dir': '/Users/luc/.dbt', 'use_colors': 'True', 'invocation_command': 'dbt test', 'fail_fast': 'False', 'partial_parse': 'True', 'printer_width': '80', 'debug': 'False', 'static_parser': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs'}
[0m23:13:49.447990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fb48e2f-8c7f-48a9-85b2-d1fc1d5c8765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092d0ca0>]}
[0m23:13:49.487319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fb48e2f-8c7f-48a9-85b2-d1fc1d5c8765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10931d2e0>]}
[0m23:13:49.488064 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:13:49.603073 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:13:49.704306 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:13:49.704640 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:13:49.739061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fb48e2f-8c7f-48a9-85b2-d1fc1d5c8765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098d6a00>]}
[0m23:13:49.803430 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m23:13:49.804696 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m23:13:49.819813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fb48e2f-8c7f-48a9-85b2-d1fc1d5c8765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a3f730>]}
[0m23:13:49.820164 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 477 macros
[0m23:13:49.820416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fb48e2f-8c7f-48a9-85b2-d1fc1d5c8765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a0a160>]}
[0m23:13:49.821197 [info ] [MainThread]: 
[0m23:13:49.821399 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:13:49.821559 [info ] [MainThread]: 
[0m23:13:49.821851 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:13:49.822382 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT_STAGING_STAGING'
[0m23:13:49.832527 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m23:13:49.832757 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m23:13:49.832924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:13:51.395273 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.562 seconds
[0m23:13:51.399854 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m23:13:51.628320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m23:13:51.634130 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m23:13:51.634792 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m23:13:51.635206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:13:52.719411 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.084 seconds
[0m23:13:52.723711 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m23:13:52.902268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fb48e2f-8c7f-48a9-85b2-d1fc1d5c8765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a666a0>]}
[0m23:13:52.907636 [debug] [Thread-1  ]: Began running node test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8
[0m23:13:52.908526 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_youtube_videos_trending_date .................... [RUN]
[0m23:13:52.909287 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8)
[0m23:13:52.909892 [debug] [Thread-1  ]: Began compiling node test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8
[0m23:13:52.935522 [debug] [Thread-1  ]: Writing injected SQL for node "test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8"
[0m23:13:52.936639 [debug] [Thread-1  ]: Began executing node test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8
[0m23:13:52.959246 [debug] [Thread-1  ]: Writing runtime sql for node "test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8"
[0m23:13:52.960230 [debug] [Thread-1  ]: Using snowflake connection "test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8"
[0m23:13:52.960555 [debug] [Thread-1  ]: On test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trending_date
from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
where trending_date is null



  
  
      
    ) dbt_internal_test
[0m23:13:52.960849 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:13:54.256057 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.295 seconds
[0m23:13:54.273713 [debug] [Thread-1  ]: On test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8: Close
[0m23:13:54.571845 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_youtube_videos_trending_date .......................... [[32mPASS[0m in 1.66s]
[0m23:13:54.573640 [debug] [Thread-1  ]: Finished running node test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8
[0m23:13:54.574589 [debug] [Thread-1  ]: Began running node test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109
[0m23:13:54.575345 [info ] [Thread-1  ]: 2 of 2 START test not_null_stg_youtube_videos_video_id ......................... [RUN]
[0m23:13:54.576177 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.youtube_dbt_project.not_null_stg_youtube_videos_trending_date.06f4664fa8, now test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109)
[0m23:13:54.576824 [debug] [Thread-1  ]: Began compiling node test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109
[0m23:13:54.586228 [debug] [Thread-1  ]: Writing injected SQL for node "test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109"
[0m23:13:54.587349 [debug] [Thread-1  ]: Began executing node test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109
[0m23:13:54.591533 [debug] [Thread-1  ]: Writing runtime sql for node "test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109"
[0m23:13:54.592946 [debug] [Thread-1  ]: Using snowflake connection "test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109"
[0m23:13:54.593479 [debug] [Thread-1  ]: On test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select video_id
from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
where video_id is null



  
  
      
    ) dbt_internal_test
[0m23:13:54.594002 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:13:55.530581 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.936 seconds
[0m23:13:55.536293 [debug] [Thread-1  ]: On test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109: Close
[0m23:13:55.739923 [info ] [Thread-1  ]: 2 of 2 PASS not_null_stg_youtube_videos_video_id ............................... [[32mPASS[0m in 1.16s]
[0m23:13:55.741547 [debug] [Thread-1  ]: Finished running node test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109
[0m23:13:55.743373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:13:55.743841 [debug] [MainThread]: Connection 'test.youtube_dbt_project.not_null_stg_youtube_videos_video_id.8200f45109' was properly closed.
[0m23:13:55.744322 [info ] [MainThread]: 
[0m23:13:55.744817 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 5.92 seconds (5.92s).
[0m23:13:55.746101 [debug] [MainThread]: Command end result
[0m23:13:55.784199 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m23:13:55.785966 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m23:13:55.792961 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m23:13:55.793284 [info ] [MainThread]: 
[0m23:13:55.793581 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:13:55.793816 [info ] [MainThread]: 
[0m23:13:55.794065 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m23:13:55.795520 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.70856, "process_in_blocks": "0", "process_kernel_time": 0.249878, "process_mem_max_rss": "158466048", "process_out_blocks": "0", "process_user_time": 2.651288}
[0m23:13:55.795827 [debug] [MainThread]: Command `dbt test` succeeded at 23:13:55.795763 after 6.71 seconds
[0m23:13:55.796106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070af5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2174f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a40700>]}
[0m23:13:55.796388 [debug] [MainThread]: Flushing usage events
[0m23:13:55.981891 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:21:03.196295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057f3640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107cb790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107cbac0>]}


============================== 23:21:03.199531 | a713c1c0-f387-4cae-8b05-e035d1057504 ==============================
[0m23:21:03.199531 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:21:03.199915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'debug': 'False', 'quiet': 'False', 'introspect': 'True', 'fail_fast': 'False', 'write_json': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'empty': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'profiles_dir': '/Users/luc/.dbt', 'invocation_command': 'dbt run --select dim_youtube_videos', 'partial_parse': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'warn_error': 'None'}
[0m23:21:03.536341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a713c1c0-f387-4cae-8b05-e035d1057504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c136a0>]}
[0m23:21:03.571162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a713c1c0-f387-4cae-8b05-e035d1057504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b3ca90>]}
[0m23:21:03.571694 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:21:03.671118 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:21:03.771701 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:21:03.772032 [debug] [MainThread]: Partial parsing: added file: youtube_dbt_project://models/marts/dim_youtube_videos.sql
[0m23:21:03.936270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a713c1c0-f387-4cae-8b05-e035d1057504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114012130>]}
[0m23:21:03.998198 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m23:21:03.999644 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m23:21:04.010679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a713c1c0-f387-4cae-8b05-e035d1057504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d0f340>]}
[0m23:21:04.010992 [info ] [MainThread]: Found 3 models, 2 data tests, 1 source, 477 macros
[0m23:21:04.011184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a713c1c0-f387-4cae-8b05-e035d1057504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114099d00>]}
[0m23:21:04.011815 [info ] [MainThread]: 
[0m23:21:04.012008 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:21:04.012160 [info ] [MainThread]: 
[0m23:21:04.012437 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:21:04.012873 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m23:21:04.021013 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m23:21:04.021209 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m23:21:04.021375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:21:05.476860 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.455 seconds
[0m23:21:05.480771 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m23:21:05.692297 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now create_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m23:21:05.693355 [debug] [ThreadPool]: Creating schema "database: "MAGPIE_FINAL_PROJECT"
schema: "STAGING_STAGING_MARTS"
"
[0m23:21:05.701268 [debug] [ThreadPool]: Using snowflake connection "create_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m23:21:05.701859 [debug] [ThreadPool]: On create_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "create_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
create schema if not exists MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS
[0m23:21:05.702286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:21:06.851348 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.149 seconds
[0m23:21:06.854564 [debug] [ThreadPool]: On create_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m23:21:07.053024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m23:21:07.070044 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m23:21:07.070575 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m23:21:07.070985 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:21:08.245055 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.174 seconds
[0m23:21:08.249674 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m23:21:08.447834 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m23:21:08.454123 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m23:21:08.454731 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m23:21:08.455230 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:21:09.623819 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.168 seconds
[0m23:21:09.628394 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m23:21:09.808857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m23:21:09.815142 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m23:21:09.815745 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS limit 10000
[0m23:21:09.816423 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:21:10.709049 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.892 seconds
[0m23:21:10.714250 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m23:21:10.902705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a713c1c0-f387-4cae-8b05-e035d1057504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114143fa0>]}
[0m23:21:10.908055 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.dim_youtube_videos
[0m23:21:10.909050 [info ] [Thread-1  ]: 1 of 1 START sql view model STAGING_STAGING_MARTS.dim_youtube_videos ........... [RUN]
[0m23:21:10.909831 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now model.youtube_dbt_project.dim_youtube_videos)
[0m23:21:10.910442 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.dim_youtube_videos
[0m23:21:10.926115 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.dim_youtube_videos"
[0m23:21:10.927383 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.dim_youtube_videos
[0m23:21:10.957191 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.dim_youtube_videos"
[0m23:21:10.959025 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.dim_youtube_videos"
[0m23:21:10.959397 [debug] [Thread-1  ]: On model.youtube_dbt_project.dim_youtube_videos: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.dim_youtube_videos"} */
create or replace   view MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS.dim_youtube_videos
  
   as (
    

with source as (

    select
        video_id,
        country,
        title,
        channel_title,
        category_id,
        publish_ts,
        tags,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos

),

dedup as (

    select
        video_id,
        country,
        title,
        channel_title,
        category_id,
        publish_ts,
        tags,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed,
        row_number() over (
            partition by video_id, country
            order by publish_ts
        ) as rn
    from source
)

select
    video_id,
    country,
    title,
    channel_title,
    category_id,
    publish_ts,
    tags,
    comments_disabled,
    ratings_disabled,
    video_error_or_removed
from dedup
where rn = 1
;
[0m23:21:10.959728 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:21:11.747512 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e261-0307-33da-000e-9ce300bc5826
[0m23:21:11.748147 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 56 at position 0 unexpected ';'.
[0m23:21:11.748723 [debug] [Thread-1  ]: On model.youtube_dbt_project.dim_youtube_videos: Close
[0m23:21:12.600048 [debug] [Thread-1  ]: Database Error in model dim_youtube_videos (models/marts/dim_youtube_videos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 56 at position 0 unexpected ';'.
  compiled code at target/run/youtube_dbt_project/models/marts/dim_youtube_videos.sql
[0m23:21:12.602989 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a713c1c0-f387-4cae-8b05-e035d1057504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11584c850>]}
[0m23:21:12.603803 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model STAGING_STAGING_MARTS.dim_youtube_videos .. [[31mERROR[0m in 1.69s]
[0m23:21:12.604489 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.dim_youtube_videos
[0m23:21:12.605050 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.dim_youtube_videos' to be skipped because of status 'error'.  Reason: Database Error in model dim_youtube_videos (models/marts/dim_youtube_videos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 56 at position 0 unexpected ';'.
  compiled code at target/run/youtube_dbt_project/models/marts/dim_youtube_videos.sql.
[0m23:21:12.606246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:21:12.606629 [debug] [MainThread]: Connection 'model.youtube_dbt_project.dim_youtube_videos' was properly closed.
[0m23:21:12.606971 [info ] [MainThread]: 
[0m23:21:12.607317 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.59 seconds (8.59s).
[0m23:21:12.608054 [debug] [MainThread]: Command end result
[0m23:21:12.636884 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m23:21:12.638731 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m23:21:12.643856 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m23:21:12.644108 [info ] [MainThread]: 
[0m23:21:12.644381 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:21:12.644602 [info ] [MainThread]: 
[0m23:21:12.644866 [error] [MainThread]: [31mFailure in model dim_youtube_videos (models/marts/dim_youtube_videos.sql)[0m
[0m23:21:12.645126 [error] [MainThread]:   Database Error in model dim_youtube_videos (models/marts/dim_youtube_videos.sql)
  001003 (42000): SQL compilation error:
  syntax error line 56 at position 0 unexpected ';'.
  compiled code at target/run/youtube_dbt_project/models/marts/dim_youtube_videos.sql
[0m23:21:12.645323 [info ] [MainThread]: 
[0m23:21:12.645563 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/marts/dim_youtube_videos.sql
[0m23:21:12.645755 [info ] [MainThread]: 
[0m23:21:12.645969 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m23:21:12.647878 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.497316, "process_in_blocks": "0", "process_kernel_time": 0.345774, "process_mem_max_rss": "162332672", "process_out_blocks": "0", "process_user_time": 3.377921}
[0m23:21:12.648159 [debug] [MainThread]: Command `dbt run` failed at 23:21:12.648099 after 9.50 seconds
[0m23:21:12.648405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057f3640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d0f3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a9bf10>]}
[0m23:21:12.648645 [debug] [MainThread]: Flushing usage events
[0m23:21:12.993363 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:21:40.684878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cc7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d64700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d64a30>]}


============================== 23:21:40.687631 | a6da706d-4137-416b-a768-b3de61074af2 ==============================
[0m23:21:40.687631 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:21:40.688025 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'version_check': 'True', 'log_format': 'default', 'use_colors': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'write_json': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'invocation_command': 'dbt run --select dim_youtube_videos', 'empty': 'False', 'static_parser': 'True', 'debug': 'False', 'target_path': 'None', 'printer_width': '80', 'introspect': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'profiles_dir': '/Users/luc/.dbt'}
[0m23:21:41.018904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6da706d-4137-416b-a768-b3de61074af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10467cb50>]}
[0m23:21:41.053851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6da706d-4137-416b-a768-b3de61074af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10601c520>]}
[0m23:21:41.054375 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:21:41.153504 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:21:41.251666 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:21:41.252033 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/marts/dim_youtube_videos.sql
[0m23:21:41.415703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6da706d-4137-416b-a768-b3de61074af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10867a130>]}
[0m23:21:41.476371 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m23:21:41.477949 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m23:21:41.488519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6da706d-4137-416b-a768-b3de61074af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10867a0a0>]}
[0m23:21:41.488811 [info ] [MainThread]: Found 3 models, 2 data tests, 1 source, 477 macros
[0m23:21:41.489003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6da706d-4137-416b-a768-b3de61074af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086de580>]}
[0m23:21:41.489633 [info ] [MainThread]: 
[0m23:21:41.489819 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:21:41.489970 [info ] [MainThread]: 
[0m23:21:41.490240 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:21:41.490681 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m23:21:41.498785 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m23:21:41.498980 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m23:21:41.499148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:21:42.930676 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.431 seconds
[0m23:21:42.934905 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m23:21:43.144168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m23:21:43.160021 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m23:21:43.160534 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m23:21:43.160963 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:21:44.242910 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.082 seconds
[0m23:21:44.247542 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m23:21:44.430176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m23:21:44.436752 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m23:21:44.437535 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS limit 10000
[0m23:21:44.438034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:21:45.694091 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.256 seconds
[0m23:21:45.698356 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m23:21:45.885037 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m23:21:45.891735 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m23:21:45.892361 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m23:21:45.892849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:21:47.029329 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.136 seconds
[0m23:21:47.034253 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m23:21:47.215526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6da706d-4137-416b-a768-b3de61074af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e8b50>]}
[0m23:21:47.220421 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.dim_youtube_videos
[0m23:21:47.221334 [info ] [Thread-1  ]: 1 of 1 START sql view model STAGING_STAGING_MARTS.dim_youtube_videos ........... [RUN]
[0m23:21:47.222057 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now model.youtube_dbt_project.dim_youtube_videos)
[0m23:21:47.222636 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.dim_youtube_videos
[0m23:21:47.237427 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.dim_youtube_videos"
[0m23:21:47.238487 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.dim_youtube_videos
[0m23:21:47.268613 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.dim_youtube_videos"
[0m23:21:47.270291 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.dim_youtube_videos"
[0m23:21:47.270642 [debug] [Thread-1  ]: On model.youtube_dbt_project.dim_youtube_videos: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.dim_youtube_videos"} */
create or replace   view MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS.dim_youtube_videos
  
   as (
    

with source as (

    select
        video_id,
        country,
        title,
        channel_title,
        category_id,
        publish_ts,
        tags,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos

),

dedup as (

    select
        video_id,
        country,
        title,
        channel_title,
        category_id,
        publish_ts,
        tags,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed,
        row_number() over (
            partition by video_id, country
            order by publish_ts
        ) as rn
    from source
)

select
    video_id,
    country,
    title,
    channel_title,
    category_id,
    publish_ts,
    tags,
    comments_disabled,
    ratings_disabled,
    video_error_or_removed
from dedup
where rn = 1
  );
[0m23:21:47.270964 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:21:48.243773 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e261-0307-3709-000e-9ce300bc0da6
[0m23:21:48.245031 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 14 at position 8
invalid identifier 'PUBLISH_TS'
[0m23:21:48.245685 [debug] [Thread-1  ]: On model.youtube_dbt_project.dim_youtube_videos: Close
[0m23:21:48.447966 [debug] [Thread-1  ]: Database Error in model dim_youtube_videos (models/marts/dim_youtube_videos.sql)
  000904 (42000): SQL compilation error: error line 14 at position 8
  invalid identifier 'PUBLISH_TS'
  compiled code at target/run/youtube_dbt_project/models/marts/dim_youtube_videos.sql
[0m23:21:48.451345 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6da706d-4137-416b-a768-b3de61074af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f6d1c0>]}
[0m23:21:48.452266 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model STAGING_STAGING_MARTS.dim_youtube_videos .. [[31mERROR[0m in 1.23s]
[0m23:21:48.452956 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.dim_youtube_videos
[0m23:21:48.453583 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.dim_youtube_videos' to be skipped because of status 'error'.  Reason: Database Error in model dim_youtube_videos (models/marts/dim_youtube_videos.sql)
  000904 (42000): SQL compilation error: error line 14 at position 8
  invalid identifier 'PUBLISH_TS'
  compiled code at target/run/youtube_dbt_project/models/marts/dim_youtube_videos.sql.
[0m23:21:48.454786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:21:48.455121 [debug] [MainThread]: Connection 'model.youtube_dbt_project.dim_youtube_videos' was properly closed.
[0m23:21:48.455444 [info ] [MainThread]: 
[0m23:21:48.455791 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.97 seconds (6.97s).
[0m23:21:48.456526 [debug] [MainThread]: Command end result
[0m23:21:48.486540 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m23:21:48.488054 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m23:21:48.493608 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m23:21:48.493851 [info ] [MainThread]: 
[0m23:21:48.494118 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:21:48.494343 [info ] [MainThread]: 
[0m23:21:48.494610 [error] [MainThread]: [31mFailure in model dim_youtube_videos (models/marts/dim_youtube_videos.sql)[0m
[0m23:21:48.494872 [error] [MainThread]:   Database Error in model dim_youtube_videos (models/marts/dim_youtube_videos.sql)
  000904 (42000): SQL compilation error: error line 14 at position 8
  invalid identifier 'PUBLISH_TS'
  compiled code at target/run/youtube_dbt_project/models/marts/dim_youtube_videos.sql
[0m23:21:48.495071 [info ] [MainThread]: 
[0m23:21:48.495310 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/marts/dim_youtube_videos.sql
[0m23:21:48.495499 [info ] [MainThread]: 
[0m23:21:48.495712 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m23:21:48.497395 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.8570533, "process_in_blocks": "0", "process_kernel_time": 0.325516, "process_mem_max_rss": "165822464", "process_out_blocks": "0", "process_user_time": 3.090337}
[0m23:21:48.497670 [debug] [MainThread]: Command `dbt run` failed at 23:21:48.497610 after 7.86 seconds
[0m23:21:48.497912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cc7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10867ad30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df24c0>]}
[0m23:21:48.498155 [debug] [MainThread]: Flushing usage events
[0m23:21:48.683162 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:26:40.281492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107068640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081036a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081039d0>]}


============================== 23:26:40.284650 | d3f669cc-21fb-40a4-9613-179a75436ceb ==============================
[0m23:26:40.284650 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:26:40.285020 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'static_parser': 'True', 'use_colors': 'True', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'profiles_dir': '/Users/luc/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'write_json': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run --select stg_youtube_videos dim_youtube_videos', 'no_print': 'None', 'debug': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'printer_width': '80'}
[0m23:26:40.622728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3f669cc-21fb-40a4-9613-179a75436ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091985b0>]}
[0m23:26:40.657806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3f669cc-21fb-40a4-9613-179a75436ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079d47c0>]}
[0m23:26:40.658374 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:26:40.756648 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:26:40.857171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:26:40.857584 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/staging/stg_youtube_videos.sql
[0m23:26:41.104896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3f669cc-21fb-40a4-9613-179a75436ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a63edc0>]}
[0m23:26:41.205400 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m23:26:41.206784 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m23:26:41.217972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3f669cc-21fb-40a4-9613-179a75436ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5cbe50>]}
[0m23:26:41.218313 [info ] [MainThread]: Found 3 models, 2 data tests, 1 source, 477 macros
[0m23:26:41.218513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3f669cc-21fb-40a4-9613-179a75436ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6226d0>]}
[0m23:26:41.219220 [info ] [MainThread]: 
[0m23:26:41.219414 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:26:41.219570 [info ] [MainThread]: 
[0m23:26:41.219847 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:26:41.222623 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m23:26:41.230644 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m23:26:41.230840 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m23:26:41.231021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:42.603941 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.373 seconds
[0m23:26:42.608313 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m23:26:43.455457 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m23:26:43.456135 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m23:26:43.456655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:44.706551 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.250 seconds
[0m23:26:44.711081 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m23:26:44.912937 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m23:26:44.930922 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m23:26:44.931655 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS limit 10000
[0m23:26:44.932096 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:46.064538 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.132 seconds
[0m23:26:46.068573 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m23:26:46.293102 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m23:26:46.298797 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m23:26:46.299418 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m23:26:46.299898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:47.468733 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.168 seconds
[0m23:26:47.473495 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m23:26:47.721589 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m23:26:47.728357 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m23:26:47.729104 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m23:26:47.729625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:48.648436 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.918 seconds
[0m23:26:48.653135 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m23:26:48.861555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3f669cc-21fb-40a4-9613-179a75436ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109807730>]}
[0m23:26:48.866097 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.stg_youtube_videos
[0m23:26:48.867055 [info ] [Thread-1  ]: 1 of 2 START sql view model STAGING_STAGING.stg_youtube_videos ................. [RUN]
[0m23:26:48.867803 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now model.youtube_dbt_project.stg_youtube_videos)
[0m23:26:48.868406 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.stg_youtube_videos
[0m23:26:48.883383 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.stg_youtube_videos"
[0m23:26:48.884413 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.stg_youtube_videos
[0m23:26:48.916108 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.stg_youtube_videos"
[0m23:26:48.917916 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.stg_youtube_videos"
[0m23:26:48.918305 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.stg_youtube_videos"} */
create or replace   view MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
  
   as (
    

with source as (

    select
        video_id,
        trending_date       as trending_date_raw,
        title,
        channel_title,
        category_id,
        publish_time,
        tags,
        views,
        likes,
        dislikes,
        comment_count,
        country,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from MAGPIE_FINAL_PROJECT.RAW.RAW_YOUTUBE_TRENDING

),

cleaned as (

    select
        video_id,
        trending_date_raw,
        try_to_date(trending_date_raw, 'YY.DD.MM') as trending_date,
        title,
        channel_title,
        category_id,
        to_timestamp_ntz(publish_time)           as publish_ts,
        tags,
        views::number                            as views,
        likes::number                            as likes,
        dislikes::number                         as dislikes,
        comment_count::number                    as comment_count,
        country,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from source
    where try_to_date(trending_date_raw, 'YY.DD.MM') is not null

)

select *
from cleaned
  );
[0m23:26:48.918650 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:26:49.957215 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.038 seconds
[0m23:26:49.984655 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: Close
[0m23:26:50.165527 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3f669cc-21fb-40a4-9613-179a75436ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109188400>]}
[0m23:26:50.167217 [info ] [Thread-1  ]: 1 of 2 OK created sql view model STAGING_STAGING.stg_youtube_videos ............ [[32mSUCCESS 1[0m in 1.29s]
[0m23:26:50.168127 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.stg_youtube_videos
[0m23:26:50.169681 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.dim_youtube_videos
[0m23:26:50.170550 [info ] [Thread-1  ]: 2 of 2 START sql view model STAGING_STAGING_MARTS.dim_youtube_videos ........... [RUN]
[0m23:26:50.171432 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtube_dbt_project.stg_youtube_videos, now model.youtube_dbt_project.dim_youtube_videos)
[0m23:26:50.172164 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.dim_youtube_videos
[0m23:26:50.179133 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.dim_youtube_videos"
[0m23:26:50.180211 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.dim_youtube_videos
[0m23:26:50.184835 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.dim_youtube_videos"
[0m23:26:50.187375 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.dim_youtube_videos"
[0m23:26:50.187962 [debug] [Thread-1  ]: On model.youtube_dbt_project.dim_youtube_videos: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.dim_youtube_videos"} */
create or replace   view MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS.dim_youtube_videos
  
   as (
    

with source as (

    select
        video_id,
        country,
        title,
        channel_title,
        category_id,
        publish_ts,
        tags,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos

),

dedup as (

    select
        video_id,
        country,
        title,
        channel_title,
        category_id,
        publish_ts,
        tags,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed,
        row_number() over (
            partition by video_id, country
            order by publish_ts
        ) as rn
    from source
)

select
    video_id,
    country,
    title,
    channel_title,
    category_id,
    publish_ts,
    tags,
    comments_disabled,
    ratings_disabled,
    video_error_or_removed
from dedup
where rn = 1
  );
[0m23:26:50.188439 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:26:51.902306 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.714 seconds
[0m23:26:51.908787 [debug] [Thread-1  ]: On model.youtube_dbt_project.dim_youtube_videos: Close
[0m23:26:52.113723 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3f669cc-21fb-40a4-9613-179a75436ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b22ff10>]}
[0m23:26:52.115846 [info ] [Thread-1  ]: 2 of 2 OK created sql view model STAGING_STAGING_MARTS.dim_youtube_videos ...... [[32mSUCCESS 1[0m in 1.94s]
[0m23:26:52.117049 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.dim_youtube_videos
[0m23:26:52.118881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:26:52.119445 [debug] [MainThread]: Connection 'model.youtube_dbt_project.dim_youtube_videos' was properly closed.
[0m23:26:52.120059 [info ] [MainThread]: 
[0m23:26:52.120571 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 10.90 seconds (10.90s).
[0m23:26:52.121976 [debug] [MainThread]: Command end result
[0m23:26:52.162967 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m23:26:52.165540 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m23:26:52.172170 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m23:26:52.172451 [info ] [MainThread]: 
[0m23:26:52.172786 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:26:52.173055 [info ] [MainThread]: 
[0m23:26:52.173349 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m23:26:52.175668 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.941222, "process_in_blocks": "0", "process_kernel_time": 0.386335, "process_mem_max_rss": "162791424", "process_out_blocks": "0", "process_user_time": 3.709623}
[0m23:26:52.176028 [debug] [MainThread]: Command `dbt run` succeeded at 23:26:52.175958 after 11.94 seconds
[0m23:26:52.176351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107068640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a1d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a579250>]}
[0m23:26:52.176640 [debug] [MainThread]: Flushing usage events
[0m23:26:52.481302 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:31:44.645666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d3f5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dda790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ddaac0>]}


============================== 23:31:44.648951 | 003192ce-d5a8-4b9e-841f-33dd0ad834bb ==============================
[0m23:31:44.648951 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:31:44.649312 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'target_path': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'printer_width': '80', 'profiles_dir': '/Users/luc/.dbt', 'cache_selected_only': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'debug': 'False', 'warn_error': 'None', 'quiet': 'False', 'partial_parse': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'use_colors': 'True', 'no_print': 'None'}
[0m23:31:44.991427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '003192ce-d5a8-4b9e-841f-33dd0ad834bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a192c70>]}
[0m23:31:45.026457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '003192ce-d5a8-4b9e-841f-33dd0ad834bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d761c0>]}
[0m23:31:45.027076 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:31:45.128099 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:31:45.200848 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:31:45.201155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '003192ce-d5a8-4b9e-841f-33dd0ad834bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108652f40>]}
[0m23:31:45.939671 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m23:31:45.939997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '003192ce-d5a8-4b9e-841f-33dd0ad834bb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b654a30>]}
[0m23:31:45.974367 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_stg_weather_datetime.554d39b0ed' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m23:31:45.974635 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.unique_stg_weather_datetime.ea99166edf' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m23:31:45.974854 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_stg_weather_temperature_2m.4552381acc' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m23:31:45.975079 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.accepted_values_stg_weather_city__Chicago__Evanston__Aurora.3a5db1bdc4' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m23:31:45.975261 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_datetime.36fca5f850' (models/marts/schema.yml) depends on a node named 'fact_weather' which is disabled
[0m23:31:45.975429 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.unique_fact_weather_datetime.f553e65bbe' (models/marts/schema.yml) depends on a node named 'fact_weather' which is disabled
[0m23:31:45.975586 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_feels_like.cf8e8e9258' (models/marts/schema.yml) depends on a node named 'fact_weather' which is disabled
[0m23:31:45.975741 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_daily_date.b304b6aad7' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m23:31:45.976016 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.unique_fact_weather_daily_date.1ee454b4b0' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m23:31:45.976173 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_daily_avg_temperature.c0f9fdc06f' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m23:31:45.976325 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.accepted_values_fact_weather_daily_hourly_records__24.a8a2f8b558' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m23:31:46.034476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '003192ce-d5a8-4b9e-841f-33dd0ad834bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b74d130>]}
[0m23:31:46.093502 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m23:31:46.094770 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m23:31:46.106008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '003192ce-d5a8-4b9e-841f-33dd0ad834bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7577c0>]}
[0m23:31:46.106298 [info ] [MainThread]: Found 3 models, 2 data tests, 1 source, 477 macros
[0m23:31:46.106486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '003192ce-d5a8-4b9e-841f-33dd0ad834bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7aae20>]}
[0m23:31:46.107262 [info ] [MainThread]: 
[0m23:31:46.107453 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:31:46.107610 [info ] [MainThread]: 
[0m23:31:46.107873 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:31:46.110653 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m23:31:46.118363 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m23:31:46.118557 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m23:31:46.118723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:47.472786 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.354 seconds
[0m23:31:47.476599 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m23:31:48.020107 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m23:31:48.020856 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m23:31:48.021401 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:31:49.913551 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.892 seconds
[0m23:31:49.916835 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m23:31:50.128962 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m23:31:50.129629 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m23:31:50.130133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:31:51.330177 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.200 seconds
[0m23:31:51.334425 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m23:31:51.506264 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m23:31:51.523692 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m23:31:51.524219 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS limit 10000
[0m23:31:51.524629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:31:52.664531 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.140 seconds
[0m23:31:52.668587 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m23:31:52.859291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m23:31:52.866196 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m23:31:52.868292 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m23:31:52.868796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:31:53.775194 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.906 seconds
[0m23:31:53.779767 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m23:31:53.967035 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m23:31:53.976194 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m23:31:53.976947 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m23:31:53.977447 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:31:54.853950 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.876 seconds
[0m23:31:54.857979 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m23:31:55.050568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '003192ce-d5a8-4b9e-841f-33dd0ad834bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b59fee0>]}
[0m23:31:55.054755 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.dim_city
[0m23:31:55.055757 [info ] [Thread-1  ]: 1 of 3 START sql view model STAGING_MARTS.dim_city ............................. [RUN]
[0m23:31:55.056524 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now model.youtube_dbt_project.dim_city)
[0m23:31:55.057114 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.dim_city
[0m23:31:55.069713 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.dim_city"
[0m23:31:55.070915 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.dim_city
[0m23:31:55.102627 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.dim_city"
[0m23:31:55.103841 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.dim_city"
[0m23:31:55.104199 [debug] [Thread-1  ]: On model.youtube_dbt_project.dim_city: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.dim_city"} */
create or replace   view MAGPIE_FINAL_PROJECT.STAGING_MARTS.dim_city
  
   as (
    -- models/marts/dim_city.sql

SELECT
    'Chicago' AS city,
    41.8781 AS latitude,
    -87.6298 AS longitude,
    'America/Chicago' AS timezone
  );
[0m23:31:55.104514 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:31:56.085887 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.981 seconds
[0m23:31:56.123284 [debug] [Thread-1  ]: On model.youtube_dbt_project.dim_city: Close
[0m23:31:56.326554 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '003192ce-d5a8-4b9e-841f-33dd0ad834bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a06b4c0>]}
[0m23:31:56.327810 [info ] [Thread-1  ]: 1 of 3 OK created sql view model STAGING_MARTS.dim_city ........................ [[32mSUCCESS 1[0m in 1.27s]
[0m23:31:56.328787 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.dim_city
[0m23:31:56.329454 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.stg_youtube_videos
[0m23:31:56.330325 [info ] [Thread-1  ]: 2 of 3 START sql view model STAGING_STAGING.stg_youtube_videos ................. [RUN]
[0m23:31:56.331186 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtube_dbt_project.dim_city, now model.youtube_dbt_project.stg_youtube_videos)
[0m23:31:56.331812 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.stg_youtube_videos
[0m23:31:56.337740 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.stg_youtube_videos"
[0m23:31:56.338933 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.stg_youtube_videos
[0m23:31:56.343341 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.stg_youtube_videos"
[0m23:31:56.346055 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.stg_youtube_videos"
[0m23:31:56.346578 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.stg_youtube_videos"} */
create or replace   view MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
  
   as (
    

with source as (

    select
        video_id,
        trending_date       as trending_date_raw,
        title,
        channel_title,
        category_id,
        publish_time,
        tags,
        views,
        likes,
        dislikes,
        comment_count,
        country,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from MAGPIE_FINAL_PROJECT.RAW.RAW_YOUTUBE_TRENDING

),

cleaned as (

    select
        video_id,
        trending_date_raw,
        try_to_date(trending_date_raw, 'YY.DD.MM') as trending_date,
        title,
        channel_title,
        category_id,
        to_timestamp_ntz(publish_time)           as publish_ts,
        tags,
        views::number                            as views,
        likes::number                            as likes,
        dislikes::number                         as dislikes,
        comment_count::number                    as comment_count,
        country,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from source
    where try_to_date(trending_date_raw, 'YY.DD.MM') is not null

)

select *
from cleaned
  );
[0m23:31:56.347074 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:31:57.484108 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.137 seconds
[0m23:31:57.490673 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: Close
[0m23:31:57.793297 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '003192ce-d5a8-4b9e-841f-33dd0ad834bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106606a90>]}
[0m23:31:57.794987 [info ] [Thread-1  ]: 2 of 3 OK created sql view model STAGING_STAGING.stg_youtube_videos ............ [[32mSUCCESS 1[0m in 1.46s]
[0m23:31:57.796277 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.stg_youtube_videos
[0m23:31:57.797430 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.dim_youtube_videos
[0m23:31:57.798319 [info ] [Thread-1  ]: 3 of 3 START sql view model STAGING_STAGING_MARTS.dim_youtube_videos ........... [RUN]
[0m23:31:57.799150 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtube_dbt_project.stg_youtube_videos, now model.youtube_dbt_project.dim_youtube_videos)
[0m23:31:57.799773 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.dim_youtube_videos
[0m23:31:57.806515 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.dim_youtube_videos"
[0m23:31:57.807544 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.dim_youtube_videos
[0m23:31:57.812042 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.dim_youtube_videos"
[0m23:31:57.814466 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.dim_youtube_videos"
[0m23:31:57.815048 [debug] [Thread-1  ]: On model.youtube_dbt_project.dim_youtube_videos: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.dim_youtube_videos"} */
create or replace   view MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS.dim_youtube_videos
  
   as (
    

with source as (

    select
        video_id,
        country,
        title,
        channel_title,
        category_id,
        publish_ts,
        tags,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos

),

dedup as (

    select
        video_id,
        country,
        title,
        channel_title,
        category_id,
        publish_ts,
        tags,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed,
        row_number() over (
            partition by video_id, country
            order by publish_ts
        ) as rn
    from source
)

select
    video_id,
    country,
    title,
    channel_title,
    category_id,
    publish_ts,
    tags,
    comments_disabled,
    ratings_disabled,
    video_error_or_removed
from dedup
where rn = 1
  );
[0m23:31:57.815586 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:31:58.902488 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.086 seconds
[0m23:31:58.908073 [debug] [Thread-1  ]: On model.youtube_dbt_project.dim_youtube_videos: Close
[0m23:31:59.103584 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '003192ce-d5a8-4b9e-841f-33dd0ad834bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e491fa0>]}
[0m23:31:59.105389 [info ] [Thread-1  ]: 3 of 3 OK created sql view model STAGING_STAGING_MARTS.dim_youtube_videos ...... [[32mSUCCESS 1[0m in 1.30s]
[0m23:31:59.106917 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.dim_youtube_videos
[0m23:31:59.108781 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:31:59.109332 [debug] [MainThread]: Connection 'model.youtube_dbt_project.dim_youtube_videos' was properly closed.
[0m23:31:59.109914 [info ] [MainThread]: 
[0m23:31:59.110427 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 13.00 seconds (13.00s).
[0m23:31:59.111927 [debug] [MainThread]: Command end result
[0m23:31:59.149968 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m23:31:59.151842 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m23:31:59.158333 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m23:31:59.158590 [info ] [MainThread]: 
[0m23:31:59.158875 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:31:59.159101 [info ] [MainThread]: 
[0m23:31:59.159355 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m23:31:59.159769 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:31:59.161664 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.568388, "process_in_blocks": "0", "process_kernel_time": 0.37306, "process_mem_max_rss": "164003840", "process_out_blocks": "0", "process_user_time": 4.907986}
[0m23:31:59.161974 [debug] [MainThread]: Command `dbt run` succeeded at 23:31:59.161905 after 14.57 seconds
[0m23:31:59.162256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d3f5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a165c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7579a0>]}
[0m23:31:59.162536 [debug] [MainThread]: Flushing usage events
[0m23:31:59.506889 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:02:10.395873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a2b5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ac76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ac7a00>]}


============================== 00:02:10.399106 | 7e9ca8d0-ed53-403e-b1e4-f2a1061ce2c1 ==============================
[0m00:02:10.399106 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:02:10.399452 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --select stg_youtube_videos dim_youtube_videos', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'static_parser': 'True', 'profiles_dir': '/Users/luc/.dbt', 'target_path': 'None', 'no_print': 'None', 'quiet': 'False', 'fail_fast': 'False', 'version_check': 'True', 'write_json': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True'}
[0m00:02:10.746979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e9ca8d0-ed53-403e-b1e4-f2a1061ce2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c3e910>]}
[0m00:02:10.782015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e9ca8d0-ed53-403e-b1e4-f2a1061ce2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b5d2b0>]}
[0m00:02:10.782712 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:02:10.888486 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:02:10.990779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:02:10.991168 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/marts/dim_youtube_videos.sql
[0m00:02:10.991411 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/staging/stg_youtube_videos.sql
[0m00:02:11.238556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e9ca8d0-ed53-403e-b1e4-f2a1061ce2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c193130>]}
[0m00:02:11.302752 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m00:02:11.304329 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m00:02:11.353102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e9ca8d0-ed53-403e-b1e4-f2a1061ce2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aff5130>]}
[0m00:02:11.353440 [info ] [MainThread]: Found 3 models, 2 data tests, 1 source, 477 macros
[0m00:02:11.353628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e9ca8d0-ed53-403e-b1e4-f2a1061ce2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1189a0>]}
[0m00:02:11.354298 [info ] [MainThread]: 
[0m00:02:11.354487 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:02:11.354642 [info ] [MainThread]: 
[0m00:02:11.354911 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:02:11.357688 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m00:02:11.365551 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m00:02:11.365744 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m00:02:11.365909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:02:12.940618 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.575 seconds
[0m00:02:12.943984 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m00:02:13.398078 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m00:02:13.398687 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m00:02:13.399125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:02:14.907782 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.508 seconds
[0m00:02:14.911956 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m00:02:15.329249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m00:02:15.347723 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m00:02:15.348337 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m00:02:15.348748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:02:17.167824 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.819 seconds
[0m00:02:17.172697 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m00:02:17.853928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m00:02:17.861249 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m00:02:17.861874 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m00:02:17.862358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:02:20.621425 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.758 seconds
[0m00:02:20.628820 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m00:02:20.867984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e9ca8d0-ed53-403e-b1e4-f2a1061ce2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1189a0>]}
[0m00:02:20.871800 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.stg_youtube_videos
[0m00:02:20.872377 [info ] [Thread-1  ]: 1 of 2 START sql view model STAGING_STAGING.stg_youtube_videos ................. [RUN]
[0m00:02:20.872713 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now model.youtube_dbt_project.stg_youtube_videos)
[0m00:02:20.872960 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.stg_youtube_videos
[0m00:02:20.882111 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.stg_youtube_videos"
[0m00:02:20.883095 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.stg_youtube_videos
[0m00:02:20.900525 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.stg_youtube_videos"
[0m00:02:20.901799 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.stg_youtube_videos"
[0m00:02:20.902054 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.stg_youtube_videos"} */
create or replace   view MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
  
   as (
    

with source as (

    select
        video_id,
        country,
        title,
        channel_title,
        category_id,
        trending_date,
        publish_time,
        tags,
        views,
        likes,
        dislikes,
        comment_count,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from MAGPIE_FINAL_PROJECT.RAW.RAW_YOUTUBE_TRENDING

),

cleaned as (

    select
        video_id,
        country,
        title,
        channel_title,
        category_id,
        try_to_date(trending_date, 'YY.DD.MM') as trending_date,
        try_to_timestamp_ntz(publish_time)      as publish_ts,
        tags,
        views::number            as views,
        likes::number            as likes,
        dislikes::number         as dislikes,
        comment_count::number    as comment_count,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from source

)

select * from cleaned
  );
[0m00:02:20.902287 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:02:22.066610 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.164 seconds
[0m00:02:22.105131 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: Close
[0m00:02:22.317710 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e9ca8d0-ed53-403e-b1e4-f2a1061ce2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc903d0>]}
[0m00:02:22.318434 [info ] [Thread-1  ]: 1 of 2 OK created sql view model STAGING_STAGING.stg_youtube_videos ............ [[32mSUCCESS 1[0m in 1.44s]
[0m00:02:22.318873 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.stg_youtube_videos
[0m00:02:22.319475 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.dim_youtube_videos
[0m00:02:22.319926 [info ] [Thread-1  ]: 2 of 2 START sql view model STAGING_MARTS.dim_youtube_videos ................... [RUN]
[0m00:02:22.320333 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.youtube_dbt_project.stg_youtube_videos, now model.youtube_dbt_project.dim_youtube_videos)
[0m00:02:22.320614 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.dim_youtube_videos
[0m00:02:22.323418 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.dim_youtube_videos"
[0m00:02:22.324158 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.dim_youtube_videos
[0m00:02:22.327246 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.dim_youtube_videos"
[0m00:02:22.328105 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.dim_youtube_videos"
[0m00:02:22.328391 [debug] [Thread-1  ]: On model.youtube_dbt_project.dim_youtube_videos: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.dim_youtube_videos"} */
create or replace   view MAGPIE_FINAL_PROJECT.STAGING_MARTS.dim_youtube_videos
  
   as (
    

select
    video_id,
    country,
    title,
    channel_title,
    category_id,
    trending_date,
    publish_ts,
    tags,
    comments_disabled,
    ratings_disabled,
    video_error_or_removed
from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
  );
[0m00:02:22.328651 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:02:23.825820 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.497 seconds
[0m00:02:23.832483 [debug] [Thread-1  ]: On model.youtube_dbt_project.dim_youtube_videos: Close
[0m00:02:24.286457 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e9ca8d0-ed53-403e-b1e4-f2a1061ce2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccd6d30>]}
[0m00:02:24.288102 [info ] [Thread-1  ]: 2 of 2 OK created sql view model STAGING_MARTS.dim_youtube_videos .............. [[32mSUCCESS 1[0m in 1.97s]
[0m00:02:24.289457 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.dim_youtube_videos
[0m00:02:24.292483 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:02:24.293023 [debug] [MainThread]: Connection 'model.youtube_dbt_project.dim_youtube_videos' was properly closed.
[0m00:02:24.293631 [info ] [MainThread]: 
[0m00:02:24.294173 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 12.94 seconds (12.94s).
[0m00:02:24.295491 [debug] [MainThread]: Command end result
[0m00:02:24.333751 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m00:02:24.336055 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m00:02:24.342530 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m00:02:24.342836 [info ] [MainThread]: 
[0m00:02:24.343140 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:02:24.343365 [info ] [MainThread]: 
[0m00:02:24.343640 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m00:02:24.345799 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.996903, "process_in_blocks": "0", "process_kernel_time": 0.391696, "process_mem_max_rss": "160464896", "process_out_blocks": "0", "process_user_time": 3.425228}
[0m00:02:24.346146 [debug] [MainThread]: Command `dbt run` succeeded at 00:02:24.346080 after 14.00 seconds
[0m00:02:24.346445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a2b5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061bc1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afecbe0>]}
[0m00:02:24.346727 [debug] [MainThread]: Flushing usage events
[0m00:02:24.632365 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:25:06.858470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b075b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba36a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba39d0>]}


============================== 00:25:06.861696 | 0a285bc5-8d2e-453d-ad57-a23baaf71dcd ==============================
[0m00:25:06.861696 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:25:06.862064 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'printer_width': '80', 'warn_error': 'None', 'version_check': 'True', 'target_path': 'None', 'introspect': 'True', 'log_format': 'default', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select fct_youtube_daily', 'profiles_dir': '/Users/luc/.dbt', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'empty': 'False', 'use_colors': 'True', 'write_json': 'True', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'quiet': 'False', 'no_print': 'None'}
[0m00:25:07.204464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a285bc5-8d2e-453d-ad57-a23baaf71dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d5b490>]}
[0m00:25:07.239530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a285bc5-8d2e-453d-ad57-a23baaf71dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049cee20>]}
[0m00:25:07.240015 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:25:07.339171 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:25:07.439952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:25:07.440314 [debug] [MainThread]: Partial parsing: added file: youtube_dbt_project://models/marts/fct_youtube_daily.sql
[0m00:25:07.605875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a285bc5-8d2e-453d-ad57-a23baaf71dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106474130>]}
[0m00:25:07.669667 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m00:25:07.671367 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m00:25:07.681860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a285bc5-8d2e-453d-ad57-a23baaf71dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064602b0>]}
[0m00:25:07.682156 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m00:25:07.682352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a285bc5-8d2e-453d-ad57-a23baaf71dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106462fd0>]}
[0m00:25:07.682979 [info ] [MainThread]: 
[0m00:25:07.683188 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:25:07.683345 [info ] [MainThread]: 
[0m00:25:07.683613 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:25:07.684069 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m00:25:07.691961 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m00:25:07.692167 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m00:25:07.692337 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:25:09.220356 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.528 seconds
[0m00:25:09.224318 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m00:25:09.510055 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now create_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS)
[0m00:25:09.511209 [debug] [ThreadPool]: Creating schema "database: "MAGPIE_FINAL_PROJECT"
schema: "STAGING_STAGING_STAGING_MARTS"
"
[0m00:25:09.521730 [debug] [ThreadPool]: Using snowflake connection "create_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS"
[0m00:25:09.522477 [debug] [ThreadPool]: On create_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "create_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS"} */
create schema if not exists MAGPIE_FINAL_PROJECT.STAGING_STAGING_STAGING_MARTS
[0m00:25:09.523015 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:25:10.758769 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.236 seconds
[0m00:25:10.761227 [debug] [ThreadPool]: On create_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS: Close
[0m00:25:10.979487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m00:25:10.992013 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m00:25:10.992387 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m00:25:10.992601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:25:12.158039 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.165 seconds
[0m00:25:12.162010 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m00:25:12.462038 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m00:25:12.469341 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m00:25:12.470050 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m00:25:12.470540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:25:13.870915 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.400 seconds
[0m00:25:13.875857 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m00:25:15.509538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS)
[0m00:25:15.517253 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS"
[0m00:25:15.517873 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_STAGING_MARTS limit 10000
[0m00:25:15.518356 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:25:16.336377 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.818 seconds
[0m00:25:16.340577 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS: Close
[0m00:25:16.527867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a285bc5-8d2e-453d-ad57-a23baaf71dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d08040>]}
[0m00:25:16.532880 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fct_youtube_daily
[0m00:25:16.533829 [info ] [Thread-1  ]: 1 of 1 START sql view model STAGING_STAGING_STAGING_MARTS.fct_youtube_daily .... [RUN]
[0m00:25:16.534581 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS, now model.youtube_dbt_project.fct_youtube_daily)
[0m00:25:16.535184 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.fct_youtube_daily
[0m00:25:16.549567 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.fct_youtube_daily"
[0m00:25:16.550887 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.fct_youtube_daily
[0m00:25:16.581581 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.fct_youtube_daily"
[0m00:25:16.583066 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.fct_youtube_daily"
[0m00:25:16.583415 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.fct_youtube_daily"} */
create or replace   view MAGPIE_FINAL_PROJECT.STAGING_STAGING_STAGING_MARTS.fct_youtube_daily
  
   as (
    

with base as (

    select
        video_id,
        country,
        trending_date,
        category_id,
        title,
        channel_title,
        publish_ts::date as publish_date,
        views,
        likes,
        dislikes,
        comment_count
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos

),

daily as (

    select
        country,
        trending_date,
        category_id,
        count(distinct video_id) as num_videos,
        sum(views) as total_views,
        sum(likes) as total_likes,
        sum(dislikes) as total_dislikes,
        sum(comment_count) as total_comments
    from base
    group by country, trending_date, category_id

)

select * from daily
  );
[0m00:25:16.583732 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:25:17.849769 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.266 seconds
[0m00:25:17.884828 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: Close
[0m00:25:18.126424 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a285bc5-8d2e-453d-ad57-a23baaf71dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c284f0>]}
[0m00:25:18.127792 [info ] [Thread-1  ]: 1 of 1 OK created sql view model STAGING_STAGING_STAGING_MARTS.fct_youtube_daily  [[32mSUCCESS 1[0m in 1.59s]
[0m00:25:18.128762 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fct_youtube_daily
[0m00:25:18.130444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:25:18.130977 [debug] [MainThread]: Connection 'model.youtube_dbt_project.fct_youtube_daily' was properly closed.
[0m00:25:18.131460 [info ] [MainThread]: 
[0m00:25:18.131953 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.45 seconds (10.45s).
[0m00:25:18.132995 [debug] [MainThread]: Command end result
[0m00:25:18.170218 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m00:25:18.171984 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m00:25:18.178134 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m00:25:18.178401 [info ] [MainThread]: 
[0m00:25:18.178702 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:25:18.178928 [info ] [MainThread]: 
[0m00:25:18.179172 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:25:18.181109 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.370537, "process_in_blocks": "0", "process_kernel_time": 0.35569, "process_mem_max_rss": "159924224", "process_out_blocks": "0", "process_user_time": 3.400299}
[0m00:25:18.181423 [debug] [MainThread]: Command `dbt run` succeeded at 00:25:18.181353 after 11.37 seconds
[0m00:25:18.181703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b075b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022981c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106460190>]}
[0m00:25:18.181987 [debug] [MainThread]: Flushing usage events
[0m00:25:18.493545 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:27:55.018187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082c0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a697280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6975b0>]}


============================== 00:27:55.021376 | 6d155d37-2510-436c-9e22-6fdb2a1c86d5 ==============================
[0m00:27:55.021376 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:27:55.021744 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'warn_error': 'None', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'invocation_command': 'dbt ls', 'quiet': 'False', 'profiles_dir': '/Users/luc/.dbt', 'no_print': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'use_colors': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'version_check': 'True', 'static_parser': 'True'}
[0m00:27:55.370563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d155d37-2510-436c-9e22-6fdb2a1c86d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd02940>]}
[0m00:27:55.405606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d155d37-2510-436c-9e22-6fdb2a1c86d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4bbc70>]}
[0m00:27:55.406284 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:27:55.506964 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:27:55.608862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:27:55.609122 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:27:55.642565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d155d37-2510-436c-9e22-6fdb2a1c86d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cce2130>]}
[0m00:27:55.708189 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m00:27:55.709522 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m00:27:55.719253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d155d37-2510-436c-9e22-6fdb2a1c86d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cce2760>]}
[0m00:27:55.719554 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m00:27:55.719749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d155d37-2510-436c-9e22-6fdb2a1c86d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd08940>]}
[0m00:27:55.720213 [info ] [MainThread]: youtube_dbt_project.marts.dim_city
[0m00:27:55.720401 [info ] [MainThread]: youtube_dbt_project.marts.dim_youtube_videos
[0m00:27:55.720551 [info ] [MainThread]: youtube_dbt_project.marts.fct_youtube_daily
[0m00:27:55.720697 [info ] [MainThread]: youtube_dbt_project.staging.stg_youtube_videos
[0m00:27:55.720843 [info ] [MainThread]: source:youtube_dbt_project.raw.RAW_YOUTUBE_TRENDING
[0m00:27:55.720985 [info ] [MainThread]: youtube_dbt_project.not_null_stg_youtube_videos_trending_date
[0m00:27:55.721123 [info ] [MainThread]: youtube_dbt_project.not_null_stg_youtube_videos_video_id
[0m00:27:55.722399 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.7498315, "process_in_blocks": "0", "process_kernel_time": 0.240881, "process_mem_max_rss": "133218304", "process_out_blocks": "0", "process_user_time": 1.273196}
[0m00:27:55.722626 [debug] [MainThread]: Command `dbt ls` succeeded at 00:27:55.722572 after 0.75 seconds
[0m00:27:55.722825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082c0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd08c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd08310>]}
[0m00:27:55.723013 [debug] [MainThread]: Flushing usage events
[0m00:27:55.976754 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:28:13.228923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a8b5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b276a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b279d0>]}


============================== 00:28:13.231855 | e15010a6-19bc-4612-acef-addbaf544f7b ==============================
[0m00:28:13.231855 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:28:13.232206 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select fct_youtube_daily', 'use_colors': 'True', 'introspect': 'True', 'write_json': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'profiles_dir': '/Users/luc/.dbt', 'log_cache_events': 'False', 'printer_width': '80', 'no_print': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'target_path': 'None', 'empty': 'False', 'fail_fast': 'False', 'warn_error': 'None'}
[0m00:28:13.557838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e15010a6-19bc-4612-acef-addbaf544f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cdf490>]}
[0m00:28:13.592492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e15010a6-19bc-4612-acef-addbaf544f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106952e20>]}
[0m00:28:13.593383 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:28:13.692426 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:28:13.790317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:28:13.790573 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:28:13.823567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e15010a6-19bc-4612-acef-addbaf544f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108251130>]}
[0m00:28:13.887587 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m00:28:13.888924 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m00:28:13.899185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e15010a6-19bc-4612-acef-addbaf544f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10827b070>]}
[0m00:28:13.899481 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m00:28:13.899683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e15010a6-19bc-4612-acef-addbaf544f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6dd30>]}
[0m00:28:13.900327 [info ] [MainThread]: 
[0m00:28:13.900525 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:28:13.900680 [info ] [MainThread]: 
[0m00:28:13.900963 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:28:13.901408 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m00:28:13.910045 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m00:28:13.910238 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m00:28:13.910411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:28:15.554792 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.644 seconds
[0m00:28:15.558709 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m00:28:15.752926 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m00:28:15.768241 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m00:28:15.768762 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m00:28:15.769120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:28:16.988660 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.219 seconds
[0m00:28:16.993805 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m00:28:17.220212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS)
[0m00:28:17.227097 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS"
[0m00:28:17.227684 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_STAGING_MARTS limit 10000
[0m00:28:17.228161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:28:18.384257 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.156 seconds
[0m00:28:18.388652 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS: Close
[0m00:28:18.582253 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m00:28:18.589548 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m00:28:18.590253 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m00:28:18.590737 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:28:19.780953 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.190 seconds
[0m00:28:19.785510 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m00:28:19.968103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e15010a6-19bc-4612-acef-addbaf544f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c8d040>]}
[0m00:28:19.973348 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fct_youtube_daily
[0m00:28:19.974395 [info ] [Thread-1  ]: 1 of 1 START sql view model STAGING_STAGING_STAGING_MARTS.fct_youtube_daily .... [RUN]
[0m00:28:19.975220 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now model.youtube_dbt_project.fct_youtube_daily)
[0m00:28:19.975831 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.fct_youtube_daily
[0m00:28:19.990866 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.fct_youtube_daily"
[0m00:28:19.991940 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.fct_youtube_daily
[0m00:28:20.022727 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.fct_youtube_daily"
[0m00:28:20.024401 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.fct_youtube_daily"
[0m00:28:20.024752 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.fct_youtube_daily"} */
create or replace   view MAGPIE_FINAL_PROJECT.STAGING_STAGING_STAGING_MARTS.fct_youtube_daily
  
   as (
    

with base as (

    select
        video_id,
        country,
        trending_date,
        category_id,
        title,
        channel_title,
        publish_ts::date as publish_date,
        views,
        likes,
        dislikes,
        comment_count
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos

),

daily as (

    select
        country,
        trending_date,
        category_id,
        count(distinct video_id) as num_videos,
        sum(views) as total_views,
        sum(likes) as total_likes,
        sum(dislikes) as total_dislikes,
        sum(comment_count) as total_comments
    from base
    group by country, trending_date, category_id

)

select * from daily
  );
[0m00:28:20.025071 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:28:21.358353 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.333 seconds
[0m00:28:21.395747 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: Close
[0m00:28:21.582972 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e15010a6-19bc-4612-acef-addbaf544f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bac4f0>]}
[0m00:28:21.584893 [info ] [Thread-1  ]: 1 of 1 OK created sql view model STAGING_STAGING_STAGING_MARTS.fct_youtube_daily  [[32mSUCCESS 1[0m in 1.60s]
[0m00:28:21.586284 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fct_youtube_daily
[0m00:28:21.587976 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:28:21.588462 [debug] [MainThread]: Connection 'model.youtube_dbt_project.fct_youtube_daily' was properly closed.
[0m00:28:21.588927 [info ] [MainThread]: 
[0m00:28:21.589413 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.69 seconds (7.69s).
[0m00:28:21.590452 [debug] [MainThread]: Command end result
[0m00:28:21.627617 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m00:28:21.629386 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m00:28:21.635545 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m00:28:21.635855 [info ] [MainThread]: 
[0m00:28:21.636225 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:28:21.636484 [info ] [MainThread]: 
[0m00:28:21.636765 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:28:21.638739 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.452639, "process_in_blocks": "0", "process_kernel_time": 0.295942, "process_mem_max_rss": "158367744", "process_out_blocks": "0", "process_user_time": 2.940822}
[0m00:28:21.639053 [debug] [MainThread]: Command `dbt run` succeeded at 00:28:21.638981 after 8.45 seconds
[0m00:28:21.639338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a8b5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fb0bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d285b0>]}
[0m00:28:21.639634 [debug] [MainThread]: Flushing usage events
[0m00:28:21.822222 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:32:05.619343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b7c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c179a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c17cd0>]}


============================== 00:32:05.622714 | 516df495-5564-47be-8c9e-aab4ebf11f96 ==============================
[0m00:32:05.622714 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:32:05.623075 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'use_experimental_parser': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'fail_fast': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/luc/.dbt', 'use_colors': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'empty': 'None', 'no_print': 'None', 'write_json': 'True', 'introspect': 'True', 'debug': 'False', 'invocation_command': 'dbt ls'}
[0m00:32:05.968717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '516df495-5564-47be-8c9e-aab4ebf11f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c17070>]}
[0m00:32:06.004438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '516df495-5564-47be-8c9e-aab4ebf11f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104492370>]}
[0m00:32:06.005137 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:32:06.105320 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:32:06.207025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:32:06.207290 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:32:06.240891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '516df495-5564-47be-8c9e-aab4ebf11f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106342130>]}
[0m00:32:06.306947 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m00:32:06.308905 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m00:32:06.318638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '516df495-5564-47be-8c9e-aab4ebf11f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063416a0>]}
[0m00:32:06.318931 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m00:32:06.319119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '516df495-5564-47be-8c9e-aab4ebf11f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10636ba30>]}
[0m00:32:06.319560 [info ] [MainThread]: youtube_dbt_project.marts.dim_city
[0m00:32:06.319744 [info ] [MainThread]: youtube_dbt_project.marts.dim_youtube_videos
[0m00:32:06.319887 [info ] [MainThread]: youtube_dbt_project.marts.fct_youtube_daily
[0m00:32:06.320026 [info ] [MainThread]: youtube_dbt_project.staging.stg_youtube_videos
[0m00:32:06.320166 [info ] [MainThread]: source:youtube_dbt_project.raw.RAW_YOUTUBE_TRENDING
[0m00:32:06.320303 [info ] [MainThread]: youtube_dbt_project.not_null_stg_youtube_videos_trending_date
[0m00:32:06.320441 [info ] [MainThread]: youtube_dbt_project.not_null_stg_youtube_videos_video_id
[0m00:32:06.321702 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.7603662, "process_in_blocks": "0", "process_kernel_time": 0.250873, "process_mem_max_rss": "134201344", "process_out_blocks": "0", "process_user_time": 1.309244}
[0m00:32:06.321928 [debug] [MainThread]: Command `dbt ls` succeeded at 00:32:06.321877 after 0.76 seconds
[0m00:32:06.322124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b7c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e7d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eca820>]}
[0m00:32:06.322307 [debug] [MainThread]: Flushing usage events
[0m00:32:06.655085 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:33:12.389023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fec5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c8b7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c8baf0>]}


============================== 00:33:12.391860 | 9a17bdcd-66a4-4a01-8ced-ee3da1c2e884 ==============================
[0m00:33:12.391860 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:33:12.392217 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'log_cache_events': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'write_json': 'True', 'invocation_command': 'dbt run --select fct_youtube_daily', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'empty': 'False', 'warn_error': 'None', 'profiles_dir': '/Users/luc/.dbt', 'static_parser': 'True', 'debug': 'False', 'quiet': 'False'}
[0m00:33:12.721068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a17bdcd-66a4-4a01-8ced-ee3da1c2e884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c1d970>]}
[0m00:33:12.756827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a17bdcd-66a4-4a01-8ced-ee3da1c2e884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aec4c0>]}
[0m00:33:12.757735 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:33:12.857469 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:33:12.955997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:33:12.956272 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:33:12.989577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a17bdcd-66a4-4a01-8ced-ee3da1c2e884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111192130>]}
[0m00:33:13.053142 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m00:33:13.054517 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m00:33:13.064799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a17bdcd-66a4-4a01-8ced-ee3da1c2e884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d17160>]}
[0m00:33:13.065110 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m00:33:13.065310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a17bdcd-66a4-4a01-8ced-ee3da1c2e884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cf1220>]}
[0m00:33:13.065956 [info ] [MainThread]: 
[0m00:33:13.066165 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:33:13.066320 [info ] [MainThread]: 
[0m00:33:13.066602 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:33:13.067065 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m00:33:13.075829 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m00:33:13.076025 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m00:33:13.076191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:14.579057 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.502 seconds
[0m00:33:14.583038 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m00:33:14.785013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m00:33:14.800612 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m00:33:14.801067 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m00:33:14.801409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:33:16.444041 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.642 seconds
[0m00:33:16.448962 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m00:33:16.653389 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS)
[0m00:33:16.660270 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS"
[0m00:33:16.660868 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_STAGING_MARTS limit 10000
[0m00:33:16.661369 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:33:17.862316 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.201 seconds
[0m00:33:17.865880 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS: Close
[0m00:33:18.089614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m00:33:18.096598 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m00:33:18.097389 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m00:33:18.097892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:33:19.280585 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.182 seconds
[0m00:33:19.285959 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m00:33:19.480060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a17bdcd-66a4-4a01-8ced-ee3da1c2e884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bcca60>]}
[0m00:33:19.484130 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fct_youtube_daily
[0m00:33:19.484935 [info ] [Thread-1  ]: 1 of 1 START sql view model STAGING_STAGING_STAGING_MARTS.fct_youtube_daily .... [RUN]
[0m00:33:19.485454 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now model.youtube_dbt_project.fct_youtube_daily)
[0m00:33:19.485839 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.fct_youtube_daily
[0m00:33:19.494182 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.fct_youtube_daily"
[0m00:33:19.494927 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.fct_youtube_daily
[0m00:33:19.513260 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.fct_youtube_daily"
[0m00:33:19.514557 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.fct_youtube_daily"
[0m00:33:19.514812 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.fct_youtube_daily"} */
create or replace   view MAGPIE_FINAL_PROJECT.STAGING_STAGING_STAGING_MARTS.fct_youtube_daily
  
   as (
    

with base as (

    select
        video_id,
        country,
        trending_date,
        category_id,
        title,
        channel_title,
        publish_ts::date as publish_date,
        views,
        likes,
        dislikes,
        comment_count
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos

),

daily as (

    select
        country,
        trending_date,
        category_id,
        count(distinct video_id) as num_videos,
        sum(views) as total_views,
        sum(likes) as total_likes,
        sum(dislikes) as total_dislikes,
        sum(comment_count) as total_comments
    from base
    group by country, trending_date, category_id

)

select * from daily
  );
[0m00:33:19.515063 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:33:20.894298 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.379 seconds
[0m00:33:20.933780 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: Close
[0m00:33:21.156372 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a17bdcd-66a4-4a01-8ced-ee3da1c2e884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aec520>]}
[0m00:33:21.157698 [info ] [Thread-1  ]: 1 of 1 OK created sql view model STAGING_STAGING_STAGING_MARTS.fct_youtube_daily  [[32mSUCCESS 1[0m in 1.67s]
[0m00:33:21.158677 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fct_youtube_daily
[0m00:33:21.160386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:33:21.160862 [debug] [MainThread]: Connection 'model.youtube_dbt_project.fct_youtube_daily' was properly closed.
[0m00:33:21.161338 [info ] [MainThread]: 
[0m00:33:21.161851 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.09 seconds (8.09s).
[0m00:33:21.162920 [debug] [MainThread]: Command end result
[0m00:33:21.200105 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m00:33:21.202081 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m00:33:21.208254 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m00:33:21.208517 [info ] [MainThread]: 
[0m00:33:21.208845 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:33:21.209072 [info ] [MainThread]: 
[0m00:33:21.209361 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:33:21.211273 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.867218, "process_in_blocks": "0", "process_kernel_time": 0.357118, "process_mem_max_rss": "157614080", "process_out_blocks": "0", "process_user_time": 2.944728}
[0m00:33:21.211613 [debug] [MainThread]: Command `dbt run` succeeded at 00:33:21.211544 after 8.87 seconds
[0m00:33:21.211911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fec5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aec4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f6ed60>]}
[0m00:33:21.212257 [debug] [MainThread]: Flushing usage events
[0m00:33:21.390126 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:34:25.649588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f05b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10848b9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10848bcd0>]}


============================== 00:34:25.652688 | 64dd8b3e-48c5-4730-9221-aa1c179e7246 ==============================
[0m00:34:25.652688 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:34:25.653055 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'debug': 'False', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'profiles_dir': '/Users/luc/.dbt', 'quiet': 'False', 'printer_width': '80', 'introspect': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'invocation_command': 'dbt ls --resource-type model', 'no_print': 'None', 'fail_fast': 'False', 'log_format': 'default', 'target_path': 'None'}
[0m00:34:25.991969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64dd8b3e-48c5-4730-9221-aa1c179e7246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109625cd0>]}
[0m00:34:26.026916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64dd8b3e-48c5-4730-9221-aa1c179e7246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10951f430>]}
[0m00:34:26.027470 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:34:26.128243 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:34:26.229723 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:34:26.229991 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:34:26.263476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64dd8b3e-48c5-4730-9221-aa1c179e7246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bb7130>]}
[0m00:34:26.328325 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m00:34:26.329696 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m00:34:26.339723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64dd8b3e-48c5-4730-9221-aa1c179e7246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b5bc70>]}
[0m00:34:26.340021 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m00:34:26.340212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64dd8b3e-48c5-4730-9221-aa1c179e7246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109be1a90>]}
[0m00:34:26.340675 [info ] [MainThread]: youtube_dbt_project.marts.dim_city
[0m00:34:26.340858 [info ] [MainThread]: youtube_dbt_project.marts.dim_youtube_videos
[0m00:34:26.341005 [info ] [MainThread]: youtube_dbt_project.marts.fct_youtube_daily
[0m00:34:26.341154 [info ] [MainThread]: youtube_dbt_project.staging.stg_youtube_videos
[0m00:34:26.342415 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.73764956, "process_in_blocks": "0", "process_kernel_time": 0.209877, "process_mem_max_rss": "133021696", "process_out_blocks": "0", "process_user_time": 1.265748}
[0m00:34:26.342657 [debug] [MainThread]: Command `dbt ls` succeeded at 00:34:26.342605 after 0.74 seconds
[0m00:34:26.342858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f05b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b5bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10951f430>]}
[0m00:34:26.343041 [debug] [MainThread]: Flushing usage events
[0m00:34:26.569500 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:40:13.562054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10526f5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d0b7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d0baf0>]}


============================== 00:40:13.565212 | 58fb2fb3-154c-4042-80db-a0f9bb253bac ==============================
[0m00:40:13.565212 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:40:13.565554 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_format': 'default', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select fct_youtube_daily', 'quiet': 'False', 'use_colors': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'profiles_dir': '/Users/luc/.dbt', 'write_json': 'True', 'no_print': 'None', 'debug': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False'}
[0m00:40:13.906168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58fb2fb3-154c-4042-80db-a0f9bb253bac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10809d970>]}
[0m00:40:13.941251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58fb2fb3-154c-4042-80db-a0f9bb253bac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f6c4c0>]}
[0m00:40:13.941831 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:40:14.040184 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:40:14.141118 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:40:14.141514 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/marts/fct_youtube_daily.sql
[0m00:40:14.305957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58fb2fb3-154c-4042-80db-a0f9bb253bac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10940f130>]}
[0m00:40:14.371033 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m00:40:14.372418 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m00:40:14.382834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58fb2fb3-154c-4042-80db-a0f9bb253bac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109413400>]}
[0m00:40:14.383137 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m00:40:14.383337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58fb2fb3-154c-4042-80db-a0f9bb253bac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093f7b50>]}
[0m00:40:14.383971 [info ] [MainThread]: 
[0m00:40:14.384166 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:40:14.384323 [info ] [MainThread]: 
[0m00:40:14.384605 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:40:14.385049 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m00:40:14.392854 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m00:40:14.393053 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m00:40:14.393219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:40:15.737860 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.344 seconds
[0m00:40:15.741765 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m00:40:15.949425 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS)
[0m00:40:15.964962 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS"
[0m00:40:15.965404 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_STAGING_MARTS limit 10000
[0m00:40:15.965764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:40:16.869761 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.904 seconds
[0m00:40:16.874383 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS: Close
[0m00:40:17.060023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m00:40:17.065646 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m00:40:17.066245 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m00:40:17.066722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:40:18.016503 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.949 seconds
[0m00:40:18.022033 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m00:40:18.229596 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m00:40:18.235131 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m00:40:18.235714 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m00:40:18.236188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:40:19.354619 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.118 seconds
[0m00:40:19.357726 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m00:40:19.571019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58fb2fb3-154c-4042-80db-a0f9bb253bac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10941e820>]}
[0m00:40:19.574952 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fct_youtube_daily
[0m00:40:19.575565 [info ] [Thread-1  ]: 1 of 1 START sql table model STAGING_STAGING_STAGING_MARTS.fct_youtube_daily ... [RUN]
[0m00:40:19.575988 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now model.youtube_dbt_project.fct_youtube_daily)
[0m00:40:19.576230 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.fct_youtube_daily
[0m00:40:19.583094 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.fct_youtube_daily"
[0m00:40:19.584075 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.fct_youtube_daily
[0m00:40:19.595447 [debug] [Thread-1  ]: Dropping relation "MAGPIE_FINAL_PROJECT"."STAGING_STAGING_STAGING_MARTS"."FCT_YOUTUBE_DAILY" because it is of type view
[0m00:40:19.600464 [debug] [Thread-1  ]: Applying DROP to: "MAGPIE_FINAL_PROJECT"."STAGING_STAGING_STAGING_MARTS"."FCT_YOUTUBE_DAILY"
[0m00:40:19.604318 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.fct_youtube_daily"
[0m00:40:19.604771 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.fct_youtube_daily"} */
drop view if exists "MAGPIE_FINAL_PROJECT"."STAGING_STAGING_STAGING_MARTS"."FCT_YOUTUBE_DAILY" cascade
[0m00:40:19.605024 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:40:20.627744 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.022 seconds
[0m00:40:20.653018 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.fct_youtube_daily"
[0m00:40:20.655440 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.fct_youtube_daily"
[0m00:40:20.655953 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.fct_youtube_daily"} */
create or replace transient table MAGPIE_FINAL_PROJECT.STAGING_STAGING_STAGING_MARTS.fct_youtube_daily
         as
        (

with base as (
    select
        video_id,
        country,
        trending_date,
        views,
        likes,
        dislikes,
        comment_count
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
)

select
    trending_date,
    country,
    count(distinct video_id) as num_videos,
    sum(views)         as total_views,
    sum(likes)         as total_likes,
    sum(dislikes)      as total_dislikes,
    sum(comment_count) as total_comments
from base
group by trending_date, country
        );
[0m00:40:21.805544 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e2b0-0307-3356-000e-9ce300bc93ae
[0m00:40:21.806253 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
[0m00:40:21.806896 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: Close
[0m00:40:22.236452 [debug] [Thread-1  ]: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m00:40:22.239703 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58fb2fb3-154c-4042-80db-a0f9bb253bac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b216160>]}
[0m00:40:22.240658 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model STAGING_STAGING_STAGING_MARTS.fct_youtube_daily  [[31mERROR[0m in 2.66s]
[0m00:40:22.241483 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fct_youtube_daily
[0m00:40:22.242180 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.fct_youtube_daily' to be skipped because of status 'error'.  Reason: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql.
[0m00:40:22.243627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:40:22.244083 [debug] [MainThread]: Connection 'model.youtube_dbt_project.fct_youtube_daily' was properly closed.
[0m00:40:22.244514 [info ] [MainThread]: 
[0m00:40:22.244943 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.86 seconds (7.86s).
[0m00:40:22.245816 [debug] [MainThread]: Command end result
[0m00:40:22.276904 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m00:40:22.278729 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m00:40:22.284240 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m00:40:22.284478 [info ] [MainThread]: 
[0m00:40:22.284751 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:40:22.284972 [info ] [MainThread]: 
[0m00:40:22.285271 [error] [MainThread]: [31mFailure in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)[0m
[0m00:40:22.285539 [error] [MainThread]:   Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m00:40:22.285745 [info ] [MainThread]: 
[0m00:40:22.285983 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m00:40:22.286175 [info ] [MainThread]: 
[0m00:40:22.286400 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m00:40:22.288300 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.771824, "process_in_blocks": "0", "process_kernel_time": 0.349416, "process_mem_max_rss": "162873344", "process_out_blocks": "0", "process_user_time": 3.084916}
[0m00:40:22.288581 [debug] [MainThread]: Command `dbt run` failed at 00:40:22.288523 after 8.77 seconds
[0m00:40:22.288864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10526f5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10809d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109413d30>]}
[0m00:40:22.289133 [debug] [MainThread]: Flushing usage events
[0m00:40:22.671209 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:43:37.871133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a105e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aab7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aabaf0>]}


============================== 00:43:37.874495 | 8c299afb-f026-4b37-b5fc-64a3792a277c ==============================
[0m00:43:37.874495 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:43:37.874851 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'static_parser': 'True', 'warn_error': 'None', 'write_json': 'True', 'invocation_command': 'dbt run --select fct_youtube_daily', 'introspect': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'no_print': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'empty': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'quiet': 'False', 'log_format': 'default', 'profiles_dir': '/Users/luc/.dbt', 'use_colors': 'True', 'partial_parse': 'True', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False'}
[0m00:43:38.231136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c299afb-f026-4b37-b5fc-64a3792a277c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c61970>]}
[0m00:43:38.267138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c299afb-f026-4b37-b5fc-64a3792a277c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b304c0>]}
[0m00:43:38.267764 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:43:38.370781 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:43:38.474990 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:43:38.475392 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/marts/fct_youtube_daily.sql
[0m00:43:38.640901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c299afb-f026-4b37-b5fc-64a3792a277c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a384130>]}
[0m00:43:38.703214 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m00:43:38.704649 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m00:43:38.715800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c299afb-f026-4b37-b5fc-64a3792a277c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a38f400>]}
[0m00:43:38.717352 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m00:43:38.717603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c299afb-f026-4b37-b5fc-64a3792a277c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a36cb50>]}
[0m00:43:38.718372 [info ] [MainThread]: 
[0m00:43:38.718595 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:43:38.718760 [info ] [MainThread]: 
[0m00:43:38.719087 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:43:38.719588 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m00:43:38.728626 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m00:43:38.728908 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m00:43:38.729087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:43:40.026127 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.297 seconds
[0m00:43:40.030133 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m00:43:40.273044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m00:43:40.288636 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m00:43:40.289146 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m00:43:40.289508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:43:41.464884 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.175 seconds
[0m00:43:41.468760 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m00:43:41.656820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m00:43:41.662099 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m00:43:41.662359 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m00:43:41.662535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:43:42.772641 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.110 seconds
[0m00:43:42.775824 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m00:43:42.994620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c299afb-f026-4b37-b5fc-64a3792a277c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c10a60>]}
[0m00:43:42.999415 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fct_youtube_daily
[0m00:43:43.000372 [info ] [Thread-1  ]: 1 of 1 START sql table model STAGING_MARTS.fct_youtube_daily ................... [RUN]
[0m00:43:43.001137 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now model.youtube_dbt_project.fct_youtube_daily)
[0m00:43:43.001748 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.fct_youtube_daily
[0m00:43:43.017132 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.fct_youtube_daily"
[0m00:43:43.018478 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.fct_youtube_daily
[0m00:43:43.049898 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.fct_youtube_daily"
[0m00:43:43.051337 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.fct_youtube_daily"
[0m00:43:43.051682 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.fct_youtube_daily"} */
create or replace transient table MAGPIE_FINAL_PROJECT.STAGING_MARTS.fct_youtube_daily
         as
        (

with base as (
    select
        video_id,
        country,
        trending_date,
        try_to_number(views)         as views,
        try_to_number(likes)         as likes,
        try_to_number(dislikes)      as dislikes,
        try_to_number(comment_count) as comment_count
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
)

select
    trending_date,
    country,
    count(distinct video_id) as num_videos,
    sum(views)         as total_views,
    sum(likes)         as total_likes,
    sum(dislikes)      as total_dislikes,
    sum(comment_count) as total_comments
from base
group by trending_date, country
        );
[0m00:43:43.051988 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:43:45.368609 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e2b3-0307-33da-000e-9ce300bc5e7a
[0m00:43:45.369295 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'False' is not recognized
[0m00:43:45.369925 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: Close
[0m00:43:45.574744 [debug] [Thread-1  ]: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'False' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m00:43:45.577525 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c299afb-f026-4b37-b5fc-64a3792a277c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba88400>]}
[0m00:43:45.578489 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model STAGING_MARTS.fct_youtube_daily .......... [[31mERROR[0m in 2.57s]
[0m00:43:45.579286 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fct_youtube_daily
[0m00:43:45.579970 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.fct_youtube_daily' to be skipped because of status 'error'.  Reason: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'False' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql.
[0m00:43:45.581344 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:43:45.581718 [debug] [MainThread]: Connection 'model.youtube_dbt_project.fct_youtube_daily' was properly closed.
[0m00:43:45.582081 [info ] [MainThread]: 
[0m00:43:45.582475 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.86 seconds (6.86s).
[0m00:43:45.583323 [debug] [MainThread]: Command end result
[0m00:43:45.614660 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m00:43:45.616141 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m00:43:45.621491 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m00:43:45.621755 [info ] [MainThread]: 
[0m00:43:45.622051 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:43:45.622290 [info ] [MainThread]: 
[0m00:43:45.622585 [error] [MainThread]: [31mFailure in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)[0m
[0m00:43:45.622854 [error] [MainThread]:   Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'False' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m00:43:45.623051 [info ] [MainThread]: 
[0m00:43:45.623291 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m00:43:45.623489 [info ] [MainThread]: 
[0m00:43:45.623703 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m00:43:45.625461 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.802747, "process_in_blocks": "0", "process_kernel_time": 0.332509, "process_mem_max_rss": "160595968", "process_out_blocks": "0", "process_user_time": 2.727137}
[0m00:43:45.625738 [debug] [MainThread]: Command `dbt run` failed at 00:43:45.625680 after 7.80 seconds
[0m00:43:45.625999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a105e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c61970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a38fd30>]}
[0m00:43:45.626257 [debug] [MainThread]: Flushing usage events
[0m00:43:45.912929 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:47:30.684543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e93610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f2f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f2fa60>]}


============================== 00:47:30.687757 | 677b335d-5de2-44cf-907c-98c194184e52 ==============================
[0m00:47:30.687757 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:47:30.688125 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/luc/.dbt', 'log_cache_events': 'False', 'warn_error': 'None', 'version_check': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'use_colors': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'debug': 'False', 'invocation_command': 'dbt run --select fct_youtube_daily', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'log_format': 'default', 'fail_fast': 'False', 'write_json': 'True', 'partial_parse': 'True', 'no_print': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False'}
[0m00:47:31.034414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '677b335d-5de2-44cf-907c-98c194184e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a100a90>]}
[0m00:47:31.069338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '677b335d-5de2-44cf-907c-98c194184e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a09bc40>]}
[0m00:47:31.069923 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:47:31.169504 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:47:31.270884 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:47:31.271259 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/marts/fct_youtube_daily.sql
[0m00:47:31.436314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '677b335d-5de2-44cf-907c-98c194184e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a80c130>]}
[0m00:47:31.500509 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m00:47:31.502006 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m00:47:31.512785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '677b335d-5de2-44cf-907c-98c194184e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a815160>]}
[0m00:47:31.513084 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m00:47:31.513281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '677b335d-5de2-44cf-907c-98c194184e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073b7e80>]}
[0m00:47:31.513916 [info ] [MainThread]: 
[0m00:47:31.514109 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:47:31.514264 [info ] [MainThread]: 
[0m00:47:31.514557 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:47:31.514999 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m00:47:31.522814 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m00:47:31.523014 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m00:47:31.523186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:47:32.983349 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.460 seconds
[0m00:47:32.986529 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m00:47:33.239073 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m00:47:33.254291 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m00:47:33.254741 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m00:47:33.255095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:47:34.149028 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.894 seconds
[0m00:47:34.153742 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m00:47:34.388808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m00:47:34.395571 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m00:47:34.396341 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m00:47:34.396997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:47:35.259797 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.862 seconds
[0m00:47:35.264104 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m00:47:35.449595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '677b335d-5de2-44cf-907c-98c194184e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a50dca0>]}
[0m00:47:35.455893 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fct_youtube_daily
[0m00:47:35.456962 [info ] [Thread-1  ]: 1 of 1 START sql table model STAGING_MARTS.fct_youtube_daily ................... [RUN]
[0m00:47:35.457737 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now model.youtube_dbt_project.fct_youtube_daily)
[0m00:47:35.458340 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.fct_youtube_daily
[0m00:47:35.474083 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.fct_youtube_daily"
[0m00:47:35.475478 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.fct_youtube_daily
[0m00:47:35.507231 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.fct_youtube_daily"
[0m00:47:35.509194 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.fct_youtube_daily"
[0m00:47:35.509569 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.fct_youtube_daily"} */
create or replace transient table MAGPIE_FINAL_PROJECT.STAGING_MARTS.fct_youtube_daily
         as
        (

with src as (
    select
        video_id,
        country,
        trending_date,
        views,
        likes,
        dislikes,
        comment_count
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
),

clean as (
    select
        video_id,
        country,
        trending_date,

        case
            when regexp_like(views, '^[0-9]+$')
            then to_number(views)
            else null
        end as views_num,

        case
            when regexp_like(likes, '^[0-9]+$')
            then to_number(likes)
            else null
        end as likes_num,

        case
            when regexp_like(dislikes, '^[0-9]+$')
            then to_number(dislikes)
            else null
        end as dislikes_num,

        case
            when regexp_like(comment_count, '^[0-9]+$')
            then to_number(comment_count)
            else null
        end as comment_num
    from src
)

select
    trending_date,
    country,
    count(distinct video_id) as num_videos,
    sum(views_num)           as total_views,
    sum(likes_num)           as total_likes,
    sum(dislikes_num)        as total_dislikes,
    sum(comment_num)         as total_comments
from clean
group by trending_date, country
        );
[0m00:47:35.509912 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:47:36.938069 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e2b7-0307-3743-000e-9ce300bcb25a
[0m00:47:36.938809 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'False' is not recognized
[0m00:47:36.939451 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: Close
[0m00:47:37.149589 [debug] [Thread-1  ]: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'False' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m00:47:37.152448 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '677b335d-5de2-44cf-907c-98c194184e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108185af0>]}
[0m00:47:37.153417 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model STAGING_MARTS.fct_youtube_daily .......... [[31mERROR[0m in 1.69s]
[0m00:47:37.154217 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fct_youtube_daily
[0m00:47:37.154863 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.fct_youtube_daily' to be skipped because of status 'error'.  Reason: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'False' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql.
[0m00:47:37.156191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:47:37.156562 [debug] [MainThread]: Connection 'model.youtube_dbt_project.fct_youtube_daily' was properly closed.
[0m00:47:37.156923 [info ] [MainThread]: 
[0m00:47:37.157337 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.64 seconds (5.64s).
[0m00:47:37.158173 [debug] [MainThread]: Command end result
[0m00:47:37.189464 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m00:47:37.191042 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m00:47:37.196763 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m00:47:37.197006 [info ] [MainThread]: 
[0m00:47:37.197278 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:47:37.197495 [info ] [MainThread]: 
[0m00:47:37.197762 [error] [MainThread]: [31mFailure in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)[0m
[0m00:47:37.198023 [error] [MainThread]:   Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'False' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m00:47:37.198225 [info ] [MainThread]: 
[0m00:47:37.198459 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m00:47:37.198650 [info ] [MainThread]: 
[0m00:47:37.198861 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m00:47:37.200552 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.562369, "process_in_blocks": "0", "process_kernel_time": 0.344014, "process_mem_max_rss": "164593664", "process_out_blocks": "0", "process_user_time": 2.810925}
[0m00:47:37.200830 [debug] [MainThread]: Command `dbt run` failed at 00:47:37.200773 after 6.56 seconds
[0m00:47:37.201088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e93610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a100a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8157c0>]}
[0m00:47:37.201370 [debug] [MainThread]: Flushing usage events
[0m00:47:37.488342 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:51:29.380292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077b4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10884f640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10884f970>]}


============================== 00:51:29.383442 | 3f9f7582-e8eb-404e-9b76-bdf1b8564b2e ==============================
[0m00:51:29.383442 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:51:29.383792 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --select fct_youtube_daily', 'cache_selected_only': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'no_print': 'None', 'write_json': 'True', 'target_path': 'None', 'printer_width': '80', 'static_parser': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/luc/.dbt'}
[0m00:51:29.725886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f9f7582-e8eb-404e-9b76-bdf1b8564b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088273a0>]}
[0m00:51:29.762853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f9f7582-e8eb-404e-9b76-bdf1b8564b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098d4400>]}
[0m00:51:29.763546 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:51:29.863330 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:51:29.964223 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:51:29.964598 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/marts/fct_youtube_daily.sql
[0m00:51:30.130035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f9f7582-e8eb-404e-9b76-bdf1b8564b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a121130>]}
[0m00:51:30.193074 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m00:51:30.194602 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m00:51:30.205743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f9f7582-e8eb-404e-9b76-bdf1b8564b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a133910>]}
[0m00:51:30.206076 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m00:51:30.206286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f9f7582-e8eb-404e-9b76-bdf1b8564b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a160af0>]}
[0m00:51:30.206931 [info ] [MainThread]: 
[0m00:51:30.207128 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:51:30.207283 [info ] [MainThread]: 
[0m00:51:30.207576 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:51:30.208018 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m00:51:30.216001 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m00:51:30.216214 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m00:51:30.216385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:51:31.675549 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.459 seconds
[0m00:51:31.679996 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m00:51:31.869803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m00:51:31.884971 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m00:51:31.885424 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m00:51:31.885773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:51:33.251916 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.366 seconds
[0m00:51:33.256388 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m00:51:33.493750 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m00:51:33.500338 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m00:51:33.501087 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m00:51:33.501561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:51:34.764423 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.263 seconds
[0m00:51:34.769069 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m00:51:35.027872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f9f7582-e8eb-404e-9b76-bdf1b8564b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e3c0a0>]}
[0m00:51:35.032865 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fct_youtube_daily
[0m00:51:35.033841 [info ] [Thread-1  ]: 1 of 1 START sql table model STAGING_MARTS.fct_youtube_daily ................... [RUN]
[0m00:51:35.034609 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now model.youtube_dbt_project.fct_youtube_daily)
[0m00:51:35.035210 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.fct_youtube_daily
[0m00:51:35.050552 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.fct_youtube_daily"
[0m00:51:35.051770 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.fct_youtube_daily
[0m00:51:35.083139 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.fct_youtube_daily"
[0m00:51:35.084134 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.fct_youtube_daily"
[0m00:51:35.084451 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.fct_youtube_daily"} */
create or replace transient table MAGPIE_FINAL_PROJECT.STAGING_MARTS.fct_youtube_daily
         as
        (

select
    trending_date,
    country,
    count(*) as num_rows
from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
group by
    trending_date,
    country
        );
[0m00:51:35.084737 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:51:36.989162 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.904 seconds
[0m00:51:37.024009 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: Close
[0m00:51:37.227053 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f9f7582-e8eb-404e-9b76-bdf1b8564b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098d43d0>]}
[0m00:51:37.228318 [info ] [Thread-1  ]: 1 of 1 OK created sql table model STAGING_MARTS.fct_youtube_daily .............. [[32mSUCCESS 1[0m in 2.19s]
[0m00:51:37.229280 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fct_youtube_daily
[0m00:51:37.230896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:51:37.231435 [debug] [MainThread]: Connection 'model.youtube_dbt_project.fct_youtube_daily' was properly closed.
[0m00:51:37.231921 [info ] [MainThread]: 
[0m00:51:37.232427 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.02 seconds (7.02s).
[0m00:51:37.233474 [debug] [MainThread]: Command end result
[0m00:51:37.271102 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m00:51:37.272740 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m00:51:37.278600 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m00:51:37.278852 [info ] [MainThread]: 
[0m00:51:37.279166 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:51:37.279392 [info ] [MainThread]: 
[0m00:51:37.279628 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:51:37.281577 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.9478054, "process_in_blocks": "0", "process_kernel_time": 0.333822, "process_mem_max_rss": "159268864", "process_out_blocks": "0", "process_user_time": 2.793351}
[0m00:51:37.281918 [debug] [MainThread]: Command `dbt run` succeeded at 00:51:37.281846 after 7.95 seconds
[0m00:51:37.282205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077b4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ac4a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a133670>]}
[0m00:51:37.282516 [debug] [MainThread]: Flushing usage events
[0m00:51:37.610653 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:56:28.665899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107417640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b3790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b3ac0>]}


============================== 00:56:28.669095 | 5a20554b-2dc3-43c1-b6c3-a75cec650a54 ==============================
[0m00:56:28.669095 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:56:28.669501 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'version_check': 'True', 'debug': 'False', 'empty': 'False', 'log_format': 'default', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'target_path': 'None', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select fct_youtube_daily', 'printer_width': '80', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'partial_parse': 'True', 'no_print': 'None', 'profiles_dir': '/Users/luc/.dbt'}
[0m00:56:29.008815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a20554b-2dc3-43c1-b6c3-a75cec650a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109661820>]}
[0m00:56:29.043721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a20554b-2dc3-43c1-b6c3-a75cec650a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d8a250>]}
[0m00:56:29.044283 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:56:29.143994 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:56:29.245458 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:56:29.245841 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/marts/fct_youtube_daily.sql
[0m00:56:29.409863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a20554b-2dc3-43c1-b6c3-a75cec650a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d89130>]}
[0m00:56:29.473874 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m00:56:29.475324 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m00:56:29.485964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a20554b-2dc3-43c1-b6c3-a75cec650a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d8e7c0>]}
[0m00:56:29.486267 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m00:56:29.486465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a20554b-2dc3-43c1-b6c3-a75cec650a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d73b80>]}
[0m00:56:29.487111 [info ] [MainThread]: 
[0m00:56:29.487314 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:56:29.487471 [info ] [MainThread]: 
[0m00:56:29.487751 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:56:29.488212 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m00:56:29.496082 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m00:56:29.496281 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m00:56:29.496452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:56:30.849922 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.353 seconds
[0m00:56:30.854337 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m00:56:31.042164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m00:56:31.057849 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m00:56:31.058291 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS limit 10000
[0m00:56:31.058669 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:56:32.116951 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.058 seconds
[0m00:56:32.122360 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m00:56:32.339493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m00:56:32.345895 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m00:56:32.346573 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m00:56:32.347053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:56:33.286695 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.939 seconds
[0m00:56:33.290015 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m00:56:33.504169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m00:56:33.511743 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m00:56:33.512322 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m00:56:33.512800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:56:34.560852 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.048 seconds
[0m00:56:34.566193 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m00:56:34.774646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a20554b-2dc3-43c1-b6c3-a75cec650a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d19fd0>]}
[0m00:56:34.779256 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fct_youtube_daily
[0m00:56:34.780242 [info ] [Thread-1  ]: 1 of 1 START sql table model STAGING_STAGING_MARTS.fct_youtube_daily ........... [RUN]
[0m00:56:34.781043 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now model.youtube_dbt_project.fct_youtube_daily)
[0m00:56:34.781653 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.fct_youtube_daily
[0m00:56:34.795402 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.fct_youtube_daily"
[0m00:56:34.796858 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.fct_youtube_daily
[0m00:56:34.828868 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.fct_youtube_daily"
[0m00:56:34.830134 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.fct_youtube_daily"
[0m00:56:34.830469 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.fct_youtube_daily"} */
create or replace transient table MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS.fct_youtube_daily
         as
        (

with base as (

    select
        trending_date,
        country,
        category_id,
        count(*) as video_count,
        sum(views) as total_views,
        sum(likes) as total_likes,
        sum(comment_count) as total_comments
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
    group by
        trending_date,
        country,
        category_id

)

select * from base
        );
[0m00:56:34.830772 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:56:36.483538 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e2c0-0307-33da-000e-9ce300bc5f1a
[0m00:56:36.484225 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'https://i.ytimg.com/vi/5nSlqLc7Y4A/default.jpg' is not recognized
[0m00:56:36.484866 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: Close
[0m00:56:36.699194 [debug] [Thread-1  ]: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/5nSlqLc7Y4A/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m00:56:36.702059 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a20554b-2dc3-43c1-b6c3-a75cec650a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c0d7f0>]}
[0m00:56:36.702993 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model STAGING_STAGING_MARTS.fct_youtube_daily .. [[31mERROR[0m in 1.92s]
[0m00:56:36.703814 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fct_youtube_daily
[0m00:56:36.704462 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.fct_youtube_daily' to be skipped because of status 'error'.  Reason: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/5nSlqLc7Y4A/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql.
[0m00:56:36.705814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:56:36.706252 [debug] [MainThread]: Connection 'model.youtube_dbt_project.fct_youtube_daily' was properly closed.
[0m00:56:36.706655 [info ] [MainThread]: 
[0m00:56:36.707061 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.22 seconds (7.22s).
[0m00:56:36.707934 [debug] [MainThread]: Command end result
[0m00:56:36.739108 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m00:56:36.740616 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m00:56:36.745934 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m00:56:36.746167 [info ] [MainThread]: 
[0m00:56:36.746437 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:56:36.746658 [info ] [MainThread]: 
[0m00:56:36.746926 [error] [MainThread]: [31mFailure in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)[0m
[0m00:56:36.747191 [error] [MainThread]:   Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/5nSlqLc7Y4A/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m00:56:36.747390 [info ] [MainThread]: 
[0m00:56:36.747627 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m00:56:36.747818 [info ] [MainThread]: 
[0m00:56:36.748032 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m00:56:36.749792 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.130076, "process_in_blocks": "0", "process_kernel_time": 0.339955, "process_mem_max_rss": "163135488", "process_out_blocks": "0", "process_user_time": 3.075276}
[0m00:56:36.750071 [debug] [MainThread]: Command `dbt run` failed at 00:56:36.750010 after 8.13 seconds
[0m00:56:36.750322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107417640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d8a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a9ea30>]}
[0m00:56:36.750587 [debug] [MainThread]: Flushing usage events
[0m00:56:37.076847 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:58:43.972134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e57580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef3940>]}


============================== 00:58:43.975281 | b2d2cf07-1c3f-4eb4-85fe-974c7cbda605 ==============================
[0m00:58:43.975281 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:58:43.975656 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'version_check': 'True', 'fail_fast': 'False', 'debug': 'False', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'target_path': 'None', 'warn_error': 'None', 'empty': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'quiet': 'False', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'profiles_dir': '/Users/luc/.dbt', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select fct_youtube_daily', 'partial_parse': 'True'}
[0m00:58:44.313455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2d2cf07-1c3f-4eb4-85fe-974c7cbda605', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108070730>]}
[0m00:58:44.348422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2d2cf07-1c3f-4eb4-85fe-974c7cbda605', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108187880>]}
[0m00:58:44.348931 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:58:44.450876 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:58:44.551123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:58:44.551385 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:58:44.584574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2d2cf07-1c3f-4eb4-85fe-974c7cbda605', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10861d130>]}
[0m00:58:44.648982 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m00:58:44.650388 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m00:58:44.661794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2d2cf07-1c3f-4eb4-85fe-974c7cbda605', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108621af0>]}
[0m00:58:44.662099 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m00:58:44.662299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2d2cf07-1c3f-4eb4-85fe-974c7cbda605', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10861de80>]}
[0m00:58:44.662928 [info ] [MainThread]: 
[0m00:58:44.663120 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:58:44.663277 [info ] [MainThread]: 
[0m00:58:44.663550 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:58:44.663982 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m00:58:44.672770 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m00:58:44.672979 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m00:58:44.673153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:58:46.304596 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.631 seconds
[0m00:58:46.307966 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m00:58:46.516357 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m00:58:46.532056 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m00:58:46.532513 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m00:58:46.532859 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:58:47.682556 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.150 seconds
[0m00:58:47.687158 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m00:58:47.866779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m00:58:47.874304 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m00:58:47.874913 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS limit 10000
[0m00:58:47.875389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:58:49.074839 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.199 seconds
[0m00:58:49.079131 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m00:58:49.330256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m00:58:49.337376 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m00:58:49.337957 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m00:58:49.338428 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:58:50.551389 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.213 seconds
[0m00:58:50.556140 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m00:58:50.789966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2d2cf07-1c3f-4eb4-85fe-974c7cbda605', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d4f40>]}
[0m00:58:50.795560 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fct_youtube_daily
[0m00:58:50.796670 [info ] [Thread-1  ]: 1 of 1 START sql table model STAGING_STAGING_MARTS.fct_youtube_daily ........... [RUN]
[0m00:58:50.797418 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now model.youtube_dbt_project.fct_youtube_daily)
[0m00:58:50.798025 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.fct_youtube_daily
[0m00:58:50.812226 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.fct_youtube_daily"
[0m00:58:50.813991 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.fct_youtube_daily
[0m00:58:50.845792 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.fct_youtube_daily"
[0m00:58:50.847115 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.fct_youtube_daily"
[0m00:58:50.847442 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.fct_youtube_daily"} */
create or replace transient table MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS.fct_youtube_daily
         as
        (

with base as (

    select
        trending_date,
        country,
        category_id,
        count(*) as video_count,
        sum(views) as total_views,
        sum(likes) as total_likes,
        sum(comment_count) as total_comments
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
    group by
        trending_date,
        country,
        category_id

)

select * from base
        );
[0m00:58:50.847742 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:58:52.459847 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e2c2-0307-3743-000e-9ce300bcb2fa
[0m00:58:52.460596 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'https://i.ytimg.com/vi/3XskF8Th_5A/default.jpg' is not recognized
[0m00:58:52.461256 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: Close
[0m00:58:52.659862 [debug] [Thread-1  ]: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/3XskF8Th_5A/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m00:58:52.663488 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2d2cf07-1c3f-4eb4-85fe-974c7cbda605', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d6afa0>]}
[0m00:58:52.664444 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model STAGING_STAGING_MARTS.fct_youtube_daily .. [[31mERROR[0m in 1.86s]
[0m00:58:52.665261 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fct_youtube_daily
[0m00:58:52.665936 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.fct_youtube_daily' to be skipped because of status 'error'.  Reason: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/3XskF8Th_5A/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql.
[0m00:58:52.667221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:58:52.667603 [debug] [MainThread]: Connection 'model.youtube_dbt_project.fct_youtube_daily' was properly closed.
[0m00:58:52.667976 [info ] [MainThread]: 
[0m00:58:52.668366 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.00 seconds (8.00s).
[0m00:58:52.669210 [debug] [MainThread]: Command end result
[0m00:58:52.701070 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m00:58:52.702467 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m00:58:52.707729 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m00:58:52.707958 [info ] [MainThread]: 
[0m00:58:52.708225 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:58:52.708444 [info ] [MainThread]: 
[0m00:58:52.708715 [error] [MainThread]: [31mFailure in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)[0m
[0m00:58:52.708982 [error] [MainThread]:   Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/3XskF8Th_5A/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m00:58:52.709178 [info ] [MainThread]: 
[0m00:58:52.709416 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m00:58:52.709607 [info ] [MainThread]: 
[0m00:58:52.709820 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m00:58:52.711371 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.784694, "process_in_blocks": "0", "process_kernel_time": 0.332663, "process_mem_max_rss": "155484160", "process_out_blocks": "0", "process_user_time": 2.980029}
[0m00:58:52.711645 [debug] [MainThread]: Command `dbt run` failed at 00:58:52.711587 after 8.79 seconds
[0m00:58:52.711898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e57580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108621190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ebd00>]}
[0m00:58:52.712154 [debug] [MainThread]: Flushing usage events
[0m00:58:53.009970 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:03:54.547018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103914640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049af790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049afac0>]}


============================== 01:03:54.550142 | 53a2c65d-45fb-439b-9d15-ee4f03454052 ==============================
[0m01:03:54.550142 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:03:54.550530 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'version_check': 'True', 'use_colors': 'True', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'profiles_dir': '/Users/luc/.dbt', 'debug': 'False', 'introspect': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select fct_youtube_daily', 'empty': 'False', 'no_print': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'target_path': 'None'}
[0m01:03:54.895410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53a2c65d-45fb-439b-9d15-ee4f03454052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b5c820>]}
[0m01:03:54.930540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53a2c65d-45fb-439b-9d15-ee4f03454052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104286250>]}
[0m01:03:54.931066 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:03:55.029759 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:03:55.129463 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:03:55.129724 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:03:55.162953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53a2c65d-45fb-439b-9d15-ee4f03454052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060da130>]}
[0m01:03:55.227545 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m01:03:55.228869 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m01:03:55.239578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53a2c65d-45fb-439b-9d15-ee4f03454052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c3520>]}
[0m01:03:55.239876 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m01:03:55.240075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53a2c65d-45fb-439b-9d15-ee4f03454052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb7f70>]}
[0m01:03:55.240718 [info ] [MainThread]: 
[0m01:03:55.240907 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:03:55.241062 [info ] [MainThread]: 
[0m01:03:55.241336 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:03:55.241786 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m01:03:55.250537 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m01:03:55.250733 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m01:03:55.250901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:03:56.653405 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.402 seconds
[0m01:03:56.657389 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m01:03:57.008218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m01:03:57.023850 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m01:03:57.024310 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m01:03:57.024664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:03:58.154094 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.129 seconds
[0m01:03:58.158386 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m01:03:58.398085 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m01:03:58.405513 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m01:03:58.406417 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS limit 10000
[0m01:03:58.406927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:03:59.642766 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.235 seconds
[0m01:03:59.648749 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m01:03:59.826417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m01:03:59.832879 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m01:03:59.833473 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m01:03:59.834005 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:04:00.811504 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.977 seconds
[0m01:04:00.816688 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m01:04:01.002172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53a2c65d-45fb-439b-9d15-ee4f03454052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a64490>]}
[0m01:04:01.006674 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fct_youtube_daily
[0m01:04:01.007583 [info ] [Thread-1  ]: 1 of 1 START sql table model STAGING_STAGING_MARTS.fct_youtube_daily ........... [RUN]
[0m01:04:01.008317 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now model.youtube_dbt_project.fct_youtube_daily)
[0m01:04:01.008909 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.fct_youtube_daily
[0m01:04:01.022987 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.fct_youtube_daily"
[0m01:04:01.024246 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.fct_youtube_daily
[0m01:04:01.055581 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.fct_youtube_daily"
[0m01:04:01.056810 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.fct_youtube_daily"
[0m01:04:01.057136 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.fct_youtube_daily"} */
create or replace transient table MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS.fct_youtube_daily
         as
        (

with base as (

    select
        trending_date,
        country,
        category_id,
        count(*) as video_count,
        sum(views) as total_views,
        sum(likes) as total_likes,
        sum(comment_count) as total_comments
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
    group by
        trending_date,
        country,
        category_id

)

select * from base
        );
[0m01:04:01.057429 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:04:03.352839 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e2c8-0307-3545-000e-9ce300bc7b76
[0m01:04:03.353543 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
[0m01:04:03.354206 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: Close
[0m01:04:03.567306 [debug] [Thread-1  ]: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m01:04:03.570311 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53a2c65d-45fb-439b-9d15-ee4f03454052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076f50a0>]}
[0m01:04:03.571294 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model STAGING_STAGING_MARTS.fct_youtube_daily .. [[31mERROR[0m in 2.56s]
[0m01:04:03.572116 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fct_youtube_daily
[0m01:04:03.572802 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.fct_youtube_daily' to be skipped because of status 'error'.  Reason: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql.
[0m01:04:03.574248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:04:03.574696 [debug] [MainThread]: Connection 'model.youtube_dbt_project.fct_youtube_daily' was properly closed.
[0m01:04:03.575101 [info ] [MainThread]: 
[0m01:04:03.575512 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.33 seconds (8.33s).
[0m01:04:03.576377 [debug] [MainThread]: Command end result
[0m01:04:03.607510 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m01:04:03.609116 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m01:04:03.614436 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m01:04:03.614692 [info ] [MainThread]: 
[0m01:04:03.614987 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:04:03.615228 [info ] [MainThread]: 
[0m01:04:03.615518 [error] [MainThread]: [31mFailure in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)[0m
[0m01:04:03.615790 [error] [MainThread]:   Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m01:04:03.615988 [info ] [MainThread]: 
[0m01:04:03.616219 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m01:04:03.616405 [info ] [MainThread]: 
[0m01:04:03.616614 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m01:04:03.618289 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.118584, "process_in_blocks": "0", "process_kernel_time": 0.340667, "process_mem_max_rss": "160301056", "process_out_blocks": "0", "process_user_time": 2.984152}
[0m01:04:03.618568 [debug] [MainThread]: Command `dbt run` failed at 01:04:03.618510 after 9.12 seconds
[0m01:04:03.618827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103914640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022c9700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f96910>]}
[0m01:04:03.619084 [debug] [MainThread]: Flushing usage events
[0m01:04:04.044516 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:06:22.451190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10783c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d7730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d7a60>]}


============================== 01:06:22.454594 | c5a06a6f-86df-45b3-840a-0826d66896a0 ==============================
[0m01:06:22.454594 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:06:22.454977 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'write_json': 'True', 'quiet': 'False', 'target_path': 'None', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/luc/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run --select fct_youtube_daily --no-partial-parse', 'debug': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'partial_parse': 'False', 'log_format': 'default', 'empty': 'False', 'use_colors': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m01:06:22.794893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5a06a6f-86df-45b3-840a-0826d66896a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aa8a90>]}
[0m01:06:22.831236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5a06a6f-86df-45b3-840a-0826d66896a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a43c40>]}
[0m01:06:22.831906 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:06:22.931426 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:06:22.931915 [debug] [MainThread]: Partial parsing not enabled
[0m01:06:23.699897 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m01:06:23.700219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c5a06a6f-86df-45b3-840a-0826d66896a0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac9ff70>]}
[0m01:06:23.735537 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_stg_weather_datetime.554d39b0ed' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m01:06:23.735854 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.unique_stg_weather_datetime.ea99166edf' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m01:06:23.736064 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_stg_weather_temperature_2m.4552381acc' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m01:06:23.736240 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.accepted_values_stg_weather_city__Chicago__Evanston__Aurora.3a5db1bdc4' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m01:06:23.736410 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_datetime.36fca5f850' (models/marts/schema.yml) depends on a node named 'fact_weather' which is disabled
[0m01:06:23.736567 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.unique_fact_weather_datetime.f553e65bbe' (models/marts/schema.yml) depends on a node named 'fact_weather' which is disabled
[0m01:06:23.736723 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_feels_like.cf8e8e9258' (models/marts/schema.yml) depends on a node named 'fact_weather' which is disabled
[0m01:06:23.736874 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_daily_date.b304b6aad7' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m01:06:23.737026 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.unique_fact_weather_daily_date.1ee454b4b0' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m01:06:23.737175 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_daily_avg_temperature.c0f9fdc06f' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m01:06:23.737322 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.accepted_values_fact_weather_daily_hourly_records__24.a8a2f8b558' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m01:06:23.795688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5a06a6f-86df-45b3-840a-0826d66896a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad6a130>]}
[0m01:06:23.858780 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m01:06:23.860060 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m01:06:23.871183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5a06a6f-86df-45b3-840a-0826d66896a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad6d580>]}
[0m01:06:23.871481 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m01:06:23.871671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5a06a6f-86df-45b3-840a-0826d66896a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad30490>]}
[0m01:06:23.872305 [info ] [MainThread]: 
[0m01:06:23.872493 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:06:23.872654 [info ] [MainThread]: 
[0m01:06:23.872923 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:06:23.873378 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m01:06:23.881335 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m01:06:23.881535 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m01:06:23.881696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:06:25.347228 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.465 seconds
[0m01:06:25.351328 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m01:06:25.577866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m01:06:25.592694 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m01:06:25.593221 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS limit 10000
[0m01:06:25.593635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:06:26.742501 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.149 seconds
[0m01:06:26.746121 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m01:06:26.938073 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m01:06:26.944976 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m01:06:26.945808 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m01:06:26.946301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:06:28.131316 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.185 seconds
[0m01:06:28.135839 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m01:06:28.344110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m01:06:28.350477 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m01:06:28.351084 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m01:06:28.351573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:06:29.281877 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.930 seconds
[0m01:06:29.285765 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m01:06:29.481834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5a06a6f-86df-45b3-840a-0826d66896a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad081c0>]}
[0m01:06:29.485910 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fct_youtube_daily
[0m01:06:29.486895 [info ] [Thread-1  ]: 1 of 1 START sql table model STAGING_STAGING_MARTS.fct_youtube_daily ........... [RUN]
[0m01:06:29.487665 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now model.youtube_dbt_project.fct_youtube_daily)
[0m01:06:29.488288 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.fct_youtube_daily
[0m01:06:29.502496 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.fct_youtube_daily"
[0m01:06:29.504137 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.fct_youtube_daily
[0m01:06:29.536784 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.fct_youtube_daily"
[0m01:06:29.538083 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.fct_youtube_daily"
[0m01:06:29.538434 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.fct_youtube_daily"} */
create or replace transient table MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS.fct_youtube_daily
         as
        (

with base as (

    select
        trending_date,
        country,
        category_id,
        count(*)           as video_count,
        sum(views)         as total_views,
        sum(likes)         as total_likes,
        sum(comment_count) as total_comments
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
    where trending_date is not null
    group by
        trending_date,
        country,
        category_id

)

select * from base
        );
[0m01:06:29.538744 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:06:31.319404 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e2ca-0307-3743-000e-9ce300bcb36a
[0m01:06:31.319824 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'https://i.ytimg.com/vi/5nSlqLc7Y4A/default.jpg' is not recognized
[0m01:06:31.320150 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: Close
[0m01:06:31.497226 [debug] [Thread-1  ]: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/5nSlqLc7Y4A/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m01:06:31.498708 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5a06a6f-86df-45b3-840a-0826d66896a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a233910>]}
[0m01:06:31.499163 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model STAGING_STAGING_MARTS.fct_youtube_daily .. [[31mERROR[0m in 2.01s]
[0m01:06:31.499519 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fct_youtube_daily
[0m01:06:31.499840 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.fct_youtube_daily' to be skipped because of status 'error'.  Reason: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/5nSlqLc7Y4A/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql.
[0m01:06:31.500529 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:06:31.500699 [debug] [MainThread]: Connection 'model.youtube_dbt_project.fct_youtube_daily' was properly closed.
[0m01:06:31.500870 [info ] [MainThread]: 
[0m01:06:31.501039 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.63 seconds (7.63s).
[0m01:06:31.501418 [debug] [MainThread]: Command end result
[0m01:06:31.518095 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m01:06:31.519149 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m01:06:31.522923 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m01:06:31.523107 [info ] [MainThread]: 
[0m01:06:31.523322 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:06:31.523497 [info ] [MainThread]: 
[0m01:06:31.523713 [error] [MainThread]: [31mFailure in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)[0m
[0m01:06:31.523929 [error] [MainThread]:   Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/5nSlqLc7Y4A/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m01:06:31.524089 [info ] [MainThread]: 
[0m01:06:31.524278 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m01:06:31.524431 [info ] [MainThread]: 
[0m01:06:31.524607 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m01:06:31.524936 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:06:31.526459 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.123261, "process_in_blocks": "0", "process_kernel_time": 0.338087, "process_mem_max_rss": "161988608", "process_out_blocks": "0", "process_user_time": 3.622133}
[0m01:06:31.526682 [debug] [MainThread]: Command `dbt run` failed at 01:06:31.526636 after 9.12 seconds
[0m01:06:31.526897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10783c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad6d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ecfeb0>]}
[0m01:06:31.527097 [debug] [MainThread]: Flushing usage events
[0m01:06:31.918527 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:55:31.369047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10664f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10664fa60>]}


============================== 10:55:31.372111 | 2d64ed69-d29f-411e-a26e-4855c87f3871 ==============================
[0m10:55:31.372111 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:55:31.372494 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'empty': 'False', 'log_format': 'default', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'fail_fast': 'False', 'printer_width': '80', 'warn_error': 'None', 'write_json': 'True', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select fct_youtube_daily', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'target_path': 'None', 'static_parser': 'True', 'profiles_dir': '/Users/luc/.dbt', 'quiet': 'False'}
[0m10:55:31.753674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d64ed69-d29f-411e-a26e-4855c87f3871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107820a90>]}
[0m10:55:31.788488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d64ed69-d29f-411e-a26e-4855c87f3871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077bbc40>]}
[0m10:55:31.789120 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:55:31.888449 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:55:31.990640 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:55:31.990921 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:55:32.024226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d64ed69-d29f-411e-a26e-4855c87f3871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d7a130>]}
[0m10:55:32.089659 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m10:55:32.091517 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m10:55:32.106095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d64ed69-d29f-411e-a26e-4855c87f3871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d36730>]}
[0m10:55:32.106420 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m10:55:32.106617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d64ed69-d29f-411e-a26e-4855c87f3871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d87bb0>]}
[0m10:55:32.107267 [info ] [MainThread]: 
[0m10:55:32.107457 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:55:32.107618 [info ] [MainThread]: 
[0m10:55:32.107894 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:55:32.108367 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m10:55:32.117134 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m10:55:32.117347 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m10:55:32.117517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:55:33.555564 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.438 seconds
[0m10:55:33.558885 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m10:55:33.758315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m10:55:33.770225 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m10:55:33.770698 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m10:55:33.771007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:55:35.040372 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.269 seconds
[0m10:55:35.045284 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m10:55:35.246884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m10:55:35.254532 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m10:55:35.255121 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m10:55:35.255584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:55:36.443120 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.187 seconds
[0m10:55:36.447864 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m10:55:36.671229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m10:55:36.680523 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m10:55:36.681219 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS limit 10000
[0m10:55:36.681749 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:55:37.738644 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.057 seconds
[0m10:55:37.742176 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m10:55:37.966481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d64ed69-d29f-411e-a26e-4855c87f3871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104030fd0>]}
[0m10:55:37.973782 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fct_youtube_daily
[0m10:55:37.974781 [info ] [Thread-1  ]: 1 of 1 START sql table model STAGING_STAGING_MARTS.fct_youtube_daily ........... [RUN]
[0m10:55:37.975558 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now model.youtube_dbt_project.fct_youtube_daily)
[0m10:55:37.976189 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.fct_youtube_daily
[0m10:55:37.990534 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.fct_youtube_daily"
[0m10:55:37.992479 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.fct_youtube_daily
[0m10:55:38.024514 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.fct_youtube_daily"
[0m10:55:38.026595 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.fct_youtube_daily"
[0m10:55:38.026960 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.fct_youtube_daily"} */
create or replace transient table MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS.fct_youtube_daily
         as
        (

with base as (

    select
        trending_date,
        country,
        category_id,
        count(*)           as video_count,
        sum(views)         as total_views,
        sum(likes)         as total_likes,
        sum(comment_count) as total_comments
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
    where trending_date is not null
    group by
        trending_date,
        country,
        category_id

)

select * from base
        );
[0m10:55:38.027270 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:55:40.703318 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e517-0307-3356-000e-9ce300bd219e
[0m10:55:40.704097 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'https://i.ytimg.com/vi/V10qKFp3d7g/default.jpg' is not recognized
[0m10:55:40.704774 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: Close
[0m10:55:40.960139 [debug] [Thread-1  ]: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/V10qKFp3d7g/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m10:55:40.963129 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d64ed69-d29f-411e-a26e-4855c87f3871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10937fb20>]}
[0m10:55:40.964074 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model STAGING_STAGING_MARTS.fct_youtube_daily .. [[31mERROR[0m in 2.99s]
[0m10:55:40.964883 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fct_youtube_daily
[0m10:55:40.965562 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.fct_youtube_daily' to be skipped because of status 'error'.  Reason: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/V10qKFp3d7g/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql.
[0m10:55:40.967044 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:55:40.967495 [debug] [MainThread]: Connection 'model.youtube_dbt_project.fct_youtube_daily' was properly closed.
[0m10:55:40.967920 [info ] [MainThread]: 
[0m10:55:40.968357 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.86 seconds (8.86s).
[0m10:55:40.969230 [debug] [MainThread]: Command end result
[0m10:55:41.001228 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m10:55:41.002968 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m10:55:41.009171 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m10:55:41.009412 [info ] [MainThread]: 
[0m10:55:41.009689 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:55:41.009908 [info ] [MainThread]: 
[0m10:55:41.010193 [error] [MainThread]: [31mFailure in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)[0m
[0m10:55:41.010456 [error] [MainThread]:   Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/V10qKFp3d7g/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m10:55:41.010655 [info ] [MainThread]: 
[0m10:55:41.010894 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m10:55:41.011085 [info ] [MainThread]: 
[0m10:55:41.011309 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m10:55:41.013390 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.693649, "process_in_blocks": "0", "process_kernel_time": 0.40046, "process_mem_max_rss": "152731648", "process_out_blocks": "0", "process_user_time": 2.890461}
[0m10:55:41.013692 [debug] [MainThread]: Command `dbt run` failed at 10:55:41.013632 after 9.69 seconds
[0m10:55:41.013977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107820a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d369d0>]}
[0m10:55:41.014242 [debug] [MainThread]: Flushing usage events
[0m10:55:41.348425 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:59:58.764126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033cb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104467730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104467a60>]}


============================== 10:59:58.770015 | 3e17f91f-5cbe-4c25-a0a2-9893df9a2449 ==============================
[0m10:59:58.770015 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:59:58.770754 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'empty': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt run --select stg_youtube_videos', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'quiet': 'False', 'profiles_dir': '/Users/luc/.dbt', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False'}
[0m10:59:59.196445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e17f91f-5cbe-4c25-a0a2-9893df9a2449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105638a90>]}
[0m10:59:59.231254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e17f91f-5cbe-4c25-a0a2-9893df9a2449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055d3c40>]}
[0m10:59:59.231888 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:59:59.332169 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:59:59.432288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:59:59.432695 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/staging/stg_youtube_videos.sql
[0m10:59:59.679421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e17f91f-5cbe-4c25-a0a2-9893df9a2449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e99d0>]}
[0m10:59:59.742494 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m10:59:59.744054 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m10:59:59.794869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e17f91f-5cbe-4c25-a0a2-9893df9a2449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dccd90>]}
[0m10:59:59.795227 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m10:59:59.795421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e17f91f-5cbe-4c25-a0a2-9893df9a2449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106926370>]}
[0m10:59:59.796075 [info ] [MainThread]: 
[0m10:59:59.796266 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:59:59.796423 [info ] [MainThread]: 
[0m10:59:59.796702 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:59:59.797173 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m10:59:59.804989 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m10:59:59.805186 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m10:59:59.805352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:01.179650 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.374 seconds
[0m11:00:01.183758 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m11:00:01.423776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m11:00:01.438934 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m11:00:01.439483 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m11:00:01.439849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:02.706799 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.267 seconds
[0m11:00:02.711457 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m11:00:02.903337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m11:00:02.910723 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m11:00:02.911394 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m11:00:02.911888 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:04.035672 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.123 seconds
[0m11:00:04.040902 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m11:00:04.280157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m11:00:04.287236 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m11:00:04.287918 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS limit 10000
[0m11:00:04.288433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:05.487050 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.198 seconds
[0m11:00:05.491126 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m11:00:05.683810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e17f91f-5cbe-4c25-a0a2-9893df9a2449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d6f820>]}
[0m11:00:05.687863 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.stg_youtube_videos
[0m11:00:05.688722 [info ] [Thread-1  ]: 1 of 1 START sql view model STAGING_STAGING.stg_youtube_videos ................. [RUN]
[0m11:00:05.689222 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now model.youtube_dbt_project.stg_youtube_videos)
[0m11:00:05.689571 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.stg_youtube_videos
[0m11:00:05.698966 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.stg_youtube_videos"
[0m11:00:05.699856 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.stg_youtube_videos
[0m11:00:05.721289 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.stg_youtube_videos"
[0m11:00:05.722950 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.stg_youtube_videos"
[0m11:00:05.723259 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.stg_youtube_videos"} */
create or replace   view MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
  
   as (
    
        
with source as (
        
    select
        video_id,
        country,
        title,
        channel_title,   
        category_id,
        trending_date,
        publish_time,
        tags,
        views,
        likes,
        dislikes,
        comment_count,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from MAGPIE_FINAL_PROJECT.RAW.RAW_YOUTUBE_TRENDING
        
),
        
cleaned as (  
        
    select
        video_id,
        country,
        title,
        channel_title,
        category_id,
        try_to_date(trending_date, 'YY.DD.MM') as trending_date,
        try_to_timestamp_ntz(publish_time)      as publish_ts,
        tags, 
        views::number            as views,
        likes::number            as likes,
        dislikes::number         as dislikes,
        comment_count::number    as comment_count,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from source
        
)
        
select * from cleaned
  );
[0m11:00:05.723530 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:00:06.825717 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.102 seconds
[0m11:00:06.863705 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: Close
[0m11:00:07.058272 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e17f91f-5cbe-4c25-a0a2-9893df9a2449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a8820>]}
[0m11:00:07.059783 [info ] [Thread-1  ]: 1 of 1 OK created sql view model STAGING_STAGING.stg_youtube_videos ............ [[32mSUCCESS 1[0m in 1.36s]
[0m11:00:07.060783 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.stg_youtube_videos
[0m11:00:07.062476 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:00:07.062945 [debug] [MainThread]: Connection 'model.youtube_dbt_project.stg_youtube_videos' was properly closed.
[0m11:00:07.063418 [info ] [MainThread]: 
[0m11:00:07.063916 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.27 seconds (7.27s).
[0m11:00:07.064966 [debug] [MainThread]: Command end result
[0m11:00:07.105593 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m11:00:07.109344 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m11:00:07.116132 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m11:00:07.116487 [info ] [MainThread]: 
[0m11:00:07.116840 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:00:07.117080 [info ] [MainThread]: 
[0m11:00:07.117400 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:00:07.119709 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.406814, "process_in_blocks": "0", "process_kernel_time": 0.375959, "process_mem_max_rss": "155762688", "process_out_blocks": "0", "process_user_time": 3.198438}
[0m11:00:07.120114 [debug] [MainThread]: Command `dbt run` succeeded at 11:00:07.120036 after 8.41 seconds
[0m11:00:07.120452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033cb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101b5c8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dcc9d0>]}
[0m11:00:07.120774 [debug] [MainThread]: Flushing usage events
[0m11:00:07.343404 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:00:08.527894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107510640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085ac790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085acac0>]}


============================== 11:00:08.530861 | 69a55cd3-2190-4f15-a3d1-e514f3f322f3 ==============================
[0m11:00:08.530861 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:00:08.531221 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'empty': 'False', 'quiet': 'False', 'static_parser': 'True', 'no_print': 'None', 'log_format': 'default', 'partial_parse': 'True', 'warn_error': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'write_json': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'introspect': 'True', 'invocation_command': 'dbt run --select fct_youtube_daily', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/luc/.dbt', 'printer_width': '80', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False'}
[0m11:00:08.836449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69a55cd3-2190-4f15-a3d1-e514f3f322f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109994820>]}
[0m11:00:08.870997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69a55cd3-2190-4f15-a3d1-e514f3f322f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e82250>]}
[0m11:00:08.871636 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:00:08.970041 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:00:09.066956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:00:09.067220 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:00:09.100066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69a55cd3-2190-4f15-a3d1-e514f3f322f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa41130>]}
[0m11:00:09.163225 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m11:00:09.164331 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m11:00:09.174847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69a55cd3-2190-4f15-a3d1-e514f3f322f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa461f0>]}
[0m11:00:09.175148 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m11:00:09.175348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69a55cd3-2190-4f15-a3d1-e514f3f322f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa64460>]}
[0m11:00:09.175971 [info ] [MainThread]: 
[0m11:00:09.176165 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:00:09.176324 [info ] [MainThread]: 
[0m11:00:09.176593 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:00:09.177042 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m11:00:09.185587 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m11:00:09.185777 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m11:00:09.185944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:10.592017 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.406 seconds
[0m11:00:10.595886 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m11:00:10.785713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m11:00:10.801202 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m11:00:10.801700 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m11:00:10.802100 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:13.495169 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.693 seconds
[0m11:00:13.499149 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m11:00:13.700453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m11:00:13.707502 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m11:00:13.708286 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m11:00:13.708777 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:14.642210 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.933 seconds
[0m11:00:14.647537 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m11:00:15.521760 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m11:00:15.530536 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m11:00:15.531226 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS limit 10000
[0m11:00:15.531730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:16.414646 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.883 seconds
[0m11:00:16.418441 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m11:00:17.020579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69a55cd3-2190-4f15-a3d1-e514f3f322f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099538b0>]}
[0m11:00:17.025912 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fct_youtube_daily
[0m11:00:17.026851 [info ] [Thread-1  ]: 1 of 1 START sql table model STAGING_STAGING_MARTS.fct_youtube_daily ........... [RUN]
[0m11:00:17.027611 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now model.youtube_dbt_project.fct_youtube_daily)
[0m11:00:17.028197 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.fct_youtube_daily
[0m11:00:17.042763 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.fct_youtube_daily"
[0m11:00:17.044440 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.fct_youtube_daily
[0m11:00:17.077101 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.fct_youtube_daily"
[0m11:00:17.078645 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.fct_youtube_daily"
[0m11:00:17.079004 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.fct_youtube_daily"} */
create or replace transient table MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS.fct_youtube_daily
         as
        (

with base as (

    select
        trending_date,
        country,
        category_id,
        count(*)           as video_count,
        sum(views)         as total_views,
        sum(likes)         as total_likes,
        sum(comment_count) as total_comments
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
    where trending_date is not null
    group by
        trending_date,
        country,
        category_id

)

select * from base
        );
[0m11:00:17.079325 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:00:19.427081 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e51c-0307-3356-000e-9ce300bd21ba
[0m11:00:19.427765 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'https://i.ytimg.com/vi/5nSlqLc7Y4A/default.jpg' is not recognized
[0m11:00:19.428410 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: Close
[0m11:00:20.087792 [debug] [Thread-1  ]: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/5nSlqLc7Y4A/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m11:00:20.090658 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a55cd3-2190-4f15-a3d1-e514f3f322f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be63310>]}
[0m11:00:20.091598 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model STAGING_STAGING_MARTS.fct_youtube_daily .. [[31mERROR[0m in 3.06s]
[0m11:00:20.092392 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fct_youtube_daily
[0m11:00:20.093054 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.fct_youtube_daily' to be skipped because of status 'error'.  Reason: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/5nSlqLc7Y4A/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql.
[0m11:00:20.094386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:00:20.094764 [debug] [MainThread]: Connection 'model.youtube_dbt_project.fct_youtube_daily' was properly closed.
[0m11:00:20.095133 [info ] [MainThread]: 
[0m11:00:20.095515 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.92 seconds (10.92s).
[0m11:00:20.096351 [debug] [MainThread]: Command end result
[0m11:00:20.128473 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m11:00:20.130246 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m11:00:20.135641 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m11:00:20.135897 [info ] [MainThread]: 
[0m11:00:20.136195 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:00:20.136441 [info ] [MainThread]: 
[0m11:00:20.136740 [error] [MainThread]: [31mFailure in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)[0m
[0m11:00:20.137020 [error] [MainThread]:   Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/5nSlqLc7Y4A/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m11:00:20.137222 [info ] [MainThread]: 
[0m11:00:20.137461 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m11:00:20.137654 [info ] [MainThread]: 
[0m11:00:20.137875 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m11:00:20.139111 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.656575, "process_in_blocks": "0", "process_kernel_time": 0.255957, "process_mem_max_rss": "159055872", "process_out_blocks": "0", "process_user_time": 2.874942}
[0m11:00:20.139388 [debug] [MainThread]: Command `dbt run` failed at 11:00:20.139332 after 11.66 seconds
[0m11:00:20.139646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107510640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa46550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077b8f10>]}
[0m11:00:20.139918 [debug] [MainThread]: Flushing usage events
[0m11:00:20.324329 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:03:28.560205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a8f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a8fa60>]}


============================== 11:03:28.563479 | 24c0cc08-6966-4bab-8013-27edae08a6ef ==============================
[0m11:03:28.563479 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:03:28.563849 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'write_json': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select fct_youtube_daily', 'fail_fast': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'debug': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'empty': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'profiles_dir': '/Users/luc/.dbt', 'quiet': 'False', 'printer_width': '80'}
[0m11:03:28.902495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24c0cc08-6966-4bab-8013-27edae08a6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c60a90>]}
[0m11:03:28.936966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24c0cc08-6966-4bab-8013-27edae08a6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bfbc40>]}
[0m11:03:28.937475 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:03:29.036234 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:03:29.135954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:03:29.136336 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/marts/fct_youtube_daily.sql
[0m11:03:29.299393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24c0cc08-6966-4bab-8013-27edae08a6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a369130>]}
[0m11:03:29.362870 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m11:03:29.364164 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m11:03:29.374981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24c0cc08-6966-4bab-8013-27edae08a6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a374d00>]}
[0m11:03:29.375278 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m11:03:29.375476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24c0cc08-6966-4bab-8013-27edae08a6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a350b50>]}
[0m11:03:29.376110 [info ] [MainThread]: 
[0m11:03:29.376307 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:03:29.376463 [info ] [MainThread]: 
[0m11:03:29.376736 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:03:29.377177 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m11:03:29.384932 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m11:03:29.385131 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m11:03:29.385295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:30.889860 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.504 seconds
[0m11:03:30.894255 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m11:03:31.129384 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m11:03:31.145056 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m11:03:31.145575 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS limit 10000
[0m11:03:31.145984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:03:32.279177 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.133 seconds
[0m11:03:32.283417 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m11:03:32.575669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m11:03:32.593275 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m11:03:32.595409 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m11:03:32.595936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:03:33.847039 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.250 seconds
[0m11:03:33.854592 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m11:03:34.060205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m11:03:34.071584 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m11:03:34.072417 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m11:03:34.072959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:03:35.225386 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.152 seconds
[0m11:03:35.230256 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m11:03:35.435104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24c0cc08-6966-4bab-8013-27edae08a6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106470fd0>]}
[0m11:03:35.441058 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fct_youtube_daily
[0m11:03:35.442147 [info ] [Thread-1  ]: 1 of 1 START sql table model STAGING_STAGING_MARTS.fct_youtube_daily ........... [RUN]
[0m11:03:35.442939 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now model.youtube_dbt_project.fct_youtube_daily)
[0m11:03:35.443611 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.fct_youtube_daily
[0m11:03:35.458933 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.fct_youtube_daily"
[0m11:03:35.460154 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.fct_youtube_daily
[0m11:03:35.491550 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.fct_youtube_daily"
[0m11:03:35.492961 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.fct_youtube_daily"
[0m11:03:35.493306 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.fct_youtube_daily"} */
create or replace transient table MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS.fct_youtube_daily
         as
        (
        
with base as (
    select  
        trending_date,
        country,
        category_id,
        count(*)           as video_count,
        sum(views)         as total_views,
        sum(likes)         as total_likes,
        sum(comment_count) as total_comments
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
    where trending_date is not null
    group by
        trending_date,
        country,
        category_id 
)
        
select 
    trending_date,
    country,
    category_id,
    video_count,
    total_views,
    total_likes,
    total_comments
from base
        );
[0m11:03:35.493619 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:03:37.706273 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e51f-0307-3743-000e-9ce300bd3122
[0m11:03:37.706947 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
[0m11:03:37.707565 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: Close
[0m11:03:38.050050 [debug] [Thread-1  ]: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m11:03:38.053309 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24c0cc08-6966-4bab-8013-27edae08a6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9a4d30>]}
[0m11:03:38.054307 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model STAGING_STAGING_MARTS.fct_youtube_daily .. [[31mERROR[0m in 2.61s]
[0m11:03:38.055132 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fct_youtube_daily
[0m11:03:38.055896 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.fct_youtube_daily' to be skipped because of status 'error'.  Reason: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql.
[0m11:03:38.057365 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:03:38.057769 [debug] [MainThread]: Connection 'model.youtube_dbt_project.fct_youtube_daily' was properly closed.
[0m11:03:38.058179 [info ] [MainThread]: 
[0m11:03:38.058582 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.68 seconds (8.68s).
[0m11:03:38.059521 [debug] [MainThread]: Command end result
[0m11:03:38.095214 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m11:03:38.097174 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m11:03:38.102757 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m11:03:38.103002 [info ] [MainThread]: 
[0m11:03:38.103280 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:03:38.103504 [info ] [MainThread]: 
[0m11:03:38.103792 [error] [MainThread]: [31mFailure in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)[0m
[0m11:03:38.104055 [error] [MainThread]:   Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m11:03:38.104256 [info ] [MainThread]: 
[0m11:03:38.104493 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m11:03:38.104685 [info ] [MainThread]: 
[0m11:03:38.104914 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m11:03:38.106955 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.593116, "process_in_blocks": "0", "process_kernel_time": 0.376691, "process_mem_max_rss": "160366592", "process_out_blocks": "0", "process_user_time": 3.018473}
[0m11:03:38.107279 [debug] [MainThread]: Command `dbt run` failed at 11:03:38.107219 after 9.59 seconds
[0m11:03:38.107585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a079310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0799a0>]}
[0m11:03:38.107861 [debug] [MainThread]: Flushing usage events
[0m11:03:38.347580 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:05:58.288774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10394c640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e8790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e8ac0>]}


============================== 11:05:58.291955 | f31f0e06-9b00-451a-932c-068d951f83aa ==============================
[0m11:05:58.291955 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:05:58.292303 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'use_experimental_parser': 'False', 'static_parser': 'True', 'introspect': 'True', 'empty': 'False', 'invocation_command': 'dbt run --select stg_youtube_videos', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'target_path': 'None', 'printer_width': '80', 'quiet': 'False', 'profiles_dir': '/Users/luc/.dbt', 'use_colors': 'True', 'no_print': 'None', 'debug': 'False', 'version_check': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False'}
[0m11:05:58.626451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f31f0e06-9b00-451a-932c-068d951f83aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b94820>]}
[0m11:05:58.660609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f31f0e06-9b00-451a-932c-068d951f83aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042be250>]}
[0m11:05:58.661149 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:05:58.759766 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:05:58.860149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:05:58.860399 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:05:58.893365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f31f0e06-9b00-451a-932c-068d951f83aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106110130>]}
[0m11:05:58.958084 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m11:05:58.959601 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m11:05:58.970366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f31f0e06-9b00-451a-932c-068d951f83aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060fa520>]}
[0m11:05:58.970672 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m11:05:58.970881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f31f0e06-9b00-451a-932c-068d951f83aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eeef70>]}
[0m11:05:58.971510 [info ] [MainThread]: 
[0m11:05:58.971707 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:05:58.971863 [info ] [MainThread]: 
[0m11:05:58.972138 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:05:58.972588 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m11:05:58.981167 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m11:05:58.981366 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m11:05:58.981533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:00.436088 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.454 seconds
[0m11:06:00.440803 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m11:06:00.758972 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m11:06:00.773588 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m11:06:00.774041 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m11:06:00.774383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:06:01.749210 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.974 seconds
[0m11:06:01.755035 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m11:06:02.010987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m11:06:02.016635 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m11:06:02.017240 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS limit 10000
[0m11:06:02.017751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:06:03.245255 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.227 seconds
[0m11:06:03.248233 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m11:06:03.446110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m11:06:03.454628 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m11:06:03.455388 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m11:06:03.455894 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:06:04.706610 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.250 seconds
[0m11:06:04.711731 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m11:06:04.930846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f31f0e06-9b00-451a-932c-068d951f83aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a9c490>]}
[0m11:06:04.935433 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.stg_youtube_videos
[0m11:06:04.936358 [info ] [Thread-1  ]: 1 of 1 START sql view model STAGING_STAGING.stg_youtube_videos ................. [RUN]
[0m11:06:04.937083 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now model.youtube_dbt_project.stg_youtube_videos)
[0m11:06:04.937680 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.stg_youtube_videos
[0m11:06:04.952134 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.stg_youtube_videos"
[0m11:06:04.953816 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.stg_youtube_videos
[0m11:06:04.983834 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.stg_youtube_videos"
[0m11:06:04.985752 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.stg_youtube_videos"
[0m11:06:04.986123 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.stg_youtube_videos"} */
create or replace   view MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
  
   as (
    
        
with source as (
        
    select
        video_id,
        country,
        title,
        channel_title,   
        category_id,
        trending_date,
        publish_time,
        tags,
        views,
        likes,
        dislikes,
        comment_count,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from MAGPIE_FINAL_PROJECT.RAW.RAW_YOUTUBE_TRENDING
        
),
        
cleaned as (  
        
    select
        video_id,
        country,
        title,
        channel_title,
        category_id,
        try_to_date(trending_date, 'YY.DD.MM') as trending_date,
        try_to_timestamp_ntz(publish_time)      as publish_ts,
        tags, 
        views::number            as views,
        likes::number            as likes,
        dislikes::number         as dislikes,
        comment_count::number    as comment_count,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from source
        
)
        
select * from cleaned
  );
[0m11:06:04.986459 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:06:06.093874 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.107 seconds
[0m11:06:06.131703 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: Close
[0m11:06:06.345621 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f31f0e06-9b00-451a-932c-068d951f83aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a6c430>]}
[0m11:06:06.346994 [info ] [Thread-1  ]: 1 of 1 OK created sql view model STAGING_STAGING.stg_youtube_videos ............ [[32mSUCCESS 1[0m in 1.40s]
[0m11:06:06.347986 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.stg_youtube_videos
[0m11:06:06.349677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:06:06.350225 [debug] [MainThread]: Connection 'model.youtube_dbt_project.stg_youtube_videos' was properly closed.
[0m11:06:06.350715 [info ] [MainThread]: 
[0m11:06:06.351198 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.38 seconds (7.38s).
[0m11:06:06.352253 [debug] [MainThread]: Command end result
[0m11:06:06.389554 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m11:06:06.391477 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m11:06:06.397458 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m11:06:06.397714 [info ] [MainThread]: 
[0m11:06:06.398025 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:06:06.398252 [info ] [MainThread]: 
[0m11:06:06.398493 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:06:06.400231 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.157059, "process_in_blocks": "0", "process_kernel_time": 0.289359, "process_mem_max_rss": "157908992", "process_out_blocks": "0", "process_user_time": 2.913403}
[0m11:06:06.400534 [debug] [MainThread]: Command `dbt run` succeeded at 11:06:06.400470 after 8.16 seconds
[0m11:06:06.400806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10394c640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e6f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bf1340>]}
[0m11:06:06.401098 [debug] [MainThread]: Flushing usage events
[0m11:06:06.689816 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:06:07.772116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d50610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106deb640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106deb970>]}


============================== 11:06:07.775111 | 16c44641-7dfc-4a2e-b76d-b81b761afba2 ==============================
[0m11:06:07.775111 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:06:07.775444 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'quiet': 'False', 'target_path': 'None', 'write_json': 'True', 'static_parser': 'True', 'use_colors': 'True', 'profiles_dir': '/Users/luc/.dbt', 'warn_error': 'None', 'invocation_command': 'dbt run --select fct_youtube_daily', 'use_experimental_parser': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'debug': 'False', 'cache_selected_only': 'False', 'empty': 'False', 'version_check': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'printer_width': '80', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m11:06:08.023235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16c44641-7dfc-4a2e-b76d-b81b761afba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc33a0>]}
[0m11:06:08.057266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16c44641-7dfc-4a2e-b76d-b81b761afba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e70400>]}
[0m11:06:08.057697 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:06:08.151197 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:06:08.238493 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:06:08.238746 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:06:08.271129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16c44641-7dfc-4a2e-b76d-b81b761afba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108515130>]}
[0m11:06:08.335961 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m11:06:08.337114 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m11:06:08.343788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16c44641-7dfc-4a2e-b76d-b81b761afba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10814e910>]}
[0m11:06:08.344095 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m11:06:08.344290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16c44641-7dfc-4a2e-b76d-b81b761afba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10853f460>]}
[0m11:06:08.344941 [info ] [MainThread]: 
[0m11:06:08.345135 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:06:08.345292 [info ] [MainThread]: 
[0m11:06:08.345562 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:06:08.346003 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m11:06:08.354691 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m11:06:08.354888 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m11:06:08.355054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:09.411240 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.056 seconds
[0m11:06:09.415638 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m11:06:09.634539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m11:06:09.649427 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m11:06:09.649883 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m11:06:09.650231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:06:10.533453 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.883 seconds
[0m11:06:10.538848 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m11:06:10.726686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m11:06:10.734103 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m11:06:10.734704 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS limit 10000
[0m11:06:10.735187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:06:11.623444 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.888 seconds
[0m11:06:11.628193 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m11:06:11.832273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m11:06:11.840942 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m11:06:11.841547 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m11:06:11.842037 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:06:12.731957 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.890 seconds
[0m11:06:12.736775 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m11:06:12.921973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16c44641-7dfc-4a2e-b76d-b81b761afba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ccfd0>]}
[0m11:06:12.926764 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fct_youtube_daily
[0m11:06:12.927877 [info ] [Thread-1  ]: 1 of 1 START sql table model STAGING_STAGING_MARTS.fct_youtube_daily ........... [RUN]
[0m11:06:12.928699 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now model.youtube_dbt_project.fct_youtube_daily)
[0m11:06:12.929297 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.fct_youtube_daily
[0m11:06:12.944295 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.fct_youtube_daily"
[0m11:06:12.946265 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.fct_youtube_daily
[0m11:06:12.978165 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.fct_youtube_daily"
[0m11:06:12.979487 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.fct_youtube_daily"
[0m11:06:12.979825 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.fct_youtube_daily"} */
create or replace transient table MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS.fct_youtube_daily
         as
        (
        
with base as (
    select  
        trending_date,
        country,
        category_id,
        count(*)           as video_count,
        sum(views)         as total_views,
        sum(likes)         as total_likes,
        sum(comment_count) as total_comments
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
    where trending_date is not null
    group by
        trending_date,
        country,
        category_id 
)
        
select 
    trending_date,
    country,
    category_id,
    video_count,
    total_views,
    total_likes,
    total_comments
from base
        );
[0m11:06:12.980134 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:06:15.034933 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e522-0307-3709-000e-9ce300bcd75e
[0m11:06:15.035666 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
[0m11:06:15.036319 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: Close
[0m11:06:15.232939 [debug] [Thread-1  ]: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m11:06:15.236627 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16c44641-7dfc-4a2e-b76d-b81b761afba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106041af0>]}
[0m11:06:15.237583 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model STAGING_STAGING_MARTS.fct_youtube_daily .. [[31mERROR[0m in 2.31s]
[0m11:06:15.238409 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fct_youtube_daily
[0m11:06:15.239066 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.fct_youtube_daily' to be skipped because of status 'error'.  Reason: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql.
[0m11:06:15.240368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:06:15.240740 [debug] [MainThread]: Connection 'model.youtube_dbt_project.fct_youtube_daily' was properly closed.
[0m11:06:15.241107 [info ] [MainThread]: 
[0m11:06:15.241490 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.90 seconds (6.90s).
[0m11:06:15.242329 [debug] [MainThread]: Command end result
[0m11:06:15.274116 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m11:06:15.275573 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m11:06:15.281067 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m11:06:15.281348 [info ] [MainThread]: 
[0m11:06:15.281631 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:06:15.281854 [info ] [MainThread]: 
[0m11:06:15.282117 [error] [MainThread]: [31mFailure in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)[0m
[0m11:06:15.282388 [error] [MainThread]:   Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m11:06:15.282584 [info ] [MainThread]: 
[0m11:06:15.282816 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m11:06:15.283006 [info ] [MainThread]: 
[0m11:06:15.283220 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m11:06:15.284474 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.552414, "process_in_blocks": "0", "process_kernel_time": 0.227933, "process_mem_max_rss": "162447360", "process_out_blocks": "0", "process_user_time": 2.881147}
[0m11:06:15.284748 [debug] [MainThread]: Command `dbt run` failed at 11:06:15.284691 after 7.55 seconds
[0m11:06:15.285003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d50610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f68eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10601fdf0>]}
[0m11:06:15.285261 [debug] [MainThread]: Flushing usage events
[0m11:06:15.470337 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:27:25.990385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056505b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e9550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e9880>]}


============================== 11:27:25.994202 | 91436014-a8a7-4073-8b38-1face67c3ff0 ==============================
[0m11:27:25.994202 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:27:25.994565 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_cache_events': 'False', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'indirect_selection': 'eager', 'use_colors': 'True', 'static_parser': 'True', 'write_json': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/luc/.dbt', 'partial_parse': 'True', 'invocation_command': 'dbt debug', 'quiet': 'False', 'debug': 'False', 'empty': 'None', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'version_check': 'True', 'log_format': 'default', 'target_path': 'None'}
[0m11:27:26.004552 [info ] [MainThread]: dbt version: 1.10.13
[0m11:27:26.004788 [info ] [MainThread]: python version: 3.9.6
[0m11:27:26.004961 [info ] [MainThread]: python path: /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/magpie_youtube/.venv_dbt/bin/python3
[0m11:27:26.005128 [info ] [MainThread]: os info: macOS-14.4.1-arm64-arm-64bit
[0m11:27:26.330726 [info ] [MainThread]: Using profiles dir at /Users/luc/.dbt
[0m11:27:26.331036 [info ] [MainThread]: Using profiles.yml file at /Users/luc/.dbt/profiles.yml
[0m11:27:26.331212 [info ] [MainThread]: Using dbt_project.yml file at /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/dbt_project.yml
[0m11:27:26.331789 [info ] [MainThread]: adapter type: snowflake
[0m11:27:26.331959 [info ] [MainThread]: adapter version: 1.8.4
[0m11:27:26.394316 [info ] [MainThread]: Configuration:
[0m11:27:26.394607 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:27:26.394778 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:27:26.394931 [info ] [MainThread]: Required dependencies:
[0m11:27:26.395149 [debug] [MainThread]: Executing "git --help"
[0m11:27:26.411780 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:27:26.412393 [debug] [MainThread]: STDERR: "b''"
[0m11:27:26.412624 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:27:26.412828 [info ] [MainThread]: Connection:
[0m11:27:26.413043 [info ] [MainThread]:   account: azb79167
[0m11:27:26.413197 [info ] [MainThread]:   user: MAGPIE
[0m11:27:26.413345 [info ] [MainThread]:   database: MAGPIE_FINAL_PROJECT
[0m11:27:26.413490 [info ] [MainThread]:   warehouse: TRAINING_WH
[0m11:27:26.413634 [info ] [MainThread]:   role: TRAINING_ROLE
[0m11:27:26.413777 [info ] [MainThread]:   schema: STAGING
[0m11:27:26.413922 [info ] [MainThread]:   authenticator: None
[0m11:27:26.414065 [info ] [MainThread]:   oauth_client_id: None
[0m11:27:26.414206 [info ] [MainThread]:   query_tag: None
[0m11:27:26.414348 [info ] [MainThread]:   client_session_keep_alive: False
[0m11:27:26.414489 [info ] [MainThread]:   host: None
[0m11:27:26.414630 [info ] [MainThread]:   port: None
[0m11:27:26.414771 [info ] [MainThread]:   proxy_host: None
[0m11:27:26.414913 [info ] [MainThread]:   proxy_port: None
[0m11:27:26.415054 [info ] [MainThread]:   protocol: None
[0m11:27:26.415195 [info ] [MainThread]:   connect_retries: 1
[0m11:27:26.415337 [info ] [MainThread]:   connect_timeout: None
[0m11:27:26.415482 [info ] [MainThread]:   retry_on_database_errors: False
[0m11:27:26.415624 [info ] [MainThread]:   retry_all: False
[0m11:27:26.415765 [info ] [MainThread]:   insecure_mode: False
[0m11:27:26.415906 [info ] [MainThread]:   reuse_connections: None
[0m11:27:26.416358 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:27:26.521634 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m11:27:26.522260 [debug] [MainThread]: Using snowflake connection "debug"
[0m11:27:26.522437 [debug] [MainThread]: On debug: select 1 as id
[0m11:27:26.522593 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:27:28.037712 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.515 seconds
[0m11:27:28.039472 [debug] [MainThread]: On debug: Close
[0m11:27:28.293566 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:27:28.294289 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:27:28.297255 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.3557906, "process_in_blocks": "0", "process_kernel_time": 0.304383, "process_mem_max_rss": "146735104", "process_out_blocks": "0", "process_user_time": 1.355295}
[0m11:27:28.298076 [debug] [MainThread]: Command `dbt debug` succeeded at 11:27:28.297904 after 2.36 seconds
[0m11:27:28.298586 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:27:28.299153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056505b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a013d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10591fb80>]}
[0m11:27:28.299594 [debug] [MainThread]: Flushing usage events
[0m11:27:28.578868 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:28:49.833700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052fc5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063977c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106397af0>]}


============================== 11:28:49.836946 | a29b1b64-c4d8-4e36-a85a-9c67e7bba422 ==============================
[0m11:28:49.836946 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:28:49.837305 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'partial_parse': 'False', 'write_json': 'True', 'invocation_command': 'dbt run --select fct_youtube_daily --no-partial-parse', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'introspect': 'True', 'printer_width': '80', 'static_parser': 'True', 'target_path': 'None', 'empty': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'use_colors': 'True', 'version_check': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'profiles_dir': '/Users/luc/.dbt', 'log_cache_events': 'False'}
[0m11:28:50.176490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a29b1b64-c4d8-4e36-a85a-9c67e7bba422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10754d970>]}
[0m11:28:50.210831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a29b1b64-c4d8-4e36-a85a-9c67e7bba422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10741c4c0>]}
[0m11:28:50.211366 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:28:50.309796 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:28:50.310291 [debug] [MainThread]: Partial parsing not enabled
[0m11:28:51.073293 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m11:28:51.073621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a29b1b64-c4d8-4e36-a85a-9c67e7bba422', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a84850>]}
[0m11:28:51.108349 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_stg_weather_datetime.554d39b0ed' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m11:28:51.108652 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.unique_stg_weather_datetime.ea99166edf' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m11:28:51.108833 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_stg_weather_temperature_2m.4552381acc' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m11:28:51.108999 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.accepted_values_stg_weather_city__Chicago__Evanston__Aurora.3a5db1bdc4' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m11:28:51.109164 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_datetime.36fca5f850' (models/marts/schema.yml) depends on a node named 'fact_weather' which is disabled
[0m11:28:51.109320 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.unique_fact_weather_datetime.f553e65bbe' (models/marts/schema.yml) depends on a node named 'fact_weather' which is disabled
[0m11:28:51.109520 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_feels_like.cf8e8e9258' (models/marts/schema.yml) depends on a node named 'fact_weather' which is disabled
[0m11:28:51.109730 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_daily_date.b304b6aad7' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m11:28:51.109903 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.unique_fact_weather_daily_date.1ee454b4b0' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m11:28:51.110069 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_daily_avg_temperature.c0f9fdc06f' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m11:28:51.110225 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.accepted_values_fact_weather_daily_hourly_records__24.a8a2f8b558' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m11:28:51.169584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a29b1b64-c4d8-4e36-a85a-9c67e7bba422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10882a130>]}
[0m11:28:51.233415 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m11:28:51.235073 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m11:28:51.246117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a29b1b64-c4d8-4e36-a85a-9c67e7bba422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108829b50>]}
[0m11:28:51.246410 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m11:28:51.246600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a29b1b64-c4d8-4e36-a85a-9c67e7bba422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088856d0>]}
[0m11:28:51.247252 [info ] [MainThread]: 
[0m11:28:51.247440 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:28:51.247598 [info ] [MainThread]: 
[0m11:28:51.247866 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:28:51.248309 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m11:28:51.256201 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m11:28:51.256396 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m11:28:51.256559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:28:53.270587 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 2.014 seconds
[0m11:28:53.273808 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m11:28:53.464525 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m11:28:53.478407 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m11:28:53.479014 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS limit 10000
[0m11:28:53.479433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:28:54.683026 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.203 seconds
[0m11:28:54.688946 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m11:28:54.885041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m11:28:54.892077 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m11:28:54.892935 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m11:28:54.893463 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:28:56.017447 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.124 seconds
[0m11:28:56.022434 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m11:28:56.211869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m11:28:56.218305 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m11:28:56.218908 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m11:28:56.219413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:28:57.566349 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.347 seconds
[0m11:28:57.571047 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m11:28:57.762821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a29b1b64-c4d8-4e36-a85a-9c67e7bba422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c516d0>]}
[0m11:28:57.767383 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fct_youtube_daily
[0m11:28:57.768263 [info ] [Thread-1  ]: 1 of 1 START sql table model STAGING_STAGING_MARTS.fct_youtube_daily ........... [RUN]
[0m11:28:57.768997 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now model.youtube_dbt_project.fct_youtube_daily)
[0m11:28:57.769580 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.fct_youtube_daily
[0m11:28:57.783431 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.fct_youtube_daily"
[0m11:28:57.784548 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.fct_youtube_daily
[0m11:28:57.816096 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.fct_youtube_daily"
[0m11:28:57.817783 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.fct_youtube_daily"
[0m11:28:57.818128 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.fct_youtube_daily"} */
create or replace transient table MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS.fct_youtube_daily
         as
        (
        
with base as (
    select  
        trending_date,
        country,
        category_id,
        count(*)           as video_count,
        sum(views)         as total_views,
        sum(likes)         as total_likes,
        sum(comment_count) as total_comments
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
    where trending_date is not null
    group by
        trending_date,
        country,
        category_id 
)
        
select 
    trending_date,
    country,
    category_id,
    video_count,
    total_views,
    total_likes,
    total_comments
from base
        );
[0m11:28:57.818438 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:29:00.048158 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e538-0307-33da-000e-9ce300bcc832
[0m11:29:00.048913 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
[0m11:29:00.049579 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: Close
[0m11:29:00.237297 [debug] [Thread-1  ]: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m11:29:00.240167 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a29b1b64-c4d8-4e36-a85a-9c67e7bba422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d80580>]}
[0m11:29:00.241121 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model STAGING_STAGING_MARTS.fct_youtube_daily .. [[31mERROR[0m in 2.47s]
[0m11:29:00.241922 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fct_youtube_daily
[0m11:29:00.242583 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.fct_youtube_daily' to be skipped because of status 'error'.  Reason: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql.
[0m11:29:00.243999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:29:00.244446 [debug] [MainThread]: Connection 'model.youtube_dbt_project.fct_youtube_daily' was properly closed.
[0m11:29:00.244855 [info ] [MainThread]: 
[0m11:29:00.245252 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.00 seconds (9.00s).
[0m11:29:00.245998 [debug] [MainThread]: Command end result
[0m11:29:00.277000 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m11:29:00.278448 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m11:29:00.283980 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m11:29:00.284228 [info ] [MainThread]: 
[0m11:29:00.284497 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:29:00.284717 [info ] [MainThread]: 
[0m11:29:00.284978 [error] [MainThread]: [31mFailure in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)[0m
[0m11:29:00.285237 [error] [MainThread]:   Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m11:29:00.285435 [info ] [MainThread]: 
[0m11:29:00.285667 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m11:29:00.285866 [info ] [MainThread]: 
[0m11:29:00.286078 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m11:29:00.286441 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:29:00.288065 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.499636, "process_in_blocks": "0", "process_kernel_time": 0.348235, "process_mem_max_rss": "167198720", "process_out_blocks": "0", "process_user_time": 3.661196}
[0m11:29:00.288344 [debug] [MainThread]: Command `dbt run` failed at 11:29:00.288285 after 10.50 seconds
[0m11:29:00.288600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052fc5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088298e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107503df0>]}
[0m11:29:00.288862 [debug] [MainThread]: Flushing usage events
[0m11:29:00.628968 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:34:34.421097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e4520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a8b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a8b970>]}


============================== 11:34:34.424245 | 13ea5854-af80-405a-aa01-cc6c8d0becd6 ==============================
[0m11:34:34.424245 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:34:34.424620 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'version_check': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'partial_parse': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run --select fct_youtube_daily --no-partial-parse', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'target_path': 'None', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'debug': 'False', 'printer_width': '80', 'write_json': 'True', 'use_colors': 'True', 'profiles_dir': '/Users/luc/.dbt'}
[0m11:34:34.774562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13ea5854-af80-405a-aa01-cc6c8d0becd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b08220>]}
[0m11:34:34.809610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13ea5854-af80-405a-aa01-cc6c8d0becd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b5d90>]}
[0m11:34:34.810184 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:34:34.910551 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:34:34.911056 [debug] [MainThread]: Partial parsing not enabled
[0m11:34:35.666895 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m11:34:35.667233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '13ea5854-af80-405a-aa01-cc6c8d0becd6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a1ae50>]}
[0m11:34:35.701987 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_stg_weather_datetime.554d39b0ed' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m11:34:35.702258 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.unique_stg_weather_datetime.ea99166edf' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m11:34:35.702433 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_stg_weather_temperature_2m.4552381acc' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m11:34:35.702598 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.accepted_values_stg_weather_city__Chicago__Evanston__Aurora.3a5db1bdc4' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m11:34:35.702755 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_datetime.36fca5f850' (models/marts/schema.yml) depends on a node named 'fact_weather' which is disabled
[0m11:34:35.702912 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.unique_fact_weather_datetime.f553e65bbe' (models/marts/schema.yml) depends on a node named 'fact_weather' which is disabled
[0m11:34:35.703071 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_feels_like.cf8e8e9258' (models/marts/schema.yml) depends on a node named 'fact_weather' which is disabled
[0m11:34:35.703226 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_daily_date.b304b6aad7' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m11:34:35.703388 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.unique_fact_weather_daily_date.1ee454b4b0' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m11:34:35.703598 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_daily_avg_temperature.c0f9fdc06f' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m11:34:35.703790 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.accepted_values_fact_weather_daily_hourly_records__24.a8a2f8b558' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m11:34:35.763564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13ea5854-af80-405a-aa01-cc6c8d0becd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ae6130>]}
[0m11:34:35.827464 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m11:34:35.829031 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m11:34:35.839936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13ea5854-af80-405a-aa01-cc6c8d0becd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ac41c0>]}
[0m11:34:35.840232 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m11:34:35.840423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13ea5854-af80-405a-aa01-cc6c8d0becd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ac7fd0>]}
[0m11:34:35.841065 [info ] [MainThread]: 
[0m11:34:35.841251 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:34:35.841408 [info ] [MainThread]: 
[0m11:34:35.841680 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:34:35.842117 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m11:34:35.849995 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m11:34:35.850188 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m11:34:35.850351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:37.395506 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.545 seconds
[0m11:34:37.399954 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m11:34:37.634806 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m11:34:37.649181 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m11:34:37.649629 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m11:34:37.649981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:34:38.850000 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.200 seconds
[0m11:34:38.854684 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m11:34:39.070820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m11:34:39.077714 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m11:34:39.078290 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m11:34:39.078784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:34:40.231308 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.152 seconds
[0m11:34:40.236824 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m11:34:40.438355 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m11:34:40.444959 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m11:34:40.445571 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS limit 10000
[0m11:34:40.446075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:34:41.652599 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.206 seconds
[0m11:34:41.657445 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m11:34:41.887188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13ea5854-af80-405a-aa01-cc6c8d0becd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f21eb0>]}
[0m11:34:41.892538 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fct_youtube_daily
[0m11:34:41.893543 [info ] [Thread-1  ]: 1 of 1 START sql table model STAGING_STAGING_MARTS.fct_youtube_daily ........... [RUN]
[0m11:34:41.894338 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now model.youtube_dbt_project.fct_youtube_daily)
[0m11:34:41.894954 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.fct_youtube_daily
[0m11:34:41.909565 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.fct_youtube_daily"
[0m11:34:41.911090 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.fct_youtube_daily
[0m11:34:41.943059 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.fct_youtube_daily"
[0m11:34:41.944461 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.fct_youtube_daily"
[0m11:34:41.944807 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.fct_youtube_daily"} */
create or replace transient table MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS.fct_youtube_daily
         as
        (
        
with base as (
    select  
        trending_date,
        country,
        category_id,
        count(*)           as video_count,
        sum(views)         as total_views,
        sum(likes)         as total_likes,
        sum(comment_count) as total_comments
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
    where trending_date is not null
    group by
        trending_date,
        country,
        category_id 
)
        
select 
    trending_date,
    country,
    category_id,
    video_count,
    total_views,
    total_likes,
    total_comments
from base
        );
[0m11:34:41.945118 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:34:43.997694 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e53e-0307-3356-000e-9ce300bd220e
[0m11:34:43.998619 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
[0m11:34:43.999311 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: Close
[0m11:34:44.232627 [debug] [Thread-1  ]: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m11:34:44.235283 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13ea5854-af80-405a-aa01-cc6c8d0becd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137b1610>]}
[0m11:34:44.236193 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model STAGING_STAGING_MARTS.fct_youtube_daily .. [[31mERROR[0m in 2.34s]
[0m11:34:44.236969 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fct_youtube_daily
[0m11:34:44.237609 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.fct_youtube_daily' to be skipped because of status 'error'.  Reason: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql.
[0m11:34:44.238960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:34:44.239436 [debug] [MainThread]: Connection 'model.youtube_dbt_project.fct_youtube_daily' was properly closed.
[0m11:34:44.239845 [info ] [MainThread]: 
[0m11:34:44.240261 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.40 seconds (8.40s).
[0m11:34:44.241146 [debug] [MainThread]: Command end result
[0m11:34:44.273167 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m11:34:44.274725 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m11:34:44.279974 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m11:34:44.280224 [info ] [MainThread]: 
[0m11:34:44.280516 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:34:44.280760 [info ] [MainThread]: 
[0m11:34:44.281059 [error] [MainThread]: [31mFailure in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)[0m
[0m11:34:44.281350 [error] [MainThread]:   Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m11:34:44.281574 [info ] [MainThread]: 
[0m11:34:44.281827 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m11:34:44.282023 [info ] [MainThread]: 
[0m11:34:44.282234 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m11:34:44.282617 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:34:44.284517 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.909146, "process_in_blocks": "0", "process_kernel_time": 0.345137, "process_mem_max_rss": "165036032", "process_out_blocks": "0", "process_user_time": 3.699636}
[0m11:34:44.284841 [debug] [MainThread]: Command `dbt run` failed at 11:34:44.284775 after 9.91 seconds
[0m11:34:44.285108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e4520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ac41f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105989ac0>]}
[0m11:34:44.285376 [debug] [MainThread]: Flushing usage events
[0m11:34:44.677067 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:36:44.575914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107833580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088cf610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088cf940>]}


============================== 11:36:44.579127 | f0c7e8d8-3d48-446f-b8a3-a9e658c44acc ==============================
[0m11:36:44.579127 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:36:44.579512 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'warn_error': 'None', 'partial_parse': 'False', 'version_check': 'True', 'empty': 'False', 'quiet': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/Users/luc/.dbt', 'static_parser': 'True', 'write_json': 'True', 'target_path': 'None', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'log_format': 'default', 'debug': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'invocation_command': 'dbt run --select fct_youtube_daily --no-partial-parse', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m11:36:44.915308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0c7e8d8-3d48-446f-b8a3-a9e658c44acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a4c730>]}
[0m11:36:44.949997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0c7e8d8-3d48-446f-b8a3-a9e658c44acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b63880>]}
[0m11:36:44.950536 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:36:45.049877 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:36:45.050513 [debug] [MainThread]: Partial parsing not enabled
[0m11:36:45.813890 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m11:36:45.814225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f0c7e8d8-3d48-446f-b8a3-a9e658c44acc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10795e640>]}
[0m11:36:45.849677 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_stg_weather_datetime.554d39b0ed' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m11:36:45.849970 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.unique_stg_weather_datetime.ea99166edf' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m11:36:45.850163 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_stg_weather_temperature_2m.4552381acc' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m11:36:45.850337 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.accepted_values_stg_weather_city__Chicago__Evanston__Aurora.3a5db1bdc4' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m11:36:45.850505 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_datetime.36fca5f850' (models/marts/schema.yml) depends on a node named 'fact_weather' which is disabled
[0m11:36:45.850668 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.unique_fact_weather_datetime.f553e65bbe' (models/marts/schema.yml) depends on a node named 'fact_weather' which is disabled
[0m11:36:45.850822 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_feels_like.cf8e8e9258' (models/marts/schema.yml) depends on a node named 'fact_weather' which is disabled
[0m11:36:45.850974 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_daily_date.b304b6aad7' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m11:36:45.851127 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.unique_fact_weather_daily_date.1ee454b4b0' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m11:36:45.851280 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_daily_avg_temperature.c0f9fdc06f' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m11:36:45.851430 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.accepted_values_fact_weather_daily_hourly_records__24.a8a2f8b558' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m11:36:45.910665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0c7e8d8-3d48-446f-b8a3-a9e658c44acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aea0130>]}
[0m11:36:45.974007 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m11:36:45.975269 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m11:36:45.986062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0c7e8d8-3d48-446f-b8a3-a9e658c44acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aea2cd0>]}
[0m11:36:45.986376 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m11:36:45.986569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0c7e8d8-3d48-446f-b8a3-a9e658c44acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adb9490>]}
[0m11:36:45.987211 [info ] [MainThread]: 
[0m11:36:45.987396 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:36:45.987553 [info ] [MainThread]: 
[0m11:36:45.987830 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:36:45.988279 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m11:36:45.996245 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m11:36:45.996455 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m11:36:45.996620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:47.306434 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.310 seconds
[0m11:36:47.309793 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m11:36:47.505568 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m11:36:47.520501 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m11:36:47.521039 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m11:36:47.521375 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:36:48.697759 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.176 seconds
[0m11:36:48.704058 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m11:36:48.893655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m11:36:48.896556 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m11:36:48.896805 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS limit 10000
[0m11:36:48.897014 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:36:50.087993 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.191 seconds
[0m11:36:50.093853 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m11:36:50.275552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m11:36:50.282882 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m11:36:50.283545 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m11:36:50.284022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:36:51.414545 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.130 seconds
[0m11:36:51.419832 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m11:36:51.617661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0c7e8d8-3d48-446f-b8a3-a9e658c44acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d58b80>]}
[0m11:36:51.623460 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fct_youtube_daily
[0m11:36:51.624528 [info ] [Thread-1  ]: 1 of 1 START sql table model STAGING_STAGING_MARTS.fct_youtube_daily ........... [RUN]
[0m11:36:51.625299 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now model.youtube_dbt_project.fct_youtube_daily)
[0m11:36:51.625897 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.fct_youtube_daily
[0m11:36:51.640354 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.fct_youtube_daily"
[0m11:36:51.641913 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.fct_youtube_daily
[0m11:36:51.674096 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.fct_youtube_daily"
[0m11:36:51.675718 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.fct_youtube_daily"
[0m11:36:51.676063 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.fct_youtube_daily"} */
create or replace transient table MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS.fct_youtube_daily
         as
        (
        
with base as (
    select  
        trending_date,
        country,
        category_id,
        count(*)           as video_count,
        sum(views)         as total_views,
        sum(likes)         as total_likes,
        sum(comment_count) as total_comments
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
    where trending_date is not null
    group by
        trending_date,
        country,
        category_id 
)
        
select 
    trending_date,
    country,
    category_id,
    video_count,
    total_views,
    total_likes,
    total_comments
from base
        );
[0m11:36:51.676382 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:36:53.737902 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e540-0307-335b-000e-9ce300bd02f2
[0m11:36:53.738616 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
[0m11:36:53.739260 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: Close
[0m11:36:53.953637 [debug] [Thread-1  ]: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m11:36:53.956541 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c7e8d8-3d48-446f-b8a3-a9e658c44acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf70670>]}
[0m11:36:53.957585 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model STAGING_STAGING_MARTS.fct_youtube_daily .. [[31mERROR[0m in 2.33s]
[0m11:36:53.958359 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fct_youtube_daily
[0m11:36:53.958933 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.fct_youtube_daily' to be skipped because of status 'error'.  Reason: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql.
[0m11:36:53.960154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:36:53.960532 [debug] [MainThread]: Connection 'model.youtube_dbt_project.fct_youtube_daily' was properly closed.
[0m11:36:53.960879 [info ] [MainThread]: 
[0m11:36:53.961236 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.97 seconds (7.97s).
[0m11:36:53.961990 [debug] [MainThread]: Command end result
[0m11:36:53.994325 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m11:36:53.996067 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m11:36:54.001433 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m11:36:54.001691 [info ] [MainThread]: 
[0m11:36:54.001995 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:36:54.002237 [info ] [MainThread]: 
[0m11:36:54.002526 [error] [MainThread]: [31mFailure in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)[0m
[0m11:36:54.002812 [error] [MainThread]:   Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m11:36:54.003030 [info ] [MainThread]: 
[0m11:36:54.003289 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m11:36:54.003501 [info ] [MainThread]: 
[0m11:36:54.003735 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m11:36:54.004144 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:36:54.005706 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.474569, "process_in_blocks": "0", "process_kernel_time": 0.327156, "process_mem_max_rss": "165855232", "process_out_blocks": "0", "process_user_time": 3.639021}
[0m11:36:54.005979 [debug] [MainThread]: Command `dbt run` failed at 11:36:54.005921 after 9.47 seconds
[0m11:36:54.006242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107833580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aea2250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b01a00>]}
[0m11:36:54.006499 [debug] [MainThread]: Flushing usage events
[0m11:36:54.341391 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:37:01.131805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103023670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040bf850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040bfb80>]}


============================== 11:37:01.134706 | 93434825-b2d4-41c7-a4e5-8b5806242f15 ==============================
[0m11:37:01.134706 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:37:01.135055 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'fail_fast': 'False', 'printer_width': '80', 'partial_parse': 'False', 'invocation_command': 'dbt run --select fct_youtube_daily --no-partial-parse --debug', 'use_colors': 'True', 'write_json': 'True', 'log_format': 'default', 'profiles_dir': '/Users/luc/.dbt', 'version_check': 'True', 'quiet': 'False', 'no_print': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'debug': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None'}
[0m11:37:01.440558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93434825-b2d4-41c7-a4e5-8b5806242f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103961550>]}
[0m11:37:01.475190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93434825-b2d4-41c7-a4e5-8b5806242f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105154280>]}
[0m11:37:01.476290 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:37:01.578508 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:37:01.580398 [debug] [MainThread]: Partial parsing not enabled
[0m11:37:02.352684 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m11:37:02.353031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '93434825-b2d4-41c7-a4e5-8b5806242f15', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106486eb0>]}
[0m11:37:02.388477 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_stg_weather_datetime.554d39b0ed' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m11:37:02.388837 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.unique_stg_weather_datetime.ea99166edf' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m11:37:02.389036 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_stg_weather_temperature_2m.4552381acc' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m11:37:02.389221 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.accepted_values_stg_weather_city__Chicago__Evanston__Aurora.3a5db1bdc4' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m11:37:02.389398 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_datetime.36fca5f850' (models/marts/schema.yml) depends on a node named 'fact_weather' which is disabled
[0m11:37:02.389573 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.unique_fact_weather_datetime.f553e65bbe' (models/marts/schema.yml) depends on a node named 'fact_weather' which is disabled
[0m11:37:02.389741 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_feels_like.cf8e8e9258' (models/marts/schema.yml) depends on a node named 'fact_weather' which is disabled
[0m11:37:02.389913 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_daily_date.b304b6aad7' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m11:37:02.390081 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.unique_fact_weather_daily_date.1ee454b4b0' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m11:37:02.390247 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_daily_avg_temperature.c0f9fdc06f' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m11:37:02.390415 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.accepted_values_fact_weather_daily_hourly_records__24.a8a2f8b558' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m11:37:02.449307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93434825-b2d4-41c7-a4e5-8b5806242f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106550130>]}
[0m11:37:02.513648 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m11:37:02.514795 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m11:37:02.525517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93434825-b2d4-41c7-a4e5-8b5806242f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106509910>]}
[0m11:37:02.525850 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m11:37:02.526042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93434825-b2d4-41c7-a4e5-8b5806242f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ade50>]}
[0m11:37:02.526708 [info ] [MainThread]: 
[0m11:37:02.526901 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:37:02.527058 [info ] [MainThread]: 
[0m11:37:02.527325 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:37:02.527806 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m11:37:02.535814 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m11:37:02.536040 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m11:37:02.536228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:03.503812 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.967 seconds
[0m11:37:03.507590 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m11:37:03.715034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m11:37:03.729808 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m11:37:03.730300 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m11:37:03.730674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:37:04.662604 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.931 seconds
[0m11:37:04.667583 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m11:37:04.922808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m11:37:04.930750 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m11:37:04.931374 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS limit 10000
[0m11:37:04.931877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:37:05.835667 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.903 seconds
[0m11:37:05.840199 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m11:37:06.020270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m11:37:06.026899 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m11:37:06.027516 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m11:37:06.028045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:37:07.467206 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.439 seconds
[0m11:37:07.471690 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m11:37:07.689985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93434825-b2d4-41c7-a4e5-8b5806242f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101aa1fa0>]}
[0m11:37:07.694228 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fct_youtube_daily
[0m11:37:07.695230 [info ] [Thread-1  ]: 1 of 1 START sql table model STAGING_STAGING_MARTS.fct_youtube_daily ........... [RUN]
[0m11:37:07.695963 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now model.youtube_dbt_project.fct_youtube_daily)
[0m11:37:07.696607 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.fct_youtube_daily
[0m11:37:07.711617 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.fct_youtube_daily"
[0m11:37:07.713112 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.fct_youtube_daily
[0m11:37:07.746356 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.fct_youtube_daily"
[0m11:37:07.748051 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.fct_youtube_daily"
[0m11:37:07.748447 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.fct_youtube_daily"} */
create or replace transient table MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS.fct_youtube_daily
         as
        (
        
with base as (
    select  
        trending_date,
        country,
        category_id,
        count(*)           as video_count,
        sum(views)         as total_views,
        sum(likes)         as total_likes,
        sum(comment_count) as total_comments
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
    where trending_date is not null
    group by
        trending_date,
        country,
        category_id 
)
        
select 
    trending_date,
    country,
    category_id,
    video_count,
    total_views,
    total_likes,
    total_comments
from base
        );
[0m11:37:07.748795 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:37:09.398336 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e541-0307-3709-000e-9ce300bcd7a2
[0m11:37:09.399122 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'https://i.ytimg.com/vi/5nSlqLc7Y4A/default.jpg' is not recognized
[0m11:37:09.399795 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: Close
[0m11:37:09.643464 [debug] [Thread-1  ]: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/5nSlqLc7Y4A/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m11:37:09.646402 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93434825-b2d4-41c7-a4e5-8b5806242f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10580a340>]}
[0m11:37:09.647387 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model STAGING_STAGING_MARTS.fct_youtube_daily .. [[31mERROR[0m in 1.95s]
[0m11:37:09.648195 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fct_youtube_daily
[0m11:37:09.649018 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.fct_youtube_daily' to be skipped because of status 'error'.  Reason: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/5nSlqLc7Y4A/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql.
[0m11:37:09.650489 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:37:09.650909 [debug] [MainThread]: Connection 'model.youtube_dbt_project.fct_youtube_daily' was properly closed.
[0m11:37:09.651316 [info ] [MainThread]: 
[0m11:37:09.651702 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.12 seconds (7.12s).
[0m11:37:09.652453 [debug] [MainThread]: Command end result
[0m11:37:09.684217 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m11:37:09.685659 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m11:37:09.690859 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m11:37:09.691129 [info ] [MainThread]: 
[0m11:37:09.691388 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:37:09.691602 [info ] [MainThread]: 
[0m11:37:09.691869 [error] [MainThread]: [31mFailure in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)[0m
[0m11:37:09.692131 [error] [MainThread]:   Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/5nSlqLc7Y4A/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m11:37:09.692329 [info ] [MainThread]: 
[0m11:37:09.692568 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m11:37:09.692759 [info ] [MainThread]: 
[0m11:37:09.692973 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m11:37:09.693338 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:37:09.694935 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.611789, "process_in_blocks": "0", "process_kernel_time": 0.284159, "process_mem_max_rss": "165494784", "process_out_blocks": "0", "process_user_time": 3.643213}
[0m11:37:09.695236 [debug] [MainThread]: Command `dbt run` failed at 11:37:09.695175 after 8.61 seconds
[0m11:37:09.695512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103023670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1019d8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064c4670>]}
[0m11:37:09.695807 [debug] [MainThread]: Flushing usage events
[0m11:37:09.871626 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:11.163246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10308c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041275b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041278e0>]}


============================== 11:38:11.166892 | 5a11874b-30b7-4c61-ad73-1db287534fc2 ==============================
[0m11:38:11.166892 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:38:11.167338 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select fct_youtube_daily --no-partial-parse', 'indirect_selection': 'eager', 'introspect': 'True', 'version_check': 'True', 'quiet': 'False', 'target_path': 'None', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'profiles_dir': '/Users/luc/.dbt', 'printer_width': '80', 'empty': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'static_parser': 'True', 'cache_selected_only': 'False', 'partial_parse': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'use_colors': 'True'}
[0m11:38:11.505573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a11874b-30b7-4c61-ad73-1db287534fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052a86d0>]}
[0m11:38:11.541146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a11874b-30b7-4c61-ad73-1db287534fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f6f670>]}
[0m11:38:11.541827 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:38:11.640067 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:38:11.640564 [debug] [MainThread]: Partial parsing not enabled
[0m11:38:12.404320 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m11:38:12.404650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5a11874b-30b7-4c61-ad73-1db287534fc2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064eef40>]}
[0m11:38:12.439275 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_stg_weather_datetime.554d39b0ed' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m11:38:12.439543 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.unique_stg_weather_datetime.ea99166edf' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m11:38:12.439717 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_stg_weather_temperature_2m.4552381acc' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m11:38:12.439879 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.accepted_values_stg_weather_city__Chicago__Evanston__Aurora.3a5db1bdc4' (models/staging/schema.yml) depends on a node named 'stg_weather' which is disabled
[0m11:38:12.440043 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_datetime.36fca5f850' (models/marts/schema.yml) depends on a node named 'fact_weather' which is disabled
[0m11:38:12.440201 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.unique_fact_weather_datetime.f553e65bbe' (models/marts/schema.yml) depends on a node named 'fact_weather' which is disabled
[0m11:38:12.440363 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_feels_like.cf8e8e9258' (models/marts/schema.yml) depends on a node named 'fact_weather' which is disabled
[0m11:38:12.440589 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_daily_date.b304b6aad7' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m11:38:12.440770 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.unique_fact_weather_daily_date.1ee454b4b0' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m11:38:12.440928 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.not_null_fact_weather_daily_avg_temperature.c0f9fdc06f' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m11:38:12.441082 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.youtube_dbt_project.accepted_values_fact_weather_daily_hourly_records__24.a8a2f8b558' (models/marts/schema.yml) depends on a node named 'fact_weather_daily' which is disabled
[0m11:38:12.500538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a11874b-30b7-4c61-ad73-1db287534fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ba130>]}
[0m11:38:12.564037 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m11:38:12.565217 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m11:38:12.576449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a11874b-30b7-4c61-ad73-1db287534fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b85e0>]}
[0m11:38:12.576738 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m11:38:12.576927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a11874b-30b7-4c61-ad73-1db287534fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a91220>]}
[0m11:38:12.577571 [info ] [MainThread]: 
[0m11:38:12.577759 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:12.577916 [info ] [MainThread]: 
[0m11:38:12.578188 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:38:12.578622 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m11:38:12.586519 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m11:38:12.586709 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m11:38:12.586872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:14.094132 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.507 seconds
[0m11:38:14.098394 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m11:38:14.761376 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m11:38:14.775827 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m11:38:14.776337 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m11:38:14.776693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:15.927368 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.151 seconds
[0m11:38:15.931134 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m11:38:16.586826 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m11:38:16.593865 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m11:38:16.594623 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m11:38:16.595105 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:17.769015 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.174 seconds
[0m11:38:17.773815 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m11:38:17.978163 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m11:38:17.985564 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m11:38:17.986337 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS limit 10000
[0m11:38:17.986831 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:19.141970 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.155 seconds
[0m11:38:19.147047 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m11:38:19.367894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a11874b-30b7-4c61-ad73-1db287534fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105297910>]}
[0m11:38:19.373368 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fct_youtube_daily
[0m11:38:19.374335 [info ] [Thread-1  ]: 1 of 1 START sql table model STAGING_STAGING_MARTS.fct_youtube_daily ........... [RUN]
[0m11:38:19.375092 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now model.youtube_dbt_project.fct_youtube_daily)
[0m11:38:19.375700 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.fct_youtube_daily
[0m11:38:19.390064 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.fct_youtube_daily"
[0m11:38:19.390998 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.fct_youtube_daily
[0m11:38:19.423136 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.fct_youtube_daily"
[0m11:38:19.424528 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.fct_youtube_daily"
[0m11:38:19.424870 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.fct_youtube_daily"} */
create or replace transient table MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS.fct_youtube_daily
         as
        (
        
with base as (
    select  
        trending_date,
        country,
        category_id,
        count(*)           as video_count,
        sum(views)         as total_views,
        sum(likes)         as total_likes,
        sum(comment_count) as total_comments
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
    where trending_date is not null
    group by
        trending_date,
        country,
        category_id 
)
        
select 
    trending_date,
    country,
    category_id,
    video_count,
    total_views,
    total_likes,
    total_comments
from base
        );
[0m11:38:19.425180 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:38:20.808639 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e542-0307-3709-000e-9ce300bcd7a6
[0m11:38:20.809301 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'https://i.ytimg.com/vi/V10qKFp3d7g/default.jpg' is not recognized
[0m11:38:20.809933 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: Close
[0m11:38:21.002972 [debug] [Thread-1  ]: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/V10qKFp3d7g/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m11:38:21.005838 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a11874b-30b7-4c61-ad73-1db287534fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10714f640>]}
[0m11:38:21.006785 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model STAGING_STAGING_MARTS.fct_youtube_daily .. [[31mERROR[0m in 1.63s]
[0m11:38:21.007589 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fct_youtube_daily
[0m11:38:21.008240 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.fct_youtube_daily' to be skipped because of status 'error'.  Reason: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/V10qKFp3d7g/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql.
[0m11:38:21.009550 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:21.009994 [debug] [MainThread]: Connection 'model.youtube_dbt_project.fct_youtube_daily' was properly closed.
[0m11:38:21.010401 [info ] [MainThread]: 
[0m11:38:21.010822 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.43 seconds (8.43s).
[0m11:38:21.011714 [debug] [MainThread]: Command end result
[0m11:38:21.043702 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m11:38:21.045234 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m11:38:21.050412 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m11:38:21.050647 [info ] [MainThread]: 
[0m11:38:21.050916 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:38:21.051136 [info ] [MainThread]: 
[0m11:38:21.051399 [error] [MainThread]: [31mFailure in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)[0m
[0m11:38:21.051661 [error] [MainThread]:   Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/V10qKFp3d7g/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m11:38:21.051860 [info ] [MainThread]: 
[0m11:38:21.052095 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m11:38:21.052287 [info ] [MainThread]: 
[0m11:38:21.052500 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m11:38:21.052868 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:38:21.054297 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.935633, "process_in_blocks": "0", "process_kernel_time": 0.303391, "process_mem_max_rss": "168738816", "process_out_blocks": "0", "process_user_time": 3.655171}
[0m11:38:21.054575 [debug] [MainThread]: Command `dbt run` failed at 11:38:21.054517 after 9.94 seconds
[0m11:38:21.054832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10308c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b8940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10332ba90>]}
[0m11:38:21.055095 [debug] [MainThread]: Flushing usage events
[0m11:38:21.348685 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:57:49.695747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10719b5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082376d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108237a00>]}


============================== 11:57:49.699009 | 7a6917e3-8ee0-4e2c-ae81-0a61853ad67f ==============================
[0m11:57:49.699009 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:57:49.699365 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'write_json': 'True', 'no_print': 'None', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select stg_youtube_videos', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'version_check': 'True', 'target_path': 'None', 'printer_width': '80', 'static_parser': 'True', 'empty': 'False', 'log_format': 'default', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/luc/.dbt'}
[0m11:57:50.040071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a6917e3-8ee0-4e2c-ae81-0a61853ad67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093ae910>]}
[0m11:57:50.074525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a6917e3-8ee0-4e2c-ae81-0a61853ad67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092cc2b0>]}
[0m11:57:50.075104 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:57:50.174626 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:57:50.273913 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m11:57:50.274255 [debug] [MainThread]: Partial parsing: added file: youtube_dbt_project://models/staging/fct_youtube_daily.sql
[0m11:57:50.274477 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/marts/fct_youtube_daily.sql
[0m11:57:50.382927 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "fct_youtube_daily".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("fct_youtube_daily").
  
  To fix this, change the name of one of these resources:
  - model.youtube_dbt_project.fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  - model.youtube_dbt_project.fct_youtube_daily (models/staging/fct_youtube_daily.sql)
[0m11:57:50.384552 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.73981583, "process_in_blocks": "0", "process_kernel_time": 0.247432, "process_mem_max_rss": "135462912", "process_out_blocks": "0", "process_user_time": 1.306179}
[0m11:57:50.384809 [debug] [MainThread]: Command `dbt run` failed at 11:57:50.384747 after 0.74 seconds
[0m11:57:50.385031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10719b5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a9dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a9de50>]}
[0m11:57:50.385249 [debug] [MainThread]: Flushing usage events
[0m11:57:50.621728 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:57:51.607620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075c3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10865f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10865fa60>]}


============================== 11:57:51.609858 | 11876c52-6785-4921-aae6-4ade28746f4d ==============================
[0m11:57:51.609858 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:57:51.610192 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'partial_parse': 'True', 'printer_width': '80', 'invocation_command': 'dbt run --select fct_youtube_daily', 'use_experimental_parser': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'log_format': 'default', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'version_check': 'True', 'quiet': 'False', 'warn_error': 'None', 'empty': 'False', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/luc/.dbt'}
[0m11:57:51.862430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11876c52-6785-4921-aae6-4ade28746f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109830a90>]}
[0m11:57:51.896885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11876c52-6785-4921-aae6-4ade28746f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097cbc40>]}
[0m11:57:51.897326 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:57:51.994249 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:57:52.082953 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m11:57:52.083302 [debug] [MainThread]: Partial parsing: added file: youtube_dbt_project://models/staging/fct_youtube_daily.sql
[0m11:57:52.083534 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/marts/fct_youtube_daily.sql
[0m11:57:52.191871 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "fct_youtube_daily".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("fct_youtube_daily").
  
  To fix this, change the name of one of these resources:
  - model.youtube_dbt_project.fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  - model.youtube_dbt_project.fct_youtube_daily (models/staging/fct_youtube_daily.sql)
[0m11:57:52.193634 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.62855107, "process_in_blocks": "0", "process_kernel_time": 0.147753, "process_mem_max_rss": "136200192", "process_out_blocks": "0", "process_user_time": 1.240483}
[0m11:57:52.194398 [debug] [MainThread]: Command `dbt run` failed at 11:57:52.193831 after 0.63 seconds
[0m11:57:52.194699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075c3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d17c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f6f130>]}
[0m11:57:52.194947 [debug] [MainThread]: Flushing usage events
[0m11:57:52.384663 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:59:21.709737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034d7580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c8b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c8b940>]}


============================== 11:59:21.712921 | 626424ed-11f2-4c1e-83f7-2d9c68035274 ==============================
[0m11:59:21.712921 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:59:21.713282 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'profiles_dir': '/Users/luc/.dbt', 'version_check': 'True', 'introspect': 'True', 'log_format': 'default', 'warn_error': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_youtube_videos', 'empty': 'False', 'fail_fast': 'False', 'printer_width': '80', 'debug': 'False', 'partial_parse': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs'}
[0m11:59:22.054504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '626424ed-11f2-4c1e-83f7-2d9c68035274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107124730>]}
[0m11:59:22.089089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '626424ed-11f2-4c1e-83f7-2d9c68035274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10734b880>]}
[0m11:59:22.089666 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:59:22.191185 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:59:22.291363 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:59:22.291757 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/marts/fct_youtube_daily.sql
[0m11:59:22.398707 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.youtube_dbt_project.fct_youtube_daily' (models/marts/fct_youtube_daily.sql) depends on a source named 'raw.youtube_data' which was not found
[0m11:59:22.400253 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.73576844, "process_in_blocks": "0", "process_kernel_time": 0.207214, "process_mem_max_rss": "134381568", "process_out_blocks": "0", "process_user_time": 1.254081}
[0m11:59:22.400500 [debug] [MainThread]: Command `dbt run` failed at 11:59:22.400445 after 0.74 seconds
[0m11:59:22.400724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034d7580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b05610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b31a60>]}
[0m11:59:22.400939 [debug] [MainThread]: Flushing usage events
[0m11:59:22.689984 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:59:23.647464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103348610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e3730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e3a60>]}


============================== 11:59:23.649849 | 80a47541-d878-424e-8a45-ca4902ab30fc ==============================
[0m11:59:23.649849 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:59:23.650195 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'fail_fast': 'False', 'empty': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select fct_youtube_daily', 'static_parser': 'True', 'write_json': 'True', 'debug': 'False', 'profiles_dir': '/Users/luc/.dbt', 'use_experimental_parser': 'False', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'use_colors': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'quiet': 'False'}
[0m11:59:23.898268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80a47541-d878-424e-8a45-ca4902ab30fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b4a90>]}
[0m11:59:23.932540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80a47541-d878-424e-8a45-ca4902ab30fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10554fc40>]}
[0m11:59:23.932989 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:59:24.028174 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:59:24.114984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:59:24.115368 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/marts/fct_youtube_daily.sql
[0m11:59:24.219579 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.youtube_dbt_project.fct_youtube_daily' (models/marts/fct_youtube_daily.sql) depends on a source named 'raw.youtube_data' which was not found
[0m11:59:24.220625 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6134475, "process_in_blocks": "0", "process_kernel_time": 0.141809, "process_mem_max_rss": "137297920", "process_out_blocks": "0", "process_user_time": 1.210795}
[0m11:59:24.220868 [debug] [MainThread]: Command `dbt run` failed at 11:59:24.220814 after 0.61 seconds
[0m11:59:24.221081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103348610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b3c1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b3c760>]}
[0m11:59:24.221300 [debug] [MainThread]: Flushing usage events
[0m11:59:24.413230 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:01:08.741846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dc7580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e63610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e63940>]}


============================== 12:01:08.745097 | 071289e7-5b4f-42d3-b965-28b4d182f470 ==============================
[0m12:01:08.745097 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:01:08.745445 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'debug': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'write_json': 'True', 'use_colors': 'True', 'target_path': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'fail_fast': 'False', 'empty': 'False', 'profiles_dir': '/Users/luc/.dbt', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'printer_width': '80', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run --select fct_youtube_daily'}
[0m12:01:09.094232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '071289e7-5b4f-42d3-b965-28b4d182f470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe0730>]}
[0m12:01:09.128564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '071289e7-5b4f-42d3-b965-28b4d182f470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f7880>]}
[0m12:01:09.129116 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:01:09.228250 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:01:09.326408 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:01:09.326791 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/marts/fct_youtube_daily.sql
[0m12:01:09.489524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '071289e7-5b4f-42d3-b965-28b4d182f470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10672f130>]}
[0m12:01:09.553435 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m12:01:09.554815 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m12:01:09.565561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '071289e7-5b4f-42d3-b965-28b4d182f470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10672daf0>]}
[0m12:01:09.565861 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m12:01:09.566052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '071289e7-5b4f-42d3-b965-28b4d182f470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106724af0>]}
[0m12:01:09.566686 [info ] [MainThread]: 
[0m12:01:09.566878 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:01:09.567036 [info ] [MainThread]: 
[0m12:01:09.567310 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:01:09.567776 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m12:01:09.575507 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m12:01:09.575699 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m12:01:09.575869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:11.717152 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 2.141 seconds
[0m12:01:11.720872 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m12:01:12.038196 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m12:01:12.054476 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m12:01:12.055086 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m12:01:12.055495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:15.337166 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.281 seconds
[0m12:01:15.341332 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m12:01:15.849709 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m12:01:15.855696 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m12:01:15.856145 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS limit 10000
[0m12:01:15.856451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:18.714300 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.857 seconds
[0m12:01:18.718697 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m12:01:19.146248 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m12:01:19.153138 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m12:01:19.153733 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m12:01:19.154225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:22.708341 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 3.554 seconds
[0m12:01:22.712955 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m12:01:23.233220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '071289e7-5b4f-42d3-b965-28b4d182f470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061185e0>]}
[0m12:01:23.238531 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fct_youtube_daily
[0m12:01:23.239608 [info ] [Thread-1  ]: 1 of 1 START sql table model STAGING_STAGING_MARTS.fct_youtube_daily ........... [RUN]
[0m12:01:23.240410 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now model.youtube_dbt_project.fct_youtube_daily)
[0m12:01:23.241018 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.fct_youtube_daily
[0m12:01:23.256136 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.fct_youtube_daily"
[0m12:01:23.257389 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.fct_youtube_daily
[0m12:01:23.290366 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.fct_youtube_daily"
[0m12:01:23.291910 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.fct_youtube_daily"
[0m12:01:23.292253 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.fct_youtube_daily"} */
create or replace transient table MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS.fct_youtube_daily
         as
        (
        
with base as (
    select  
        trending_date,
        country,
        category_id,
        count(*)           as video_count,
        cast(views as int) as views,
        cast(likes as int) as likes,
        cast(comment_count as int) as comment_count,

    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
    where trending_date is not null
    group by
        trending_date,
        country,
        category_id 
)
        
select 
    trending_date,
    country,
    category_id,
    video_count,
    total_views,
    total_likes,
    total_comments
from base
        );
[0m12:01:23.292570 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:01:25.563487 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e559-0307-3545-000e-9ce300bcf50e
[0m12:01:25.564198 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 28 at position 4
invalid identifier 'TOTAL_VIEWS'
[0m12:01:25.564839 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: Close
[0m12:01:26.542614 [debug] [Thread-1  ]: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  000904 (42000): SQL compilation error: error line 28 at position 4
  invalid identifier 'TOTAL_VIEWS'
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m12:01:26.545786 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '071289e7-5b4f-42d3-b965-28b4d182f470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107daec70>]}
[0m12:01:26.546794 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model STAGING_STAGING_MARTS.fct_youtube_daily .. [[31mERROR[0m in 3.30s]
[0m12:01:26.547646 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fct_youtube_daily
[0m12:01:26.548372 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.fct_youtube_daily' to be skipped because of status 'error'.  Reason: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  000904 (42000): SQL compilation error: error line 28 at position 4
  invalid identifier 'TOTAL_VIEWS'
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql.
[0m12:01:26.549947 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:01:26.550406 [debug] [MainThread]: Connection 'model.youtube_dbt_project.fct_youtube_daily' was properly closed.
[0m12:01:26.550829 [info ] [MainThread]: 
[0m12:01:26.551258 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 16.98 seconds (16.98s).
[0m12:01:26.552125 [debug] [MainThread]: Command end result
[0m12:01:26.583903 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m12:01:26.585941 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m12:01:26.591696 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m12:01:26.591952 [info ] [MainThread]: 
[0m12:01:26.592224 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:01:26.592448 [info ] [MainThread]: 
[0m12:01:26.592741 [error] [MainThread]: [31mFailure in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)[0m
[0m12:01:26.593007 [error] [MainThread]:   Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  000904 (42000): SQL compilation error: error line 28 at position 4
  invalid identifier 'TOTAL_VIEWS'
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m12:01:26.593205 [info ] [MainThread]: 
[0m12:01:26.593448 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m12:01:26.593647 [info ] [MainThread]: 
[0m12:01:26.593871 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:01:26.595928 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 17.899036, "process_in_blocks": "0", "process_kernel_time": 0.350397, "process_mem_max_rss": "158597120", "process_out_blocks": "0", "process_user_time": 3.033125}
[0m12:01:26.596239 [debug] [MainThread]: Command `dbt run` failed at 12:01:26.596177 after 17.90 seconds
[0m12:01:26.596535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dc7580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10672df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104095a00>]}
[0m12:01:26.596796 [debug] [MainThread]: Flushing usage events
[0m12:01:26.987729 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:05:29.901650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118fff640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11abcb790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11abcbac0>]}


============================== 12:05:29.904841 | 77779cfd-240b-47cd-90b3-6bcb527822d8 ==============================
[0m12:05:29.904841 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:05:29.905205 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'no_print': 'None', 'version_check': 'True', 'profiles_dir': '/Users/luc/.dbt', 'invocation_command': 'dbt run --select fct_youtube_daily', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'empty': 'False', 'log_format': 'default', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'static_parser': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:05:30.243948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77779cfd-240b-47cd-90b3-6bcb527822d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bf94820>]}
[0m12:05:30.278328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77779cfd-240b-47cd-90b3-6bcb527822d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119ba2250>]}
[0m12:05:30.278868 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:05:30.377268 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:05:30.476533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:05:30.476905 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/marts/fct_youtube_daily.sql
[0m12:05:30.643713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77779cfd-240b-47cd-90b3-6bcb527822d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dbca130>]}
[0m12:05:30.707637 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m12:05:30.709066 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m12:05:30.720268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77779cfd-240b-47cd-90b3-6bcb527822d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dbc6a90>]}
[0m12:05:30.720580 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m12:05:30.720770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77779cfd-240b-47cd-90b3-6bcb527822d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dc0fb50>]}
[0m12:05:30.721387 [info ] [MainThread]: 
[0m12:05:30.721576 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:05:30.721734 [info ] [MainThread]: 
[0m12:05:30.722008 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:05:30.722439 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m12:05:30.730403 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m12:05:30.730660 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m12:05:30.730830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:32.235824 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.505 seconds
[0m12:05:32.239639 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m12:05:32.582817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m12:05:32.597399 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m12:05:32.597860 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m12:05:32.598262 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:05:33.545822 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.947 seconds
[0m12:05:33.550642 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m12:05:34.434223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m12:05:34.443102 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m12:05:34.443781 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m12:05:34.444305 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:05:35.427599 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.983 seconds
[0m12:05:35.431685 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m12:05:36.051883 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m12:05:36.059760 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m12:05:36.061984 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS limit 10000
[0m12:05:36.062498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:05:37.889828 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.827 seconds
[0m12:05:37.894818 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m12:05:38.118268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77779cfd-240b-47cd-90b3-6bcb527822d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c8fa0>]}
[0m12:05:38.123165 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fct_youtube_daily
[0m12:05:38.124231 [info ] [Thread-1  ]: 1 of 1 START sql table model STAGING_STAGING_MARTS.fct_youtube_daily ........... [RUN]
[0m12:05:38.125008 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now model.youtube_dbt_project.fct_youtube_daily)
[0m12:05:38.125627 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.fct_youtube_daily
[0m12:05:38.140462 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.fct_youtube_daily"
[0m12:05:38.141962 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.fct_youtube_daily
[0m12:05:38.174135 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.fct_youtube_daily"
[0m12:05:38.175878 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.fct_youtube_daily"
[0m12:05:38.176245 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.fct_youtube_daily"} */
create or replace transient table MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS.fct_youtube_daily
         as
        (
        
with base as (
    select  
        trending_date,
        country,
        category_id,
        count(*)           as video_count,
        sum(cast(views as int))           as total_views,
        sum(cast(likes as int))           as total_likes,
        sum(cast(comment_count as int))   as total_comments,
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
    where trending_date is not null
    group by
        trending_date,
        country,
        category_id 
)
        
select 
    trending_date,
    country,
    category_id,
    video_count,
    total_views,
    total_likes,
    total_comments
from base
        );
[0m12:05:38.176565 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:05:40.340029 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e55d-0307-3545-000e-9ce300bcf52e
[0m12:05:40.340737 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
[0m12:05:40.341395 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: Close
[0m12:05:40.684278 [debug] [Thread-1  ]: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m12:05:40.687319 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77779cfd-240b-47cd-90b3-6bcb527822d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f01d6a0>]}
[0m12:05:40.688264 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model STAGING_STAGING_MARTS.fct_youtube_daily .. [[31mERROR[0m in 2.56s]
[0m12:05:40.689090 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fct_youtube_daily
[0m12:05:40.689765 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.fct_youtube_daily' to be skipped because of status 'error'.  Reason: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql.
[0m12:05:40.691168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:05:40.691602 [debug] [MainThread]: Connection 'model.youtube_dbt_project.fct_youtube_daily' was properly closed.
[0m12:05:40.692031 [info ] [MainThread]: 
[0m12:05:40.692463 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.97 seconds (9.97s).
[0m12:05:40.693381 [debug] [MainThread]: Command end result
[0m12:05:40.724905 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m12:05:40.727166 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m12:05:40.732809 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m12:05:40.733052 [info ] [MainThread]: 
[0m12:05:40.733327 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:05:40.733545 [info ] [MainThread]: 
[0m12:05:40.733840 [error] [MainThread]: [31mFailure in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)[0m
[0m12:05:40.734105 [error] [MainThread]:   Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m12:05:40.734306 [info ] [MainThread]: 
[0m12:05:40.734548 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m12:05:40.734740 [info ] [MainThread]: 
[0m12:05:40.734966 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:05:40.736856 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.881947, "process_in_blocks": "0", "process_kernel_time": 0.382793, "process_mem_max_rss": "159039488", "process_out_blocks": "0", "process_user_time": 3.019595}
[0m12:05:40.737169 [debug] [MainThread]: Command `dbt run` failed at 12:05:40.737109 after 10.88 seconds
[0m12:05:40.737445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118fff640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11db2a520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bf94820>]}
[0m12:05:40.737729 [debug] [MainThread]: Flushing usage events
[0m12:05:40.958380 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:10:38.096738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ac5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10624b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10624b9d0>]}


============================== 12:10:38.099884 | 41d0256f-dd3f-40a3-a89f-76afc398a316 ==============================
[0m12:10:38.099884 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:10:38.100260 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'profiles_dir': '/Users/luc/.dbt', 'log_format': 'default', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select fct_youtube_daily', 'quiet': 'False', 'debug': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'target_path': 'None', 'use_colors': 'True', 'write_json': 'True', 'introspect': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'fail_fast': 'False', 'static_parser': 'True'}
[0m12:10:38.437042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41d0256f-dd3f-40a3-a89f-76afc398a316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107709490>]}
[0m12:10:38.471165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41d0256f-dd3f-40a3-a89f-76afc398a316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106075e20>]}
[0m12:10:38.471688 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:10:38.571321 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:10:38.670132 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:10:38.670504 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/marts/fct_youtube_daily.sql
[0m12:10:38.832944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41d0256f-dd3f-40a3-a89f-76afc398a316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108982130>]}
[0m12:10:38.896375 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m12:10:38.897722 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m12:10:38.908601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41d0256f-dd3f-40a3-a89f-76afc398a316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089979a0>]}
[0m12:10:38.908921 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m12:10:38.909117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41d0256f-dd3f-40a3-a89f-76afc398a316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108979b20>]}
[0m12:10:38.909748 [info ] [MainThread]: 
[0m12:10:38.909941 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:10:38.910099 [info ] [MainThread]: 
[0m12:10:38.910380 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:10:38.910824 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m12:10:38.918537 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m12:10:38.918729 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m12:10:38.918893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:40.230505 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.311 seconds
[0m12:10:40.234807 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m12:10:40.468234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m12:10:40.483868 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m12:10:40.484353 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS limit 10000
[0m12:10:40.484718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:41.819524 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.334 seconds
[0m12:10:41.824305 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m12:10:42.072497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m12:10:42.079239 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m12:10:42.080048 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m12:10:42.080527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:43.294486 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.214 seconds
[0m12:10:43.299269 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m12:10:43.516499 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m12:10:43.523877 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m12:10:43.525795 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m12:10:43.526310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:45.592379 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.066 seconds
[0m12:10:45.597269 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m12:10:45.787642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41d0256f-dd3f-40a3-a89f-76afc398a316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040c7430>]}
[0m12:10:45.793149 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fct_youtube_daily
[0m12:10:45.794121 [info ] [Thread-1  ]: 1 of 1 START sql table model STAGING_STAGING_MARTS.fct_youtube_daily ........... [RUN]
[0m12:10:45.794878 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now model.youtube_dbt_project.fct_youtube_daily)
[0m12:10:45.795483 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.fct_youtube_daily
[0m12:10:45.810097 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.fct_youtube_daily"
[0m12:10:45.811398 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.fct_youtube_daily
[0m12:10:45.843489 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.fct_youtube_daily"
[0m12:10:45.844889 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.fct_youtube_daily"
[0m12:10:45.845230 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.fct_youtube_daily"} */
create or replace transient table MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS.fct_youtube_daily
         as
        (
        
with base as (
    select  
        trending_date,
        country,
        category_id,
        count(*)           as video_count,
        sum(try_cast(views as int))           as total_views,
        sum(try_cast(likes as int))           as total_likes,
        sum(try_cast(comment_count as int))   as total_comments,
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
    where trending_date is not null
    group by
        trending_date,
        country,
        category_id 
)
        
select 
    trending_date,
    country,
    category_id,
    video_count,
    total_views,
    total_likes,
    total_comments
from base
        );
[0m12:10:45.845543 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:10:48.397242 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e562-0307-3356-000e-9ce300bd2292
[0m12:10:48.398066 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
[0m12:10:48.398803 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: Close
[0m12:10:48.603938 [debug] [Thread-1  ]: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m12:10:48.606790 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41d0256f-dd3f-40a3-a89f-76afc398a316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa9d670>]}
[0m12:10:48.607760 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model STAGING_STAGING_MARTS.fct_youtube_daily .. [[31mERROR[0m in 2.81s]
[0m12:10:48.608588 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fct_youtube_daily
[0m12:10:48.609252 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.fct_youtube_daily' to be skipped because of status 'error'.  Reason: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql.
[0m12:10:48.610575 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:10:48.610927 [debug] [MainThread]: Connection 'model.youtube_dbt_project.fct_youtube_daily' was properly closed.
[0m12:10:48.611263 [info ] [MainThread]: 
[0m12:10:48.611621 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.70 seconds (9.70s).
[0m12:10:48.612381 [debug] [MainThread]: Command end result
[0m12:10:48.643342 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m12:10:48.644865 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m12:10:48.650075 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m12:10:48.650313 [info ] [MainThread]: 
[0m12:10:48.650583 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:10:48.650805 [info ] [MainThread]: 
[0m12:10:48.651073 [error] [MainThread]: [31mFailure in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)[0m
[0m12:10:48.651336 [error] [MainThread]:   Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m12:10:48.651539 [info ] [MainThread]: 
[0m12:10:48.651776 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m12:10:48.651967 [info ] [MainThread]: 
[0m12:10:48.652182 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:10:48.654096 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.604349, "process_in_blocks": "0", "process_kernel_time": 0.3434, "process_mem_max_rss": "161611776", "process_out_blocks": "0", "process_user_time": 3.08218}
[0m12:10:48.654394 [debug] [MainThread]: Command `dbt run` failed at 12:10:48.654332 after 10.60 seconds
[0m12:10:48.654660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ac5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107709490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023281c0>]}
[0m12:10:48.654926 [debug] [MainThread]: Flushing usage events
[0m12:10:49.003095 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:13:39.424668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034545e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044ef7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044efaf0>]}


============================== 12:13:39.427877 | 7a5cdce6-83dc-4358-ab2a-c08e6965f6f6 ==============================
[0m12:13:39.427877 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:13:39.428232 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select fct_youtube_daily', 'indirect_selection': 'eager', 'introspect': 'True', 'static_parser': 'True', 'empty': 'False', 'profiles_dir': '/Users/luc/.dbt', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'no_print': 'None', 'log_format': 'default', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'write_json': 'True', 'debug': 'False', 'use_experimental_parser': 'False'}
[0m12:13:39.770241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a5cdce6-83dc-4358-ab2a-c08e6965f6f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056a5970>]}
[0m12:13:39.804721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a5cdce6-83dc-4358-ab2a-c08e6965f6f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055744c0>]}
[0m12:13:39.805348 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:13:39.904571 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:13:40.003981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:13:40.004347 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/marts/fct_youtube_daily.sql
[0m12:13:40.166672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a5cdce6-83dc-4358-ab2a-c08e6965f6f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dba130>]}
[0m12:13:40.229382 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m12:13:40.231166 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m12:13:40.242689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a5cdce6-83dc-4358-ab2a-c08e6965f6f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dd0160>]}
[0m12:13:40.243018 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m12:13:40.243214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a5cdce6-83dc-4358-ab2a-c08e6965f6f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105db1b20>]}
[0m12:13:40.243868 [info ] [MainThread]: 
[0m12:13:40.244062 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:13:40.244220 [info ] [MainThread]: 
[0m12:13:40.244507 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:13:40.244940 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m12:13:40.252673 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m12:13:40.252866 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m12:13:40.253029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:41.406027 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.153 seconds
[0m12:13:41.410305 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m12:13:41.594892 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m12:13:41.610801 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m12:13:41.611233 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m12:13:41.611580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:42.483905 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.872 seconds
[0m12:13:42.489573 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m12:13:42.717380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m12:13:42.724372 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m12:13:42.725190 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m12:13:42.725687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:43.611710 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.886 seconds
[0m12:13:43.614765 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m12:13:43.801931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m12:13:43.808705 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m12:13:43.809328 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS limit 10000
[0m12:13:43.809805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:44.695293 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.885 seconds
[0m12:13:44.700442 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m12:13:44.912510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a5cdce6-83dc-4358-ab2a-c08e6965f6f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055a4a60>]}
[0m12:13:44.917504 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fct_youtube_daily
[0m12:13:44.918532 [info ] [Thread-1  ]: 1 of 1 START sql table model STAGING_STAGING_MARTS.fct_youtube_daily ........... [RUN]
[0m12:13:44.919375 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now model.youtube_dbt_project.fct_youtube_daily)
[0m12:13:44.919976 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.fct_youtube_daily
[0m12:13:44.934555 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.fct_youtube_daily"
[0m12:13:44.935622 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.fct_youtube_daily
[0m12:13:44.967968 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.fct_youtube_daily"
[0m12:13:44.969340 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.fct_youtube_daily"
[0m12:13:44.969683 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.fct_youtube_daily"} */
create or replace transient table MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS.fct_youtube_daily
         as
        (
        
with base as (
    select  
        trending_date,
        country,
        category_id,
        count(*)                              as video_count,
        sum(try_cast(views as int))           as total_views,
        sum(try_cast(likes as int))           as total_likes,
        sum(try_cast(comment_count as int))   as total_comments,
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
    where trending_date is not null
    group by
        trending_date,
        country,
        category_id 
)
        
select 
    trending_date,
    country,
    category_id,
    video_count,
    total_views,
    total_likes,
    total_comments
from base
        );
[0m12:13:44.970009 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:13:47.193304 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e565-0307-38b6-000e-9ce300bd600e
[0m12:13:47.194099 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'https://i.ytimg.com/vi/V10qKFp3d7g/default.jpg' is not recognized
[0m12:13:47.194756 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: Close
[0m12:13:47.567146 [debug] [Thread-1  ]: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/V10qKFp3d7g/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m12:13:47.571541 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a5cdce6-83dc-4358-ab2a-c08e6965f6f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073fdb20>]}
[0m12:13:47.572528 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model STAGING_STAGING_MARTS.fct_youtube_daily .. [[31mERROR[0m in 2.65s]
[0m12:13:47.573342 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fct_youtube_daily
[0m12:13:47.573981 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.fct_youtube_daily' to be skipped because of status 'error'.  Reason: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/V10qKFp3d7g/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql.
[0m12:13:47.575243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:13:47.575615 [debug] [MainThread]: Connection 'model.youtube_dbt_project.fct_youtube_daily' was properly closed.
[0m12:13:47.575981 [info ] [MainThread]: 
[0m12:13:47.576382 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.33 seconds (7.33s).
[0m12:13:47.577169 [debug] [MainThread]: Command end result
[0m12:13:47.609772 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m12:13:47.611226 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m12:13:47.616513 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m12:13:47.616743 [info ] [MainThread]: 
[0m12:13:47.617019 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:13:47.617235 [info ] [MainThread]: 
[0m12:13:47.617495 [error] [MainThread]: [31mFailure in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)[0m
[0m12:13:47.617758 [error] [MainThread]:   Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/V10qKFp3d7g/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m12:13:47.617954 [info ] [MainThread]: 
[0m12:13:47.618190 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m12:13:47.618382 [info ] [MainThread]: 
[0m12:13:47.618595 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:13:47.620304 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.240532, "process_in_blocks": "0", "process_kernel_time": 0.324269, "process_mem_max_rss": "161202176", "process_out_blocks": "0", "process_user_time": 3.038015}
[0m12:13:47.620584 [debug] [MainThread]: Command `dbt run` failed at 12:13:47.620523 after 8.24 seconds
[0m12:13:47.620840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034545e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056a5970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dd08e0>]}
[0m12:13:47.621099 [debug] [MainThread]: Flushing usage events
[0m12:13:47.931219 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:18:59.695967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d4b5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de79d0>]}


============================== 12:18:59.699070 | 3d42bed2-8b3d-477f-9ed6-5398abc3a820 ==============================
[0m12:18:59.699070 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:18:59.699454 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select stg_youtube_videos', 'debug': 'False', 'static_parser': 'True', 'target_path': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'no_print': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'profiles_dir': '/Users/luc/.dbt', 'log_cache_events': 'False', 'use_colors': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'quiet': 'False', 'empty': 'False', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'version_check': 'True', 'partial_parse': 'True'}
[0m12:19:00.038639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d42bed2-8b3d-477f-9ed6-5398abc3a820', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f9d490>]}
[0m12:19:00.072927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d42bed2-8b3d-477f-9ed6-5398abc3a820', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c11e20>]}
[0m12:19:00.073465 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:19:00.171304 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:19:00.270346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:19:00.270605 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:19:00.303237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d42bed2-8b3d-477f-9ed6-5398abc3a820', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a622130>]}
[0m12:19:00.368531 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m12:19:00.370130 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m12:19:00.381516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d42bed2-8b3d-477f-9ed6-5398abc3a820', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a64b070>]}
[0m12:19:00.381835 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m12:19:00.382041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d42bed2-8b3d-477f-9ed6-5398abc3a820', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a12ed30>]}
[0m12:19:00.382695 [info ] [MainThread]: 
[0m12:19:00.382890 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:19:00.383047 [info ] [MainThread]: 
[0m12:19:00.383330 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:19:00.383777 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m12:19:00.392439 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m12:19:00.392644 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m12:19:00.392810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:01.837443 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.444 seconds
[0m12:19:01.843479 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m12:19:02.061792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m12:19:02.077395 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m12:19:02.077884 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m12:19:02.078241 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:03.246698 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.168 seconds
[0m12:19:03.251978 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m12:19:03.449675 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m12:19:03.452845 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m12:19:03.453104 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS limit 10000
[0m12:19:03.453328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:04.577049 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.123 seconds
[0m12:19:04.581364 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m12:19:04.790445 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m12:19:04.796770 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m12:19:04.797347 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m12:19:04.797839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:06.023502 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.226 seconds
[0m12:19:06.026751 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m12:19:06.398163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d42bed2-8b3d-477f-9ed6-5398abc3a820', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0fdfd0>]}
[0m12:19:06.403126 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.stg_youtube_videos
[0m12:19:06.404441 [info ] [Thread-1  ]: 1 of 1 START sql view model STAGING_STAGING.stg_youtube_videos ................. [RUN]
[0m12:19:06.405251 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now model.youtube_dbt_project.stg_youtube_videos)
[0m12:19:06.405869 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.stg_youtube_videos
[0m12:19:06.420771 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.stg_youtube_videos"
[0m12:19:06.422138 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.stg_youtube_videos
[0m12:19:06.453535 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.stg_youtube_videos"
[0m12:19:06.455549 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.stg_youtube_videos"
[0m12:19:06.455933 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.stg_youtube_videos"} */
create or replace   view MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
  
   as (
    
        
with source as (
        
    select
        video_id,
        country,
        title,
        channel_title,   
        category_id,
        trending_date,
        publish_time,
        tags,
        views,
        likes,
        dislikes,
        comment_count,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from MAGPIE_FINAL_PROJECT.RAW.RAW_YOUTUBE_TRENDING
        
),
        
cleaned as (  
        
    select
        video_id,
        country,
        title,
        channel_title,
        category_id,
        try_to_date(trending_date, 'YY.DD.MM') as trending_date,
        try_to_timestamp_ntz(publish_time)      as publish_ts,
        tags, 
        views::number            as views,
        likes::number            as likes,
        dislikes::number         as dislikes,
        comment_count::number    as comment_count,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from source
        
)
        
select * from cleaned
  );
[0m12:19:06.456273 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:19:07.793827 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.337 seconds
[0m12:19:07.832516 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: Close
[0m12:19:08.037959 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d42bed2-8b3d-477f-9ed6-5398abc3a820', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e6c4f0>]}
[0m12:19:08.039550 [info ] [Thread-1  ]: 1 of 1 OK created sql view model STAGING_STAGING.stg_youtube_videos ............ [[32mSUCCESS 1[0m in 1.63s]
[0m12:19:08.040457 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.stg_youtube_videos
[0m12:19:08.041856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:19:08.042290 [debug] [MainThread]: Connection 'model.youtube_dbt_project.stg_youtube_videos' was properly closed.
[0m12:19:08.042681 [info ] [MainThread]: 
[0m12:19:08.043083 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.66 seconds (7.66s).
[0m12:19:08.043952 [debug] [MainThread]: Command end result
[0m12:19:08.082171 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m12:19:08.083779 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m12:19:08.089775 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m12:19:08.090061 [info ] [MainThread]: 
[0m12:19:08.090408 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:19:08.090663 [info ] [MainThread]: 
[0m12:19:08.090938 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:19:08.092773 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.442803, "process_in_blocks": "0", "process_kernel_time": 0.336645, "process_mem_max_rss": "156532736", "process_out_blocks": "0", "process_user_time": 2.905576}
[0m12:19:08.093101 [debug] [MainThread]: Command `dbt run` succeeded at 12:19:08.093035 after 8.44 seconds
[0m12:19:08.093380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d4b5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107270bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe75b0>]}
[0m12:19:08.093665 [debug] [MainThread]: Flushing usage events
[0m12:19:08.352322 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:19:09.517322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100305e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bcb760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bcba90>]}


============================== 12:19:09.519997 | e53dda5b-0272-441c-b850-135e664ad7a1 ==============================
[0m12:19:09.519997 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:19:09.520338 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'empty': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'debug': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'profiles_dir': '/Users/luc/.dbt', 'use_colors': 'True', 'static_parser': 'True', 'introspect': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'write_json': 'True', 'invocation_command': 'dbt run --select fct_youtube_daily'}
[0m12:19:09.819322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e53dda5b-0272-441c-b850-135e664ad7a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112faa7c0>]}
[0m12:19:09.853266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e53dda5b-0272-441c-b850-135e664ad7a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11126ee50>]}
[0m12:19:09.853801 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:19:09.951382 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:19:10.048081 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:19:10.048376 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:19:10.081317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e53dda5b-0272-441c-b850-135e664ad7a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113552130>]}
[0m12:19:10.144668 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m12:19:10.145900 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m12:19:10.156155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e53dda5b-0272-441c-b850-135e664ad7a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11332ee20>]}
[0m12:19:10.156461 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m12:19:10.156672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e53dda5b-0272-441c-b850-135e664ad7a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11357b430>]}
[0m12:19:10.157335 [info ] [MainThread]: 
[0m12:19:10.157534 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:19:10.157690 [info ] [MainThread]: 
[0m12:19:10.157961 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:19:10.158411 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m12:19:10.167091 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m12:19:10.167288 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m12:19:10.167458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:11.208635 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.041 seconds
[0m12:19:11.212252 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m12:19:11.428763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m12:19:11.443966 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m12:19:11.444468 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS limit 10000
[0m12:19:11.444812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:12.368621 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.923 seconds
[0m12:19:12.372987 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m12:19:13.226532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m12:19:13.234539 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m12:19:13.235491 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m12:19:13.236009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:14.117645 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.881 seconds
[0m12:19:14.122374 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m12:19:14.302299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m12:19:14.310936 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m12:19:14.311565 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m12:19:14.312077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:15.621378 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.309 seconds
[0m12:19:15.626502 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m12:19:15.861680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e53dda5b-0272-441c-b850-135e664ad7a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11313cf40>]}
[0m12:19:15.864749 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fct_youtube_daily
[0m12:19:15.865639 [info ] [Thread-1  ]: 1 of 1 START sql table model STAGING_STAGING_MARTS.fct_youtube_daily ........... [RUN]
[0m12:19:15.866365 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now model.youtube_dbt_project.fct_youtube_daily)
[0m12:19:15.866951 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.fct_youtube_daily
[0m12:19:15.880338 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.fct_youtube_daily"
[0m12:19:15.881285 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.fct_youtube_daily
[0m12:19:15.912421 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.fct_youtube_daily"
[0m12:19:15.913852 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.fct_youtube_daily"
[0m12:19:15.914201 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.fct_youtube_daily"} */
create or replace transient table MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS.fct_youtube_daily
         as
        (
        
with base as (
    select  
        trending_date,
        country,
        category_id,
        count(*)                              as video_count,
        sum(try_cast(views as int))           as total_views,
        sum(try_cast(likes as int))           as total_likes,
        sum(try_cast(comment_count as int))   as total_comments,
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
    where trending_date is not null
    group by
        trending_date,
        country,
        category_id 
)
        
select 
    trending_date,
    country,
    category_id,
    video_count,
    total_views,
    total_likes,
    total_comments
from base
        );
[0m12:19:15.914523 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:19:17.660550 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01c0e56b-0307-3356-000e-9ce300bd22be
[0m12:19:17.661230 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
[0m12:19:17.661858 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: Close
[0m12:19:17.879795 [debug] [Thread-1  ]: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m12:19:17.882616 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e53dda5b-0272-441c-b850-135e664ad7a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116051ca0>]}
[0m12:19:17.883556 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model STAGING_STAGING_MARTS.fct_youtube_daily .. [[31mERROR[0m in 2.01s]
[0m12:19:17.884348 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fct_youtube_daily
[0m12:19:17.885006 [debug] [Thread-4  ]: Marking all children of 'model.youtube_dbt_project.fct_youtube_daily' to be skipped because of status 'error'.  Reason: Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql.
[0m12:19:17.886362 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:19:17.886731 [debug] [MainThread]: Connection 'model.youtube_dbt_project.fct_youtube_daily' was properly closed.
[0m12:19:17.887100 [info ] [MainThread]: 
[0m12:19:17.887490 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.73 seconds (7.73s).
[0m12:19:17.888316 [debug] [MainThread]: Command end result
[0m12:19:17.919857 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m12:19:17.921266 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m12:19:17.926571 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m12:19:17.926807 [info ] [MainThread]: 
[0m12:19:17.927071 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:19:17.927288 [info ] [MainThread]: 
[0m12:19:17.927559 [error] [MainThread]: [31mFailure in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)[0m
[0m12:19:17.927833 [error] [MainThread]:   Database Error in model fct_youtube_daily (models/marts/fct_youtube_daily.sql)
  100038 (22018): Numeric value 'https://i.ytimg.com/vi/zEoeVCCrCdw/default.jpg' is not recognized
  compiled code at target/run/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m12:19:17.928039 [info ] [MainThread]: 
[0m12:19:17.928273 [info ] [MainThread]:   compiled code at target/compiled/youtube_dbt_project/models/marts/fct_youtube_daily.sql
[0m12:19:17.928462 [info ] [MainThread]: 
[0m12:19:17.928676 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:19:17.929897 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.454359, "process_in_blocks": "0", "process_kernel_time": 0.238911, "process_mem_max_rss": "162709504", "process_out_blocks": "0", "process_user_time": 2.889293}
[0m12:19:17.930168 [debug] [MainThread]: Command `dbt run` failed at 12:19:17.930111 after 8.45 seconds
[0m12:19:17.930420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100305e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113133310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102d3850>]}
[0m12:19:17.930675 [debug] [MainThread]: Flushing usage events
[0m12:19:18.134660 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:28:20.011294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e545e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eef7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eefaf0>]}


============================== 12:28:20.014503 | c60037ef-3bd2-44dc-9f1f-8a7519b8e4a9 ==============================
[0m12:28:20.014503 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:28:20.014872 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'target_path': 'None', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'partial_parse': 'True', 'profiles_dir': '/Users/luc/.dbt', 'use_experimental_parser': 'False', 'version_check': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'log_format': 'default', 'warn_error': 'None', 'printer_width': '80', 'fail_fast': 'False', 'invocation_command': 'dbt run --select stg_youtube_videos', 'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'send_anonymous_usage_stats': 'True', 'empty': 'False'}
[0m12:28:20.350076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c60037ef-3bd2-44dc-9f1f-8a7519b8e4a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0a8970>]}
[0m12:28:20.386752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c60037ef-3bd2-44dc-9f1f-8a7519b8e4a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f744c0>]}
[0m12:28:20.387445 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:28:20.498143 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:28:20.615382 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:28:20.615875 [debug] [MainThread]: Partial parsing: updated file: youtube_dbt_project://models/staging/stg_youtube_videos.sql
[0m12:28:20.865306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c60037ef-3bd2-44dc-9f1f-8a7519b8e4a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3719a0>]}
[0m12:28:20.927992 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m12:28:20.929422 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m12:28:20.993135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c60037ef-3bd2-44dc-9f1f-8a7519b8e4a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a847d60>]}
[0m12:28:20.993477 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m12:28:20.993678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c60037ef-3bd2-44dc-9f1f-8a7519b8e4a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a517730>]}
[0m12:28:20.994298 [info ] [MainThread]: 
[0m12:28:20.994484 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:28:20.994638 [info ] [MainThread]: 
[0m12:28:20.994909 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:28:20.995347 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m12:28:21.003317 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m12:28:21.003522 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m12:28:21.003691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:22.441354 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.437 seconds
[0m12:28:22.445441 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m12:28:22.643395 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m12:28:22.657995 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m12:28:22.658441 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m12:28:22.658798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:23.784557 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.125 seconds
[0m12:28:23.788097 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m12:28:23.974174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m12:28:23.980736 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m12:28:23.981480 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS limit 10000
[0m12:28:23.981981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:25.123217 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.141 seconds
[0m12:28:25.128005 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m12:28:25.318360 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m12:28:25.325200 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m12:28:25.325962 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m12:28:25.326458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:26.518488 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.192 seconds
[0m12:28:26.524598 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m12:28:26.716346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c60037ef-3bd2-44dc-9f1f-8a7519b8e4a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7cd7f0>]}
[0m12:28:26.722447 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.stg_youtube_videos
[0m12:28:26.723537 [info ] [Thread-1  ]: 1 of 1 START sql view model STAGING_STAGING.stg_youtube_videos ................. [RUN]
[0m12:28:26.724384 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now model.youtube_dbt_project.stg_youtube_videos)
[0m12:28:26.725000 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.stg_youtube_videos
[0m12:28:26.739363 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.stg_youtube_videos"
[0m12:28:26.740530 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.stg_youtube_videos
[0m12:28:26.770748 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.stg_youtube_videos"
[0m12:28:26.772527 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.stg_youtube_videos"
[0m12:28:26.772894 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.stg_youtube_videos"} */
create or replace   view MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
  
   as (
    
        
with source as (
        
    select
        video_id,
        country,
        title,
        channel_title,   
        category_id,
        trending_date,
        publish_time,
        tags,
        views,
        likes,
        dislikes,
        comment_count,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from MAGPIE_FINAL_PROJECT.RAW.RAW_YOUTUBE_TRENDING
        
),
        
cleaned as (  
        
    select
        video_id,
        country,
        title,
        channel_title,
        category_id,
        try_to_date(trending_date, 'YY.DD.MM') as trending_date,
        try_to_timestamp_ntz(publish_time)      as publish_ts,
        tags, 
        try_cast(views as number) as views,
        try_cast(likes as number) as likes,
        try_cast(dislikes as number) as dislikes,
        try_cast(comment_count as number) as comment_count,
        comments_disabled,
        ratings_disabled,
        video_error_or_removed
    from source
    where trending_date is not null    
)
        
select * from cleaned
  );
[0m12:28:26.773228 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:28:27.768216 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.995 seconds
[0m12:28:27.807413 [debug] [Thread-1  ]: On model.youtube_dbt_project.stg_youtube_videos: Close
[0m12:28:28.018392 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c60037ef-3bd2-44dc-9f1f-8a7519b8e4a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f74520>]}
[0m12:28:28.019735 [info ] [Thread-1  ]: 1 of 1 OK created sql view model STAGING_STAGING.stg_youtube_videos ............ [[32mSUCCESS 1[0m in 1.29s]
[0m12:28:28.020701 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.stg_youtube_videos
[0m12:28:28.022364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:28.022838 [debug] [MainThread]: Connection 'model.youtube_dbt_project.stg_youtube_videos' was properly closed.
[0m12:28:28.023300 [info ] [MainThread]: 
[0m12:28:28.023786 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.03 seconds (7.03s).
[0m12:28:28.024833 [debug] [MainThread]: Command end result
[0m12:28:28.061459 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m12:28:28.063207 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m12:28:28.068913 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m12:28:28.069162 [info ] [MainThread]: 
[0m12:28:28.069490 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:28.069718 [info ] [MainThread]: 
[0m12:28:28.069961 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:28:28.071919 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.109263, "process_in_blocks": "0", "process_kernel_time": 0.358852, "process_mem_max_rss": "163102720", "process_out_blocks": "0", "process_user_time": 3.198961}
[0m12:28:28.072281 [debug] [MainThread]: Command `dbt run` succeeded at 12:28:28.072206 after 8.11 seconds
[0m12:28:28.072580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e545e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e58e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a847cd0>]}
[0m12:28:28.072875 [debug] [MainThread]: Flushing usage events
[0m12:28:28.403744 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:28:35.960293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055a7640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106644790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106644ac0>]}


============================== 12:28:35.962951 | f0c64568-c769-40eb-a169-b3aff2f1dd98 ==============================
[0m12:28:35.962951 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:28:35.963316 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/logs', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'quiet': 'False', 'introspect': 'True', 'warn_error': 'None', 'version_check': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'debug': 'False', 'invocation_command': 'dbt run --select fct_youtube_daily', 'log_format': 'default', 'no_print': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/luc/.dbt', 'target_path': 'None'}
[0m12:28:36.265889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0c64568-c769-40eb-a169-b3aff2f1dd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077f0820>]}
[0m12:28:36.300185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0c64568-c769-40eb-a169-b3aff2f1dd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1a250>]}
[0m12:28:36.300885 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:28:36.400940 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:28:36.499447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:28:36.499728 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:28:36.533073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0c64568-c769-40eb-a169-b3aff2f1dd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d6c130>]}
[0m12:28:36.596775 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m12:28:36.597910 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m12:28:36.607958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0c64568-c769-40eb-a169-b3aff2f1dd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d711f0>]}
[0m12:28:36.608263 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 477 macros
[0m12:28:36.608504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0c64568-c769-40eb-a169-b3aff2f1dd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d97bb0>]}
[0m12:28:36.609138 [info ] [MainThread]: 
[0m12:28:36.609330 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:28:36.609486 [info ] [MainThread]: 
[0m12:28:36.609765 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:28:36.610219 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MAGPIE_FINAL_PROJECT'
[0m12:28:36.618862 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT"
[0m12:28:36.619064 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT"} */
show terse schemas in database MAGPIE_FINAL_PROJECT
    limit 10000
[0m12:28:36.619231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:37.604041 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.985 seconds
[0m12:28:37.607694 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT: Close
[0m12:28:37.816970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT, now list_MAGPIE_FINAL_PROJECT_STAGING_MARTS)
[0m12:28:37.831684 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"
[0m12:28:37.832110 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_MARTS limit 10000
[0m12:28:37.832454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:38.696274 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.864 seconds
[0m12:28:38.701209 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_MARTS: Close
[0m12:28:38.887943 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS)
[0m12:28:38.895701 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"
[0m12:28:38.896335 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS limit 10000
[0m12:28:38.896824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:39.789224 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.892 seconds
[0m12:28:39.793669 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS: Close
[0m12:28:40.033673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING_MARTS, now list_MAGPIE_FINAL_PROJECT_STAGING_STAGING)
[0m12:28:40.041763 [debug] [ThreadPool]: Using snowflake connection "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"
[0m12:28:40.042490 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "connection_name": "list_MAGPIE_FINAL_PROJECT_STAGING_STAGING"} */
show objects in MAGPIE_FINAL_PROJECT.STAGING_STAGING limit 10000
[0m12:28:40.042959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:40.852960 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.810 seconds
[0m12:28:40.857098 [debug] [ThreadPool]: On list_MAGPIE_FINAL_PROJECT_STAGING_STAGING: Close
[0m12:28:41.044061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0c64568-c769-40eb-a169-b3aff2f1dd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104024fa0>]}
[0m12:28:41.049149 [debug] [Thread-1  ]: Began running node model.youtube_dbt_project.fct_youtube_daily
[0m12:28:41.050207 [info ] [Thread-1  ]: 1 of 1 START sql table model STAGING_STAGING_MARTS.fct_youtube_daily ........... [RUN]
[0m12:28:41.051008 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_MAGPIE_FINAL_PROJECT_STAGING_STAGING, now model.youtube_dbt_project.fct_youtube_daily)
[0m12:28:41.051619 [debug] [Thread-1  ]: Began compiling node model.youtube_dbt_project.fct_youtube_daily
[0m12:28:41.065915 [debug] [Thread-1  ]: Writing injected SQL for node "model.youtube_dbt_project.fct_youtube_daily"
[0m12:28:41.066878 [debug] [Thread-1  ]: Began executing node model.youtube_dbt_project.fct_youtube_daily
[0m12:28:41.098992 [debug] [Thread-1  ]: Writing runtime sql for node "model.youtube_dbt_project.fct_youtube_daily"
[0m12:28:41.100387 [debug] [Thread-1  ]: Using snowflake connection "model.youtube_dbt_project.fct_youtube_daily"
[0m12:28:41.100727 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "youtube_final", "target_name": "dev", "node_id": "model.youtube_dbt_project.fct_youtube_daily"} */
create or replace transient table MAGPIE_FINAL_PROJECT.STAGING_STAGING_MARTS.fct_youtube_daily
         as
        (
        
with base as (
    select  
        trending_date,
        country,
        category_id,
        count(*)                              as video_count,
        sum(try_cast(views as int))           as total_views,
        sum(try_cast(likes as int))           as total_likes,
        sum(try_cast(comment_count as int))   as total_comments,
    from MAGPIE_FINAL_PROJECT.STAGING_STAGING.stg_youtube_videos
    where trending_date is not null
    group by
        trending_date,
        country,
        category_id 
)
        
select 
    trending_date,
    country,
    category_id,
    video_count,
    total_views,
    total_likes,
    total_comments
from base
        );
[0m12:28:41.101037 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:28:44.215123 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.114 seconds
[0m12:28:44.250130 [debug] [Thread-1  ]: On model.youtube_dbt_project.fct_youtube_daily: Close
[0m12:28:44.443597 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c64568-c769-40eb-a169-b3aff2f1dd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c8430>]}
[0m12:28:44.445323 [info ] [Thread-1  ]: 1 of 1 OK created sql table model STAGING_STAGING_MARTS.fct_youtube_daily ...... [[32mSUCCESS 1[0m in 3.39s]
[0m12:28:44.446530 [debug] [Thread-1  ]: Finished running node model.youtube_dbt_project.fct_youtube_daily
[0m12:28:44.448190 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:44.448738 [debug] [MainThread]: Connection 'model.youtube_dbt_project.fct_youtube_daily' was properly closed.
[0m12:28:44.449241 [info ] [MainThread]: 
[0m12:28:44.449762 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.84 seconds (7.84s).
[0m12:28:44.450806 [debug] [MainThread]: Command end result
[0m12:28:44.487400 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/manifest.json
[0m12:28:44.489117 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/semantic_manifest.json
[0m12:28:44.495233 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/luc/Desktop/Northwestern Fall 2025/MLDS 430 Data Visualization and Warehuosing/Data_Warehousing_Final_Project/youtube_dbt_project/target/run_results.json
[0m12:28:44.495523 [info ] [MainThread]: 
[0m12:28:44.495870 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:44.496125 [info ] [MainThread]: 
[0m12:28:44.496412 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:28:44.498354 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.582512, "process_in_blocks": "0", "process_kernel_time": 0.268457, "process_mem_max_rss": "153993216", "process_out_blocks": "0", "process_user_time": 2.946295}
[0m12:28:44.498664 [debug] [MainThread]: Command `dbt run` succeeded at 12:28:44.498594 after 8.58 seconds
[0m12:28:44.498935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055a7640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d71550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077af8b0>]}
[0m12:28:44.499218 [debug] [MainThread]: Flushing usage events
[0m12:28:44.684029 [debug] [MainThread]: An error was encountered while trying to flush usage events
